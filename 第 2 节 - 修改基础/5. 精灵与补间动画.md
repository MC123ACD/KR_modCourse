## 5.1 精灵
可在屏幕上移动具有坐标，可变化的图像，称为精灵（**sprite**）

精灵通过计算自身的时间戳（**timestamp**，缩写 ts）控制其显示的图像

### 5.1.1 美术资源
所有美术资源都存于 `_assets` 目录中，其中 `images` 子目录为图像资源。

`images` 目录中的文件分为两种：图集与相应的图像数据

```lua
name_1 = {					-- 图像名称
	a_name = "abc-1.dds",	-- 图集名称
	size = {		-- 图像原始大小（未裁剪透明边）
		200,		-- 长度
		100			-- 高度
	},
	trim = {		-- 裁剪的透明边
		10,			-- 左侧裁剪的长度
		20,			-- 上方裁剪的长度
		15,			-- 右侧裁剪的长度
		25			-- 下方裁剪的长度
	},
	a_size = {		-- 图集大小
		2048,		-- 长度
		2048		-- 高度
	},
	f_quad = {		-- 从图集指定位置得到图像
		1000,		-- x
		500,		-- y
		175,		-- 长度
		55			-- 高度
	},
	alias = {		-- 别名
		"name_2"	-- 也可以通过name_2找到这个图像
	}
}
```
以上完整含义为：
1. 定义一个名叫 name_1 或 name_2 的图像
2. 原始大小 200x100 像素
3. 从左边裁去 10 像素，再从右边裁去 15 像素，最后再从上下裁去 20 和 25 像素
4. 图集名称 `abc-1.dds`
5. 图集大小 2048x2048
6. 这个图像位于图集的 [1000, 500] 到 [1175, 555] 处

示意图：
![[Pasted image 20251109133154.png|1000]]

### 5.1.2 动画
所有动画数据都存于 `kr/data/animations` 目录中.

```lua
animation_a_name = {		-- 动画名称
	prefix = "name",		-- 图像名称前缀（不带_x序号）
	to = 10,				-- 动画结束时的图像序号（结束帧）
	from = 1				-- 动画开始时的图像序号（开始帧）
}
```
以上完整含义为：
1. 定义动画名称为 animation_a_name
2. 图像名称 name，用于与当前帧拼接（例如：动画结束帧的图像为 name_10）
3. 动画从图像序号 1 开始到序号 10 结束（即 name_1 到 name_10）

#### 播放动画
1. 通过实体精灵的 `name` 直接指定动画名称播放动画
2. 也可以通过精灵的 `prefix` 前缀与 `name` 拼接播放动画

## 5.2 补间动画
根据精灵起点与终点的参数补足中间过渡帧的动画，称为补间动画（**Tween Animation**）
补间动画可当做关键帧，用于过渡，淡出淡入、平滑移动等

```lua
-- 模板
tt.tween.props[1].name = "scale"	-- 缩放大小
tt.tween.props[1].keys = {
	{
		0,
		v(1, 1)
	},
	{
		5,			-- 从 0 秒到 5 秒缓慢放大精灵到此前的两倍
		v(2, 2)
	}
}
```

### 5.2.1 使用方法
首先增加 `tween` 补间动画组件，在 `keys` 指定关键帧，在 `name` 指定精灵键，在 `sprite_id` 指定目标精灵。

**默认值**：
- `name`：`alpha`
- `sprite_id`：`1`
```lua
AC(tt, "tween")	-- 增加组件
tt.tween.props[1].keys = {
	{
		0,	-- 默认透明度 0
		255
	},
	{
		1,	-- 1 秒时完全淡出
		0
	}
}
tt.tween.props[1].sprite_id = 2	-- 补间的精灵，支持数字或表
```

### 5.2.2 淡出淡入
```lua
AC(tt, "tween")
tt.tween.props[1].keys = {
	{
		0,	-- 默认透明度 0
		255
	},
	{
		1,	-- 1 秒时完全淡出
		0
	},
	{
		2,	-- 2 秒时完全淡入
		255
	}
}
tt.tween.props[1].sprite_id = {	-- 补间的精灵，可以直接用数字或表
	1,
	2,
	...
}
tt.tween.remove = false			-- 禁用播放后移除
tt.tween.props[1].loop = true	-- 循环播放
```
