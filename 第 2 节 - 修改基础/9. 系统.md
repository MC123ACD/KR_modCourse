
系统模块位于 `all/systems` 是游戏运行逻辑的关键部分。

### 9.1.1 子系统
**整个系统又分为多个子系统**：
1. 关卡系统 level
2. 波次生成系统 wave_spawn
3. 防御塔升级系统 tower_upgrade
4. 科技树系统 game_upgrades
5. 实体函数系统 main_script
6. 血量系统 health
7. 精灵系统 render
8. ...

**而子系统的函数又分为**：
1. 初始化 init
2. 入列 on_queue
3. 出列 on_dequeue
4. 插入 on_insert
5. 更新 on_update
6. 移除 on_remove

```lua
-- 实体函数系统
sys.main_script = {}
sys.main_script.name = "main_script"

-- 入列
function sys.main_script:on_queue(entity, store, insertion)
	...
end

-- 出列
function sys.main_script:on_dequeue(entity, store, insertion)
	...
end

-- 插入
function sys.main_script:on_insert(entity, store)
	...
end

-- 更新
function sys.main_script:on_update(dt, ts, store)
	...
end

-- 移除
function sys.main_script:on_remove(entity, store)
	...
end
```
