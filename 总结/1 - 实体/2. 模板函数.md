### [一] 创建模板
```lua
E:register_t(模板名: str, 续承模板名?: str) -> 模板: table
```
- **作用**：创建新模板
- 示例：
```lua
a = E:register_t("a")	-- 创建一个名为 “a” 的模板
a.has_a = true
a.num = 1

template = E:register_t("template", "a")	-- 创建一个名为 “template” 的模板，同时续承 “a” 模板
template.n = 123
-- “template” 模板具有 “a” 模板所有键，修改对应键不影响模板 “a”
-- 也就是 template = { n = 123, has_a = true, num = 1 }
```
示意图：
![[Pasted image 20251110151753.png|650]]
### [二] 索引模板
```lua
E:get_template(模板名: str) -> 模板: table
```
- **作用**：返回给定的模板，该函数等价于 `E.entities[模板名]`
- 示例：
```lua
template = E:register_t("template")
template.num = 1

t = E:get_template("template")	-- 索引模板，等价于 `E.entities.template`
t.num = 123		-- 等价于 `E.entities.template.num = 123`
-- 此时模板 “template” 的 num 键等于 123
```

### [三] 重设模板
```lua
E:set_template(模板名: str, 新模板: table)
```
- **作用**：将对应模板赋值为新模板，该函数等价于 `self.entities[模板名] = 新模板`
- 示例：
```lua
template = E:register_t("template")
template.num = 1

new_template = { n = 123 }

E:set_template("template", new_template)	-- 将 “template” 模板设为 “new_template” 表
-- 此时 template = { n = 123 }
```

### [四] 创建组件
```lua
E:register_c(组件: str) -> 组件: table
```
- **作用**：创建新组件
- 示例：
```lua
a = E:register_c("a")	-- 创建一个名为 “a” 的组件
```

### [五] 添加组件
```lua
E:add_comps(模板: table, 组件名: str, ...)
```
  - **作用**：向模板增加 `components` 中的组件
  - 示例：
```lua
component = E:register_c("component")	-- 创建组件 “component”
component.num = 123
component.is_component = true

template = E:register_t("template")
E:add_comps(template, "component")		-- 增加组件 “component”
template.n = 1
-- 此时 template = { component = { num = 123, is_component = true }, n = 1}
```
示意图：
![[Pasted image 20251110151928.png|750]]

### [六] 拷贝组件
```lua
E:clone_c(组件名: str) -> 表: table
```
- **作用**：返回深拷贝的组件
- 示例：
```lua
component = E:register_c("component")	-- 创建组件 “component”
component.num = 123
component.is_component = true

template = E:register_t("template")
template.cc = E:clone_c("component")	-- 拷贝组件，此时 cc 就是组件 component
template.num = 1
-- 此时 template = { cc = { num = 123, is_component = true }, num = 1 }
```
示意图：
![[Pasted image 20251110153008.png|725]]
### [七] 索引组件
```lua
E:get_component(组件名: str) -> 组件: table
```
- **作用**：返回给定的组件，该函数等价于 `E.components[组件名]`
- 示例：
```lua
component = E:register_c("component")	-- 创建组件 “component”
component.num = 123

c = E:get_component("component")	-- 索引组件，等价于 `E.components.component`
c.num = 1		-- 等价于 `E.components.component.num = 1`
-- 此时 component = { num = 1 }
```

### [八] 筛选具有指定键的表
```lua
E:filter(表: table, 键: str, ...) -> 筛选出的表: table
```
- **作用**：返回一个表，表内包含在给定表内具有指定键的表
- 示例：
```lua
t = {
	a = { k = true },
	b = { k = true },
	c = { n = 2 }
}

ft = E:filter(t, "k")	-- 得到 t 里面的所有具有 k 键的表
-- 此时 ft = { a = { k = true }, b = { k = true } }，不包含 c 子表
```

### [九] 筛选具有指定键的模板
```lua
E:filter_templates(键: str, ...) -> 筛选出的模板: table
```
- **作用**：返回一个表，表内包含具有给定键的模板，该函数等价于 `E:filter(E.entities, 键: str, ...)`
- 示例：
```lua
enemy_templates = E:filter_templates("enemy")	-- 得到所有敌人模板

for _, e in pairs(enemy_templates) do
	e.enemy.gold = e.enemy.gold + 100	-- 所有敌人赏金加 100
end
```
