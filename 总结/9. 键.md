## 精灵

| 键                        | 类型                                            | 描述                                             |
| ------------------------ | --------------------------------------------- | ---------------------------------------------- |
| `animated`               | `bool`                                        | 精灵是否启用动画序列帧                                    |
| `group`                  | `int`                                         | 动画组 ID，用于同时控制多个精灵的动画                           |
| `prefix`                 | `str`                                         | 动画名称前缀，自动拼接到 name 前                            |
| `name`                   | `str`                                         | 动画名称（当 animated=true）或静态图像名称（当 animated=false） |
| `anchor`                 | `vec2`                                        | 精灵锚点，控制旋转/缩放的中心点                               |
| `offset`                 | `vec2`                                        | 相对于实体位置的偏移量                                    |
| `pos`                    | `vec2`                                        | 精灵的世界坐标位置                                      |
| `loop`                   | `bool`                                        | 动画是否循环播放                                       |
| `loop_forced`            | `bool`                                        | 是否强制循环，即使动画设置不循环                               |
| `flip_x`                 | `bool`                                        | 是否水平翻转精灵                                       |
| `flip_y`                 | `bool`                                        | 是否垂直翻转精灵                                       |
| `r`                      | `num`                                         | 旋转角度（弧度）                                       |
| `scale`                  | `vec2`                                        | 缩放比例                                           |
| `angles`                 | `list{str...}`                                | 角度区间表，用于根据朝向选择动画                               |
| `angles_flip_horizontal` | `bool`                                        | 超过 180 度是否水平翻转                                 |
| `angles_flip_vertical`   | `bool`                                        | 是否垂直翻转（用于俯视角度）                                 |
| `angles_custom`          | `table{角度范围 = {name = "动画名", flip_x = bool}}` | 自定义角度映射                                        |
| `angles_stickiness`      | `num`                                         | 角度粘滞性，防止频繁切换角度动画                               |
| `alpha`                  | `0-255`                                       | 透明度                                            |
| `hidden`                 | `bool`                                        | 精灵是否隐藏                                         |
| `z`                      | `int`                                         | 渲染图层（Z 轴深度）                                    |
| `draw_order`             | `int`                                         | 绘制顺序，在同图层内排序                                   |
| `size_names`             | `list{str...}`                                | 尺寸变体名称表，根据单位尺寸选择不同动画                           |
| `size_scales`            | `list{num...}`                                | 尺寸缩放比例表，对应 size_names                          |
| `sort_y`                 | `bool`                                        | 是否启用 Y 轴排序（伪 3D 深度效果）                          |
| `sort_y_offset`          | `int`                                         | Y 轴排序偏移量，调整深度计算                                |
| `sync_idx`               | `int`                                         | 同步索引，当帧索引为此值时 sync_flag=true                   |
| `time_offset`            | `num`                                         | 动画时间偏移（秒）                                      |
| `hide_after_runs`        | `int`                                         | 播放 N 次后隐藏精灵                                    |
| `fps`                    | `int`                                         | 帧率覆盖（每秒帧数）                                     |
| `random_ts`              | `num`                                         | 随机开始时间范围（秒），用于错开动画                             |
| `ignore_start`           | `bool`                                        | 忽略起始帧，直接从第二帧开始                                 |
| `ts`                     | `num`                                         | **运行时字段**：动画开始时间戳（秒）                           |
| `runs`                   | `num`                                         | **运行时字段**：已完成播放次数                              |
| `frame_idx`              | `num`                                         | **运行时字段**：当前帧索引（1-based）                       |
| `frame_name`             | `str`                                         | **运行时字段**：当前帧名称                                |
| `sync_flag`              | `bool`                                        | **运行时字段**：同步标志，当帧到达 sync_idx 或新循环时为 true       |
| `frames`                 | `list`                                        | **运行时字段**：存储渲染帧的列表                             |

## 粒子

| 键                      | 类型              | 描述                                                  |
| ---------------------- | --------------- | --------------------------------------------------- |
| `alphas`               | `list{int}`     | 粒子生命周期中透明度变化值，支持插值（如 `{255, 128, 0}` 表示从透明到不透明再到透明） |
| `anchor`               | `vec2`          | 粒子精灵的锚点（中心点），`(0.5, 0.5)` 表示中心，`(0, 0)` 表示左上角       |
| `animated`             | `bool`          | 粒子是否使用动画序列（如爆炸序列帧）而非静态图像                            |
| `animation_fps`        | `int`           | 动画播放速度（帧/秒），当 `animated=true` 时生效                   |
| `cycle_names`          | `bool`          | 是否循环使用 `names` 列表中的粒子图像名称                           |
| `draw_order`           | `int`           | 渲染排序值，值越大越后渲染（覆盖其他粒子）                               |
| `emission_rate`        | `int`           | 每秒发射粒子数量（发射频率）                                      |
| `emit`                 | `bool`          | 是否开始发射粒子                                            |
| `emit_area_spread`     | `vec2`          | 发射区域范围（矩形区域），粒子在区域内随机位置生成                           |
| `emit_direction`       | `num`           | 发射角度（弧度），0为向右，π/2为向下                                |
| `emit_duration`        | `num`           | 发射持续时间（秒），`nil` 表示无限发射                              |
| `emit_offset`          | `vec2`          | 发射位置相对于实体位置的偏移                                      |
| `emit_rotation`        | `num`           | 粒子的初始旋转角度（弧度）                                       |
| `emit_rotation_spread` | `num`           | 初始旋转角度的随机变化范围（弧度）                                   |
| `emit_speed`           | `list{num...}`  | 粒子发射速度范围，如 `{100, 200}` 表示速度在100-200之间随机            |
| `emit_spread`          | `num`           | 发射方向的随机变化范围（弧度）                                     |
| `loop`                 | `bool`          | 粒子动画是否循环播放                                          |
| `name`                 | `str`           | 粒子图像或动画名称（当没有 `names` 列表时使用）                        |
| `names`                | `list{str...}`  | 多个粒子图像/动画名称列表，可随机或循环使用                              |
| `particle_lifetime`    | `list{num...}`  | 粒子生命周期范围（秒），如 `{0.9, 1}` 表示0.9-1秒随机                 |
| `scale_same_aspect`    | `bool`          | X和Y轴是否使用相同的缩放因子                                     |
| `scale_var`            | `list{num...}`  | 缩放变化范围，如 `{0.5, 1.5}` 表示随机缩放0.5-1.5倍                |
| `scales_x`             | `list{num...}`  | 粒子生命周期中X轴缩放变化，支持插值                                  |
| `scales_y`             | `list{num...}`  | 粒子生命周期中Y轴缩放变化，支持插值                                  |
| `sort_y`               | `int`           | 渲染时的Y轴排序值（用于深度排序）                                   |
| `sort_y_offset`        | `int`           | Y轴排序偏移值，用于调整渲染深度                                    |
| `sort_y_offsets`       | `list{int...}`  | 粒子生命周期中Y轴排序偏移变化，支持插值                                |
| `source_lifetime`      | `num`           | 粒子发射源（实体）的生命周期（秒），`nil` 表示永久存在                      |
| `spin`                 | `table{num...}` | 粒子旋转速度范围（弧度/秒），如 `{-1, 1}` 表示随机旋转方向                 |
| `track_id`             | `int`           | 要跟踪的目标实体ID，粒子系统会跟随该实体                               |
| `track_offset`         | `vec2`          | 相对于跟踪实体的偏移位置                                        |
| `track_rotation`       | `bool`          | 是否跟踪目标实体的旋转角度                                       |
| `ts_offset`            | `num`           | 时间偏移（秒），用于延迟或提前粒子系统的开始时间                            |
| `z`                    | `num`           | 渲染层级（Z轴值），控制不同粒子系统的渲染顺序                             |
| `frames`               | `list`          | **运行时字段**：存储渲染帧的列表                                  |
| `particles`            | `list`          | **运行时字段**：存储活动粒子对象的列表                               |
