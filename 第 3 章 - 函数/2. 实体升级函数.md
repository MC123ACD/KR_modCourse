# 定义
每次实体升级时调用的函数，称为升级函数（**level up script**）

# 技能升级
## 一、技能或攻击的属性随等级而变化
##### 1. 在模板增加属性键
还是以艾莉丹的四技能，双刀跳斩为例
```lua
tt.hero.skills.double_strike = E:clone_c("hero_skill")
tt.hero.skills.double_strike.cooldown = {	-- 假设要让双刀跳斩的冷却时间随等级变化（原版 12 秒）
	12,	-- 一级 12 秒
	10,	-- 二级 10 秒
	8	-- 三级 8 秒
}
```

##### 2. 修改升级函数
搜索方法同插入函数

如代码所示为升级函数：
```lua
function scripts.hero_elves_archer.level_up(this, store, initial)
	local hl = this.hero.level
	local ls = this.hero.level_stats

	this.health.hp_max = ls.hp_max[hl]
	this.regen.health = ls.regen_health[hl]
	this.health.armor = ls.armor[hl]
	this.melee.attacks[1].damage_min = ls.melee_damage_min[hl]
	this.melee.attacks[1].damage_max = ls.melee_damage_max[hl]

	local bt = E:get_template(this.ranged.attacks[1].bullet)

	bt.bullet.damage_min = ls.ranged_damage_min[hl]
	bt.bullet.damage_max = ls.ranged_damage_max[hl]
...
```
**所有属性都会在这里根据等级赋值到对应属性键上**

插入函数总是会调用一次这个函数 （`this.hero.fn_level_up(this, store, true)`）**这是因为升级函数只有升级时才会调用，所以需要在插入时调用一次进行初始化来保证属性正确被赋值**

找到双刀跳斩的代码块，后面加上 `a.cooldown = s.cooldown[s.level]` 即可
```lua
...
s = this.hero.skills.double_strike

if initial and s.level > θ then
	local a = this.melee.attacks[2]
	a.disabled = nil
	a.damage_min = s.damage_min[s.level]
	a.damage_max = s.damage_max[s.level]
	
	-- 增加到这里
	a.cooldown = s.cooldown[s.level]
end
...
```

