# 修改属性
## 一、基础属性
##### 1. 搜索
首先使用搜索功能在 `kr/game_templates` 任意找到一个英雄模板

##### 2. 介绍
如图以小公主为例：
![[Pasted image 20250626164940.png|800]]
`tt` 指的是对应英雄，第一个子键指来自哪个组件，例如： `tt.hero.hp_max` 指 `hero` 组件的 `hp_max` 键

`tt.hero.level_stats` 键的子键都是基础属性：
```lua
tt.hero.level_stats.armor	-- 物理护甲
tt.hero.level_stats.hp_max	-- 最大血量
tt.hero.level_stats.melee_damage	-- 近战与远程普攻的伤害
tt.hero.level_stats.ranged_damage	-- 近战与远程普攻的伤害
tt.hero.level_stats.regen_health	-- 脱战回血
```

**展开的 10 行数字为行数所对应等级的属性**
```lua
tt.hero.level_stats.hp_max = {
	250,	-- 1 级血量为 250...
	270,
	290,
	310,
	330,
	350,
	370,
	390,
	410,
	430		-- 10 级血量为 430
}
```

##### 3. 修改
**将第十行血量修改为 666，然后运行游戏**
![[Pasted image 20250626192149.png|377]]
![[Pasted image 20250626191819.png|541]]
如图血量变为 666 成功

- **若未成功可以检查一下英雄等级是否到 10 级，当然也可以修改其他行只要英雄到达这个等级**
- **还要检查出战的英雄是不是你改的英雄**

##### 4. 五代问题
五代的键值是这样的：
![[Pasted image 20250630133711.png|625]]
通过查看模板的定义知道：基础属性的存储位置在 `balance`
![[Pasted image 20250630134949.png|245]]
如图在 `balance` 搜索要改的英雄，同样可以找到基础属性，修改 `hp_max` 即可

##### Q&A：
- Q：程序是如何知道我们在修改哪个英雄？换句话说 `tt` 指的是什么
- A：因为 `E:register_t` 函数会返回创建的模板的引用，也就是说此时 `tt` 就是 `E.entities.hero_alleria`
除非重新给 `tt` 赋值（比如创建另一个英雄模板，然后 `tt` 就直接指向新模板了，也就是说此后修改的血量等都是修改新模板的）

## 二、技能加点相关
以艾莉丹为例：
![[Pasted image 20250627155614.png|450]]
假设要修改艾莉丹的四技能；双刀跳斩的伤害：
首先查资料（见[[总结/1 - 实体/1. 模板名.md]] ）知道：四技能的名称是 `double_strike`
![[Pasted image 20250627185432.png|450]]
**五代还是与基础属性相同在 `balance`**

**3 行数字意义同上**
**例如：修改第三行最大伤害为 233 则双刀跳斩三级时最大伤害为 233 点**

#### Q&A：
- Q：如果我想修改冷却时间等其他属性，这里怎么没有
- A：因为这里只有一些加点相关的键，修改方法下面会提到
- Q：有些技能的属性找不到怎么办
- A：有些技能直接用的乘数，也就是每次到达对应等级，技能的属性会 `= 技能等级 × inc`
可以重点找带 `inc` 名的键

## 三、近战攻击
拦截后的攻击，称为近战攻击，例如：近战普攻、钢锯电钻等

```lua
tt.melee.attacks[1] = E:clone_c("melee_attack")	-- 赋值为相应组件，用于提供默认值
tt.melee.attacks[1].cooldown = 1	-- 冷却时间
tt.melee.attacks[1].hit_time = fts(8)	-- 攻击前摇
tt.melee.attacks[1].sound = "MeleeSword"	-- 攻击声音
tt.melee.attacks[1].xp_gain_factor = 2.5 -- 获得的经验
tt.melee.range = 45	-- 拦截范围
```
如代码所示，一般**第一个攻击 `attacks[1]` 都是普攻，其他都是相应行为的技能**

#### Q&A：
- Q：这里怎么没有伤害，伤害怎么改
- A：没有一般则写在技能加点的属性那里了
- Q：怎么知道我修改的是哪个攻击
- A：可以查资料找这个攻击的键对应哪个攻击
注：有的攻击可能会占有多个攻击，可以通过 `table.deepclone` 复制的攻击来分辨
用于播放不同动画，与增加额外效果

## 四、远程攻击
召唤子弹作为中介的攻击，称为远程攻击（**ranged**）

因为是召唤子弹所以**远程攻击的伤害和伤害类型等都是写在子弹上的，可以通过搜索子弹键（`bullet`）的键值对应的模板来找到子弹的各种键**
![[Pasted image 20250630184001.png|850]]
![[Pasted image 20250630184104.png|725]]
- 有些子弹的键可能是 `nil` 甚至没有
- 没有基本就是衍生底模板或者写在基础属性那里了

## 五、技能
不属于以上两种攻击的攻击，称为技能（**timed_attacks**），例如：召唤实体、给予 buff 等
