## 2.1 第一个程序

首先从最简单的程序开始，理解 Lua 的基本结构。

**1. 打开工作区文件夹**
![[Pasted image 20251206205112.png|425]]
**2. 创建 Lua 文件 `test.lua`**
![[Pasted image 20251206205740.png|372]]

**3. 输入代码**
```lua
print("Hello, Lua World!")
```

**4. 运行**
![[Pasted image 20251225155912.png|650]]

可以看到成功输出 `Hello, Lua World!`

### 2.1.1 程序结构解析
- **语句**：`print("Hello, Lua World!")` 是一条语句
- **函数调用**：`print()` 是调用一个函数
- **字符串**：`"Hello, Lua World!"` 是一个字符串值

### 2.1.2 修复无法中文乱码
```lua
print("你好，世界！")
-- 输出 浣犲ソ锛屼笘鐣岋紒
```

由于终端编码限制所以需要让文本输出到调试控制台上。
![[Pasted image 20251225194347.png|775]]

将 integratedTerminal 修改为 internalConsole
![[Pasted image 20251225194118.png|407]]
Lua 版本修改为 5.1 即可
![[Pasted image 20251226133851.png]]
![[Pasted image 20251225194600.png]]
## 2.2 Lua 中的注释

注释用于解释代码，不会被 Lua 执行。Lua 有两种注释方式：

### 2.2.1 单行注释
```lua
-- 这是单行注释，直到行尾结束
local x = 10  -- 行尾注释，解释这行代码
```

### 2.2.2 多行注释
```lua
--[[
  这是多行注释
  可以跨越多行
  常用于文档说明或临时禁用代码块
]]
print("这段代码会执行")

--[[
  临时禁用一段代码：
  print("这行不会执行")
  local y = 20
]]
```

### 2.2.3 快速注释技巧
使用快捷键 `ctrl + /` 即可快速注释以及取消注释
```lua
-- print("被注释的代码")	-- ctrl + / 快速注释
```

## 2.3 标识符命名规则

标识符是变量、函数、表等的名称。Lua 的命名规则很简单：

### 2.3.1. 合法标识符
```lua
player_name  -- 蛇形命名法（使用下划线替代空格，全小写）

PlayerName   -- 帕斯卡命名法（使用大写替代空格，首字母大写）

playerName   -- 驼峰命名法（使用大写替代空格，首字母小写）

_player      -- 下划线开头
player1      -- 包含数字（但不能以数字开头）
```

### 2.3.2 非法标识符
```lua
-- 这些会导致错误：
变量名		-- 不能使用中文
1player     -- 不能以数字开头
player-name -- 不能包含连字符
player name -- 不能包含空格
local       -- 不能使用关键字
end
```

### 2.3.3 Lua 关键字（保留字）
以下是 Lua 的保留字，不能用作标识符：

|   关键字    |         |          |          |            |
| :------: | :-----: | :------: | :------: | :--------: |
| `local`  | `false` |  `true`  |  `nil`   | `function` |
| `return` |  `if`   |  `else`  | `elseif` |   `then`   |
|  `end`   |  `and`  |   `or`   |  `not`   |    `do`    |
|  `for`   |  `in`   | `repeat` | `until`  |  `while`   |
| `break`  |         |          |          |            |

### 2.3.4 命名约定：
```lua
-- 1. 变量使用蛇形命名法
local player_health = 100
local game_score = 0

-- 2. 常量使用全大写（虽然没有真正的常量，但约定俗成）
local MAX_PLAYERS = 4
local PI = 3.14159

-- 3. 函数名使用蛇形命名法
function calculate_damage()
    -- 函数体
end

-- 4. 避免使用单个字母的变量名（除非是循环计数器）
for i = 1, 10 do  -- i是习惯用法，可以接受
    print(i)
end

-- 5. 类名使用帕斯卡命名法
TowerMenu = class("TowerMenu")
```

## 2.4 语句分隔

Lua 中，语句可以用分号或换行分隔：
```lua
-- 使用分号分隔（不常用）
local a = 1; local b = 2; print(a + b)

-- 使用换行分隔（推荐）
local a = 1
local b = 2
print(a + b)

-- 混合使用
local a = 1; local b = 2  -- 同一行用分号
print(a + b)              -- 新一行不需要分号
```

## 2.5 代码风格指南

良好的代码风格让程序更易读：

### 2.5.1 缩进
```lua
-- 使用Tab缩进（不要用空格）
if condition then
    print("缩进的代码")
end

-- 不好的缩进
if condition then
print("这样很难读")  -- 没有缩进
	print("缩进不一致")  -- 突然缩进
end
```

### 2.5.2 行长度
```lua
-- 建议每行不超过80个字符
-- 太长的行可以这样拆分：

-- 拆分字符串
local message = "这是一段非常非常非常非常非常" ..
                "非常非常非常非常长的字符串"

-- 拆分函数传递
local result = calculate_total_score(
    player1_score,
    player2_score,
    bonus_points,
    difficulty_multiplier
)
```

### 2.5.3 空白行
```lua
-- 用空白行分隔逻辑块
local player_name = "小明"
local player_level = 1

-- 角色状态初始化
local health = 100
local mana = 50

-- 装备初始化
local weapon = "木剑"
local armor = "布衣"

print("角色创建完成")
```

### 2.5.4 表内每个元素换行
```lua
local t = {
	"箭塔",
	"兵营",
	"法师塔",
	"炮塔"
}
```

### 2.5.5 符号后增加空格
```lua
-- 运算符空格
local n = 100 + 50
-- local n=100+50 过于紧凑不好

if n == 150 then
...
end
-- if n==150 then 过于紧凑不好

-- 逗号空格
local function test(test1, test2, test3)
	...
end

test(1, 2, 3)
-- test(1,2,3) 过于紧凑不好
```

### 2.5.6 自动格式化
可以使用 vscode 的自动格式化功能来优化代码格式。

使用快捷键：`shift + alt + f`

```lua
-- 不好的格式
print(1,2,3,4,5)

do
local a = 10
  local b = 20
print(a+b)
end

-- 按 shift + alt + f 格式化后
print(1, 2, 3, 4, 5)
do
    local a = 10
    local b = 20
    print(a + b)
end
```

## 2.6 常见错误与调试

#### 语法错误示例
```lua
-- 错误1：缺少引号
print("Hello World)  -- 编译错误：未结束的字符串

-- 错误2：拼写错误
prin("Hello")  -- 运行时错误：尝试调用nil值

-- 错误3：缺少end
if true then
    print("This is true")
-- 忘记写end  -- 编译错误：'<eof>' expected near '<eof>'

-- 错误4：中文标点（初学者常见）
print（"Hello"）  -- 编译错误：使用中文括号
```

### 简单调试技巧
```lua
-- 1. 使用print调试
print("=== 程序开始 ===")
local x = 10
print("x的值为: " .. x)

-- 2. 检查变量类型
local value = "100"
print(type(value))  -- 输出：string

-- 3. 临时禁用代码块
-- print("这段代码暂时不需要")
-- 可以按快捷键 ctrl + / 快速注释掉
```

## 2.7 练习
### 练习 1：创建一个文件，尝试不同类型的注释

### 练习 2：判断以下哪些是合法的标识符
（答案见 [[第 1 节 - 语法/参考答案#练习 2 2 ：判断以下哪些是合法的标识符：]]）
1. `playerName`
2. `2ndPlayer`
3. `player_score`
4. `local`
5. `_internal`
6. `my-var`
7. `玩家1`

### 练习 3：创建一个自我介绍程序
（答案见 [[第 1 节 - 语法/参考答案#练习 2 3：创建一个自我介绍程序]]）
```lua
--[[
任务：创建一个程序，输出以下信息：
1. 你的名字
2. 年龄
3. 兴趣爱好
4. 学习Lua的目标
]]
```

## 2.8 本章总结

#### 关键知识点回顾
1. **注释**：`--` 单行注释，`--[[ ... ]]` 多行注释
2. **标识符**：字母、数字、下划线组成，不能以数字开头，区分大小写
3. **关键字**：避免使用 `and`、`if`、`end` 等保留字作为标识符
4. **代码块**：`do...end` 定义局部作用域
5. **语句分隔**：分号可选，通常用换行
6. **代码风格**：一致的缩进、命名、格式、表换行
7. **自动格式化**：使用快捷键 `shift + alt + f` 

#### 检查清单
（点击勾选框勾选）
完成本章后，你应该能够：
- [ ] 写出带注释的 Lua 程序
- [ ] 使用合法的标识符命名变量
- [ ] 识别常见的语法错误
- [ ] 遵循基本的代码风格规范

#### 思考题
1. 为什么良好的代码风格很重要？
2. 如果程序中有一段暂时不需要的代码，应该怎么做？
3. 以下哪个命名最好？为什么？
	- `a`
	- `player1Health`
	- `player_health`
	- `PlayerHealth`

---

**下一章预告**：在第 3 章中，我们将学习变量和数据类型，这是编程的基础。你会学到如何存储不同类型的数据。

**拓展阅读**：
- [Lua 教程 | 菜鸟教程](https://www.runoob.com/lua/lua-tutorial.html)
- [Lua 官方手册](http://www.lua.org/manual/5.1)
- [代码风格指南](https://github.com/luarocks/lua-style-guide)

**常见问题解答**：
Q: Lua 区分大小写吗？
A: 是的，`myVar` 和 `myvar` 是两个不同的变量。

Q: 注释会影响程序性能吗？
A: 不会，注释在程序运行时会被完全忽略。

Q: 一行代码可以写多个语句吗？
A: 可以，用分号分隔，但不推荐这样做。