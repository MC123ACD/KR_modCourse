<!DOCTYPE html> <html lang="zh-cn"><head>
<title>8. 字符串</title>
<base href="..">
<meta name="pathname" content="第-1-节-语法/8.-字符串.html">
<meta name="description" content="王国保卫战修改教程 - 8. 字符串">
<meta property="og:title" content="8. 字符串">
<meta property="og:description" content="王国保卫战修改教程 - 8. 字符串">
<meta property="og:type" content="website">
<meta property="og:url" content="第-1-节-语法/8.-字符串.html">
<meta property="og:image" content="undefined">
<meta charset="UTF-8"><meta property="og:site_name" content="王国保卫战修改教程"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0"><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="site-lib/rss.xml"><script async="" id="webpage-script" src="site-lib/scripts/webpage.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><link rel="icon" href="site-lib/media/favicon.png"><link rel="preload" href="site-lib/styles/snippets.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/snippets.css"></noscript><link rel="stylesheet" href="site-lib/styles/obsidian.css"><link rel="preload" href="site-lib/styles/other-plugins.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/other-plugins.css"></noscript><link rel="stylesheet" href="site-lib/styles/theme.css"><link rel="preload" href="site-lib/styles/global-variable-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/global-variable-styles.css"></noscript><link rel="preload" href="site-lib/styles/supported-plugins.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/supported-plugins.css"></noscript><link rel="preload" href="site-lib/styles/main-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/main-styles.css"></noscript><style>body{--line-width:40em;--line-width-adaptive:40em;--file-line-width:40em;--sidebar-width:min(20em, 80vw);--collapse-arrow-size:11px;--tree-vertical-spacing:1.3em;--sidebar-margin:12px}:root{background-color:#202124}.sidebar{height:100%;font-size:14px;z-index:10;min-width:calc(var(--sidebar-width) + var(--divider-width-hover));max-width:calc(var(--sidebar-width) + var(--divider-width-hover));position:relative;overflow:hidden;overflow:clip;transition:min-width ease-in-out,max-width ease-in-out;transition-duration:.2s;contain:size}#left-sidebar{left:0}#right-sidebar{right:0}.sidebar.is-collapsed{min-width:0;max-width:0}.sidebar.floating{position:absolute}.sidebar .leaf-content{height:100%;min-width:calc(var(--sidebar-width) - var(--divider-width-hover));top:0;padding:var(--sidebar-margin);padding-top:4em;line-height:var(--line-height-tight);background-color:var(--background-secondary);transition:background-color,border-right,border-left,box-shadow;transition-duration:var(--color-fade-speed);transition-timing-function:ease-in-out;position:absolute;display:flex;flex-direction:column}.sidebar:not(.is-collapsed) .leaf-content{min-width:calc(max(100%,var(--sidebar-width)) - 3px);max-width:calc(max(100%,var(--sidebar-width)) - 3px)}#left-sidebar-content{left:0;border-top-right-radius:var(--radius-l);border-bottom-right-radius:var(--radius-l)}#right-sidebar-content{right:0;border-top-left-radius:var(--radius-l);border-bottom-left-radius:var(--radius-l)}.sidebar #left-sidebar-content,.sidebar #right-sidebar-content{contain:none!important;container-type:normal!important;animation:none!important}.sidebar:has(.leaf-content:empty):has(.topbar-content:empty){display:none}.sidebar-topbar{height:calc(2.3em + 2 * var(--sidebar-margin));width:var(--sidebar-width);padding:var(--sidebar-margin);z-index:1;position:fixed;display:flex;align-items:center;transition:width ease-in-out;transition-duration:inherit}.sidebar.is-collapsed .sidebar-topbar{width:calc(2.3em + var(--sidebar-margin) * 2)}.sidebar .sidebar-topbar.is-collapsed{width:0}#left-sidebar .sidebar-topbar{left:0;flex-direction:row;border-top-right-radius:var(--radius-l)}#right-sidebar .sidebar-topbar{right:0;flex-direction:row-reverse;border-top-left-radius:var(--radius-l)}#left-sidebar .topbar-content{margin-right:calc(2.3em + var(--sidebar-margin));flex-direction:row}#right-sidebar .topbar-content{margin-left:calc(2.3em + var(--sidebar-margin));flex-direction:row-reverse}.topbar-content{overflow:hidden visible;overflow:clip visible;width:100%;height:100%;display:flex;align-items:center;transition:inherit}.sidebar.is-collapsed .topbar-content{width:0;transition:inherit}.clickable-icon.sidebar-collapse-icon{background-color:transparent;color:var(--icon-color-focused);padding:2px!important;margin:0!important;height:100%!important;width:2.3em!important;margin-inline:0.14em!important;position:absolute}#left-sidebar .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);right:var(--sidebar-margin)}#right-sidebar .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);left:var(--sidebar-margin)}.clickable-icon.sidebar-collapse-icon svg.svg-icon{width:100%;height:100%}.feature-title{margin-left:1px;text-transform:uppercase;letter-spacing:.06em;margin-top:.75em;margin-bottom:.75em}.feature-header{display:flex;align-items:center;padding-top:0;font-size:1em;padding-left:0}body.floating-sidebars .sidebar{position:absolute}body{transition:background-color var(--color-fade-speed) ease-in-out}#navbar:not(:empty){display:flex;align-items:center;justify-content:space-between;padding:.5em 1em;width:100%}#main{display:flex;flex-direction:column;height:100%;width:100%;align-items:stretch;justify-content:center}#main-horizontal{display:flex;flex-direction:row;flex-grow:1;width:100%;align-items:stretch;justify-content:center}#center-content{flex-basis:100%;max-width:100%;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;transition:opacity .2s ease-in-out;contain:inline-size}.hide{opacity:0!important;transition:opacity .2s ease-in-out;pointer-events:none}#center-content>.obsidian-document{padding-left:2em;padding-right:1em;margin-bottom:0;width:100%;width:-webkit-fill-available;width:-moz-available;width:fill-available;transition:background-color var(--color-fade-speed) ease-in-out;border-top-right-radius:var(--window-radius,var(--radius-m));border-top-left-radius:var(--window-radius,var(--radius-m));overflow-x:hidden!important;overflow-y:auto!important;display:flex!important;flex-direction:column!important;align-items:center!important;contain:inline-size}body #center-content>.obsidian-document>.markdown-preview-sizer{padding-bottom:80vh;width:100%;max-width:var(--line-width);flex-basis:var(--line-width);transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}#center-content>.obsidian-document>div{width:100%!important;transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}#center-content>.obsidian-document:not([data-type=markdown]).embed{display:flex;padding:1em;height:100%;width:100%;align-items:center;justify-content:center}#center-content>.obsidian-document:not([data-type=markdown]).embed>*{max-width:100%;max-height:100%;object-fit:contain}:not(h1,h2,h3,h4,h5,h6,li):has(> :is(.math,table)){overflow-x:auto!important}#center-content>.obsidian-document:not([data-type=markdown]){overflow-x:auto;contain:content;padding:0;margin:0;height:100%}.obsidian-document[data-type=attachment]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;width:100%}.obsidian-document[data-type=attachment]>*{outline:0;border:none;box-shadow:none}.obsidian-document[data-type=attachment] :is(img){max-width:90%;max-height:90%;object-fit:contain}.obsidian-document[data-type=attachment]>:is(audio){width:100%;max-width:min(90%,var(--line-width))}.obsidian-document[data-type=attachment]>:is(embed,iframe,video){width:100%;height:100%;max-width:100%;max-height:100%;object-fit:contain}.canvas-wrapper>:is(.header,.footer){z-index:100;position:absolute;display:flex;justify-content:center;flex-direction:column;width:100%;align-items:center}.scroll-highlight{position:absolute;width:100%;height:100%;pointer-events:none;z-index:1000;background-color:hsla(var(--color-accent-hsl),.25);opacity:0;padding:1em;inset:50%;translate:-50% -50%;border-radius:var(--radius-s)}</style><script defer="">async function loadIncludes(){let e=document.querySelectorAll("link[itemprop='include']");for(const t of e){let e=t.getAttribute("href");try{let o="";if(e.startsWith("https:")||e.startsWith("http:")||"file:"!=window.location.protocol){const n=await fetch(e);if(!n.ok){console.log("Could not include file: "+e),t?.remove();continue}o=await n.text()}else{const t=document.getElementById(btoa(encodeURI(e)));if(t){const e=JSON.parse(decodeURI(atob(t.getAttribute("value")??"")));o=e?.data??""}}let n=document.createRange().createContextualFragment(o);t.before(n),t.remove(),console.log("Included text: "+o),console.log("Included file: "+e)}catch(o){t?.remove(),console.log("Could not include file: "+e,o);continue}}}document.addEventListener("DOMContentLoaded",(()=>{loadIncludes()}));let isFileProtocol="file:"==location.protocol;function waitLoadScripts(e,t){let o=e.map((e=>document.getElementById(e+"-script")));!function e(n){let l=o[n],c=n+1;l?(l&&"true"!=l.getAttribute("loaded")||n<o.length&&e(c),n<o.length&&l.addEventListener("load",(()=>e(c)))):n<o.length?e(c):t()}(0)}</script></head><body class="publish css-settings-manager mod-windows is-frameless is-hidden-frameless styled-scrollbars show-inline-title show-ribbon background-settings-workplace-theme-dark-in-the-sky background-image-settings-markdown-page-custom notebook-liked-markdown-page-grid-notebook-1 panel-page-bg-theme-light-custom panel-page-bg-theme-dark-plant hide-left-ribbon-retention-drawer toggle-divider-lines toggle-header-bottom-line bt-bubble-layout bt-bubble-layout-hide-borders remove-heading-indicator h1-toggle-underline toggle-left-aligned-content fancy-hr-no-icon custom-unordered-list custom-ordered-list list-no-border folder-icons bt-toggle-colorful-folder folder-style-change-options-colorful-default folder-colorful-one table-width-auto table-style-two link-underline-internal enable-alternative-checkboxes default-loading-page loading-text-typing-style rainbow-tag translucent-setting-panel underline-tab-style canvas-card-text-middle admonition-bg-color-same toggle-calendar-shadow style-options-for-buttons-plugin dataview-list-style-pacman memos-banner-gradient thino-frosted-style thino-background-default quiet-outline-optimize code-theme-sublime is-focused"><script defer="">let theme=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");"dark"==theme?(document.body.classList.add("theme-dark"),document.body.classList.remove("theme-light")):(document.body.classList.add("theme-light"),document.body.classList.remove("theme-dark")),window.innerWidth<480?document.body.classList.add("is-phone"):window.innerWidth<768?document.body.classList.add("is-tablet"):window.innerWidth<1024?document.body.classList.add("is-small-screen"):document.body.classList.add("is-large-screen")</script><div class="parsed-feature-container" style="display: contents;"><link itemprop="include" href="site-lib/html/custom-head-content-content.html"></div><div id="main"><div id="navbar"></div><div id="main-horizontal"><div id="left-content" class="leaf" style="--sidebar-width: var(--sidebar-width-left);"><div id="left-sidebar" class="sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><div id="search-container"><div id="search-wrapper"><input enterkeyhint="search" type="search" spellcheck="false" placeholder="Search..."><div aria-label="Clear search" id="search-clear-button"></div></div></div></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content-wrapper"><div id="left-sidebar-content" class="leaf-content"><link itemprop="include" href="site-lib/html/file-tree-content.html"></div></div><script defer="">let ls = document.querySelector("#left-sidebar"); ls.classList.toggle("is-collapsed", window.innerWidth < 768); ls.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-left-width"));</script></div></div><div id="center-content" class="leaf"><div class="obsidian-document markdown-preview-view markdown-rendered node-insert-event allow-fold-headings show-indentation-guide show-properties is-readable-line-width" data-type="markdown"><style id="MJX-CHTML-styles"></style><div class="markdown-preview-sizer markdown-preview-section"><div class="header"><h1 class="page-title heading inline-title" id="8._字符串_0">8. 字符串</h1><div class="data-bar"></div></div><div class="markdown-preview-pusher" style="width: 1px; height: 0.1px; margin-bottom: 0px;"></div><div class="el-h2"><h2 data-heading="8.1 字符串基础" dir="auto" class="heading" id="8.1_字符串基础_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>8.1 字符串基础</h2></div><div class="el-p"><p dir="auto">字符串是编程中最常用的数据类型之一。在 Lua 中，字符串是不可变的，但提供了丰富的操作函数。</p></div><div class="el-h3"><h3 data-heading="8.1.1 字符串的创建" dir="auto" class="heading" id="8.1.1_字符串的创建_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>8.1.1 字符串的创建</h3></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token comment">-- Lua有几种创建字符串的方式</span>

<span class="token comment">-- 1. 双引号</span>
<span class="token keyword">local</span> str1 <span class="token operator">=</span> <span class="token string">"Hello, Lua!"</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"双引号: "</span> <span class="token operator">..</span> str1<span class="token punctuation">)</span>

<span class="token comment">-- 2. 单引号</span>
<span class="token keyword">local</span> str2 <span class="token operator">=</span> <span class="token string">'Hello, World!'</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"单引号: "</span> <span class="token operator">..</span> str2<span class="token punctuation">)</span>

<span class="token comment">-- 3. 长括号（多行字符串）</span>
<span class="token keyword">local</span> str3 <span class="token operator">=</span> <span class="token string">[[
这是多行字符串
可以包含换行和"各种引号"
而无需转义]]</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"长括号:\n"</span> <span class="token operator">..</span> str3<span class="token punctuation">)</span>

<span class="token comment">-- 4. 带有等号的长括号（可以嵌套）</span>
<span class="token keyword">local</span> str4 <span class="token operator">=</span> <span class="token string">[=[
多层嵌套 [[不会结束字符串]]
]=]</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"带等号的长括号: "</span> <span class="token operator">..</span> str4<span class="token punctuation">)</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h4"><h4 data-heading="转义符" dir="auto" class="heading" id="转义符_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>转义符</h4></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token comment">-- 转义字符，用于输入特殊字符</span>
<span class="token keyword">local</span> escaped <span class="token operator">=</span> <span class="token string">"第一行\n换行\t制表符（缩进）\"引号\\反斜杠"</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"转义字符示例:\n"</span> <span class="token operator">..</span> escaped<span class="token punctuation">)</span>

<span class="token comment">-- 特殊字符的表示</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Unicode字符: \u{4F60}\u{597D}"</span><span class="token punctuation">)</span>  <span class="token comment">-- 你好</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"十六进制: \x48\x65\x6C\x6C\x6F"</span><span class="token punctuation">)</span>  <span class="token comment">-- Hello</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">所有转义符见 <a data-href="6. 字符串#转义字符" href="总结/6.-字符串.html#转义字符" class="internal-link" target="_self" rel="noopener nofollow">6. 字符串 &gt; 转义字符</a></p></div><div class="el-h3"><h3 data-heading="8.1.2 字符串是不可变的" dir="auto" class="heading" id="8.1.2_字符串是不可变的_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>8.1.2 字符串是不可变的</h3></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token comment">-- 重要概念：Lua字符串是不可变的</span>
<span class="token keyword">local</span> original <span class="token operator">=</span> <span class="token string">"Hello"</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"原始字符串: "</span> <span class="token operator">..</span> original<span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"原始字符串内存地址（通过tostring）: "</span> <span class="token operator">..</span> <span class="token function">tostring</span><span class="token punctuation">(</span>original<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">-- 看起来像是"修改"了字符串</span>
original <span class="token operator">=</span> original <span class="token operator">..</span> <span class="token string">" World"</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"修改后: "</span> <span class="token operator">..</span> original<span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"修改后内存地址: "</span> <span class="token operator">..</span> <span class="token function">tostring</span><span class="token punctuation">(</span>original<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">-- 注意：实际上是创建了一个新的字符串</span>

<span class="token comment">-- 证明不可变性</span>
<span class="token keyword">local</span> a <span class="token operator">=</span> <span class="token string">"Hello"</span>
<span class="token keyword">local</span> b <span class="token operator">=</span> <span class="token string">"Hello"</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\na和b相同吗？ "</span> <span class="token operator">..</span> <span class="token function">tostring</span><span class="token punctuation">(</span>a <span class="token operator">==</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">-- true</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"a的内存地址: "</span> <span class="token operator">..</span> <span class="token function">tostring</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"b的内存地址: "</span> <span class="token operator">..</span> <span class="token function">tostring</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">-- Lua会复用相同的字符串，所以a和b可能指向同一内存</span>

<span class="token comment">-- 实际影响：大量字符串操作时要注意性能</span>
<span class="token keyword">function</span> <span class="token function">slow_string_build</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">local</span> result <span class="token operator">=</span> <span class="token string">""</span>
    <span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10000</span> <span class="token keyword">do</span>
        result <span class="token operator">=</span> result <span class="token operator">..</span> <span class="token string">"x"</span>  <span class="token comment">-- 每次都会创建新字符串</span>
    <span class="token keyword">end</span>
    <span class="token keyword">return</span> result
<span class="token keyword">end</span>

<span class="token comment">-- 更好的方式：使用table.concat</span>
<span class="token keyword">function</span> <span class="token function">fast_string_build</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">local</span> parts <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10000</span> <span class="token keyword">do</span>
        parts<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"x"</span>
    <span class="token keyword">end</span>
    <span class="token keyword">return</span> table<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>parts<span class="token punctuation">)</span>
<span class="token keyword">end</span>

<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n字符串构建方式比较:"</span><span class="token punctuation">)</span>
<span class="token comment">-- 注意：在实际中，fast_string_build会比slow_string_build快得多</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h2"><h2 data-heading="8.2 字符串基本操作" dir="auto" class="heading" id="8.2_字符串基本操作_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>8.2 字符串基本操作</h2></div><div class="el-h3"><h3 data-heading="8.2.1 # - 字符串长度" dir="auto" class="heading" id="8.2.1_#_-_字符串长度_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>8.2.1 # - 字符串长度</h3></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token comment">-- 使用 # 运算符符获取字符串长度</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"=== 字符串长度 ==="</span><span class="token punctuation">)</span>

<span class="token keyword">local</span> str <span class="token operator">=</span> <span class="token string">"Hello, Lua!"</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"字符串: "</span> <span class="token operator">..</span> str<span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"长度: "</span> <span class="token operator">..</span> <span class="token operator">#</span>str<span class="token punctuation">)</span>  <span class="token comment">-- 11（英文和标点）</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"长度: "</span> <span class="token operator">..</span> string<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">)</span>	<span class="token comment">-- 使用 string.len，与上面等价，但是只能操作字符串</span>

<span class="token comment">-- 中文字符</span>
<span class="token keyword">local</span> chinese <span class="token operator">=</span> <span class="token string">"你好，世界！"</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n中文字符串: "</span> <span class="token operator">..</span> chinese<span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"长度: "</span> <span class="token operator">..</span> <span class="token operator">#</span>chinese<span class="token punctuation">)</span>  <span class="token comment">-- 18（每个中文字符算三个长度）</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"长度: "</span> <span class="token operator">..</span> string<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span>chinese<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">-- 包含特殊字符</span>
<span class="token keyword">local</span> special <span class="token operator">=</span> <span class="token string">"Line1\nLine2\tTab"</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n特殊字符字符串: "</span> <span class="token operator">..</span> special<span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"长度: "</span> <span class="token operator">..</span> <span class="token operator">#</span>special<span class="token punctuation">)</span>  <span class="token comment">-- 15（\n算一个字符，\t算一个字符）</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"长度: "</span> <span class="token operator">..</span> string<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span>special<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">-- 空字符串</span>
<span class="token keyword">local</span> empty <span class="token operator">=</span> <span class="token string">""</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n空字符串长度: "</span> <span class="token operator">..</span> <span class="token operator">#</span>empty<span class="token punctuation">)</span>  <span class="token comment">-- 0</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h3"><h3 data-heading="8.2.2 .. / table.concat - 字符串连接" dir="auto" class="heading" id="8.2.2_.._/_table.concat_-_字符串连接_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>8.2.2 .. / table.concat - 字符串连接</h3></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token comment">-- 使用 .. 连接字符串</span>
<span class="token comment">-- 基本连接</span>
<span class="token keyword">local</span> greeting <span class="token operator">=</span> <span class="token string">"Hello"</span> <span class="token operator">..</span> <span class="token string">", "</span> <span class="token operator">..</span> <span class="token string">"World!"</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"连接结果: "</span> <span class="token operator">..</span> greeting<span class="token punctuation">)</span>

<span class="token comment">-- 连接不同类型的值</span>
<span class="token keyword">local</span> name <span class="token operator">=</span> <span class="token string">"小明"</span>
<span class="token keyword">local</span> age <span class="token operator">=</span> <span class="token number">18</span>
<span class="token keyword">local</span> info <span class="token operator">=</span> <span class="token string">"姓名: "</span> <span class="token operator">..</span> name <span class="token operator">..</span> <span class="token string">", 年龄: "</span> <span class="token operator">..</span> age
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"信息: "</span> <span class="token operator">..</span> info<span class="token punctuation">)</span>

<span class="token comment">-- 大量连接时的性能问题</span>
<span class="token keyword">local</span> start_time <span class="token operator">=</span> os<span class="token punctuation">.</span><span class="token function">clock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">local</span> result <span class="token operator">=</span> <span class="token string">""</span>

<span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1000</span> <span class="token keyword">do</span>
    result <span class="token operator">=</span> result <span class="token operator">..</span> <span class="token string">"x"</span>  <span class="token comment">-- 每次创建新字符串</span>
<span class="token keyword">end</span>

<span class="token keyword">local</span> end_time <span class="token operator">=</span> os<span class="token punctuation">.</span><span class="token function">clock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n直接连接1000次耗时: "</span> <span class="token operator">..</span> <span class="token punctuation">(</span>end_time <span class="token operator">-</span> start_time<span class="token punctuation">)</span> <span class="token operator">..</span> <span class="token string">"秒"</span><span class="token punctuation">)</span>

<span class="token comment">-- 使用table.concat提高性能</span>
start_time <span class="token operator">=</span> os<span class="token punctuation">.</span><span class="token function">clock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">local</span> parts <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1000</span> <span class="token keyword">do</span>
    parts<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"x"</span>
<span class="token keyword">end</span>

result <span class="token operator">=</span> table<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>parts<span class="token punctuation">)</span>
end_time <span class="token operator">=</span> os<span class="token punctuation">.</span><span class="token function">clock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"使用table.concat耗时: "</span> <span class="token operator">..</span> <span class="token punctuation">(</span>end_time <span class="token operator">-</span> start_time<span class="token punctuation">)</span> <span class="token operator">..</span> <span class="token string">"秒"</span><span class="token punctuation">)</span>

<span class="token comment">-- table.concat的高级用法</span>
<span class="token keyword">local</span> words <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"Hello"</span><span class="token punctuation">,</span> <span class="token string">"World"</span><span class="token punctuation">,</span> <span class="token string">"from"</span><span class="token punctuation">,</span> <span class="token string">"Lua"</span><span class="token punctuation">}</span>
<span class="token keyword">local</span> sentence <span class="token operator">=</span> table<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>words<span class="token punctuation">,</span> <span class="token string">" "</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>  <span class="token comment">-- 从第2个到第4个，用空格连接</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n部分连接: "</span> <span class="token operator">..</span> sentence<span class="token punctuation">)</span>  <span class="token comment">-- "World from Lua"</span>

<span class="token comment">-- 实际应用：构建SQL查询</span>
<span class="token keyword">local</span> conditions <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"age &gt; 18"</span><span class="token punctuation">,</span> <span class="token string">"status = 'active'"</span><span class="token punctuation">,</span> <span class="token string">"score &gt;= 60"</span><span class="token punctuation">}</span>
<span class="token keyword">local</span> where_clause <span class="token operator">=</span> <span class="token string">"WHERE "</span> <span class="token operator">..</span> table<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>conditions<span class="token punctuation">,</span> <span class="token string">" AND "</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"SQL查询: SELECT * FROM users "</span> <span class="token operator">..</span> where_clause<span class="token punctuation">)</span>

<span class="token comment">-- 实际应用：构建URL</span>
<span class="token keyword">local</span> base_url <span class="token operator">=</span> <span class="token string">"https://api.example.com"</span>
<span class="token keyword">local</span> path <span class="token operator">=</span> <span class="token string">"users"</span>
<span class="token keyword">local</span> query_params <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"limit=10"</span><span class="token punctuation">,</span> <span class="token string">"offset=0"</span><span class="token punctuation">,</span> <span class="token string">"sort=name"</span><span class="token punctuation">}</span>
<span class="token keyword">local</span> url <span class="token operator">=</span> base_url <span class="token operator">..</span> <span class="token string">"/"</span> <span class="token operator">..</span> path <span class="token operator">..</span> <span class="token string">"?"</span> <span class="token operator">..</span> table<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>query_params<span class="token punctuation">,</span> <span class="token string">"&amp;"</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"URL: "</span> <span class="token operator">..</span> url<span class="token punctuation">)</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h3"><h3 data-heading="8.2.3 string.rep - 字符串重复" dir="auto" class="heading" id="8.2.3_string.rep_-_字符串重复_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>8.2.3 string.rep - 字符串重复</h3></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded">string<span class="token punctuation">.</span><span class="token function">rep</span><span class="token punctuation">(</span>重复的字符串<span class="token punctuation">:</span> str<span class="token punctuation">,</span> 重复次数<span class="token punctuation">:</span> int<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> 字符串结果<span class="token punctuation">:</span> str
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h4"><h4 data-heading="示例" dir="auto" class="heading" id="示例_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>示例</h4></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token comment">-- 基本重复</span>
<span class="token keyword">local</span> stars <span class="token operator">=</span> string<span class="token punctuation">.</span><span class="token function">rep</span><span class="token punctuation">(</span><span class="token string">"*"</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"10个星号: "</span> <span class="token operator">..</span> stars<span class="token punctuation">)</span>
<span class="token comment">-- 输出 10个星号: **********</span>

<span class="token comment">-- 带分隔符的重复</span>
<span class="token keyword">local</span> dashed_line <span class="token operator">=</span> string<span class="token punctuation">.</span><span class="token function">rep</span><span class="token punctuation">(</span><span class="token string">"-"</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"分隔线: "</span> <span class="token operator">..</span> dashed_line<span class="token punctuation">)</span>
<span class="token comment">-- 输出 分隔线: ------------------------------</span>

<span class="token comment">-- 重复多个字符</span>
<span class="token keyword">local</span> pattern <span class="token operator">=</span> string<span class="token punctuation">.</span><span class="token function">rep</span><span class="token punctuation">(</span><span class="token string">"*-"</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"模式: "</span> <span class="token operator">..</span> pattern<span class="token punctuation">)</span>
<span class="token comment">-- 输出 模式: *-*-*-*-*-*-*-*-*-*-*-*-*-*-*-</span>

<span class="token comment">-- 实际应用：进度条</span>
<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">create_progress_bar</span><span class="token punctuation">(</span>percentage<span class="token punctuation">,</span> width<span class="token punctuation">)</span>
    <span class="token keyword">local</span> filled <span class="token operator">=</span> math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>percentage <span class="token operator">*</span> width <span class="token operator">/</span> <span class="token number">100</span><span class="token punctuation">)</span>
    <span class="token keyword">local</span> empty <span class="token operator">=</span> width <span class="token operator">-</span> filled
    
    <span class="token keyword">local</span> bar <span class="token operator">=</span> <span class="token string">"["</span> <span class="token operator">..</span> 
                string<span class="token punctuation">.</span><span class="token function">rep</span><span class="token punctuation">(</span><span class="token string">"="</span><span class="token punctuation">,</span> filled<span class="token punctuation">)</span> <span class="token operator">..</span> 
                string<span class="token punctuation">.</span><span class="token function">rep</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">,</span> empty<span class="token punctuation">)</span> <span class="token operator">..</span> 
                <span class="token string">"] "</span> <span class="token operator">..</span> 
                string<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"%3d%%"</span><span class="token punctuation">,</span> percentage<span class="token punctuation">)</span>
    <span class="token keyword">return</span> bar
<span class="token keyword">end</span>

<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n进度条:"</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">10</span> <span class="token keyword">do</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token function">create_progress_bar</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">end</span>
<span class="token comment">--[[ 输出
进度条:
[                    ]   0%
[==                  ]  10%
[====                ]  20%
[======              ]  30%
[========            ]  40%
[==========          ]  50%
[============        ]  60%
[==============      ]  70%
[================    ]  80%
[==================  ]  90%
[====================] 100%
--]]</span>

<span class="token comment">-- 实际应用：缩进文本</span>
<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">indent_text</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> indent_level<span class="token punctuation">)</span>
    <span class="token keyword">local</span> indent <span class="token operator">=</span> string<span class="token punctuation">.</span><span class="token function">rep</span><span class="token punctuation">(</span><span class="token string">"  "</span><span class="token punctuation">,</span> indent_level<span class="token punctuation">)</span>
    <span class="token keyword">return</span> indent <span class="token operator">..</span> text
<span class="token keyword">end</span>

<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n缩进文本:"</span><span class="token punctuation">)</span>
<span class="token keyword">local</span> lines <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">"第一级"</span><span class="token punctuation">,</span>
    <span class="token string">"第二级"</span><span class="token punctuation">,</span>
    <span class="token string">"第三级"</span>
<span class="token punctuation">}</span>

<span class="token keyword">for</span> i<span class="token punctuation">,</span> line <span class="token keyword">in</span> <span class="token function">ipairs</span><span class="token punctuation">(</span>lines<span class="token punctuation">)</span> <span class="token keyword">do</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token function">indent_text</span><span class="token punctuation">(</span>line<span class="token punctuation">,</span> i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">end</span>
<span class="token comment">--[[ 输出
缩进文本:
第一级
  第二级
    第三级
--]]</span>

<span class="token comment">-- 创建表格边框</span>
<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">create_table_border</span><span class="token punctuation">(</span>width<span class="token punctuation">)</span>
    <span class="token keyword">local</span> border <span class="token operator">=</span> <span class="token string">"+"</span> <span class="token operator">..</span> string<span class="token punctuation">.</span><span class="token function">rep</span><span class="token punctuation">(</span><span class="token string">"-"</span><span class="token punctuation">,</span> width<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">..</span> <span class="token string">"+"</span>
    <span class="token keyword">return</span> border
<span class="token keyword">end</span>

<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n表格边框:"</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">create_table_border</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"|         内容           |"</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">create_table_border</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">--[[ 输出
表格边框:
+-----------------------+
|         内容           |
+-----------------------+
--]]</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h2"><h2 data-heading="8.3 字符串查找和提取" dir="auto" class="heading" id="8.3_字符串查找和提取_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>8.3 字符串查找和提取</h2></div><div class="el-h3"><h3 data-heading="8.3.1 string.find - 字符串查找" dir="auto" class="heading" id="8.3.1_string.find_-_字符串查找_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>8.3.1 string.find - 字符串查找</h3></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded">string<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>字符串<span class="token punctuation">:</span> str<span class="token punctuation">,</span> 查找的字符串<span class="token punctuation">:</span> str<span class="token punctuation">,</span> 搜索位置?<span class="token punctuation">:</span> int<span class="token punctuation">,</span> 是否不使用正则模式?<span class="token punctuation">:</span> bool<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> 起始索引<span class="token punctuation">:</span> int<span class="token punctuation">,</span> 结束索引<span class="token punctuation">:</span> int<span class="token operator">|</span> <span class="token keyword">nil</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span>搜索位置可以一个负数，表示从后往前数的字符个数</li>
</ul></div><div class="el-h4"><h4 data-heading="示例" dir="auto" class="heading" id="示例_1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>示例</h4></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token keyword">local</span> text <span class="token operator">=</span> <span class="token string">"Hello, Lua programming is fun!"</span>

<span class="token comment">-- 查找子串</span>
<span class="token keyword">local</span> start_pos<span class="token punctuation">,</span> end_pos <span class="token operator">=</span> string<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> <span class="token string">"Lua"</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> start_pos <span class="token keyword">then</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"找到'Lua'在位置: "</span> <span class="token operator">..</span> start_pos <span class="token operator">..</span> <span class="token string">"-"</span> <span class="token operator">..</span> end_pos<span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"子串: "</span> <span class="token operator">..</span> string<span class="token punctuation">.</span><span class="token function">sub</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> start_pos<span class="token punctuation">,</span> end_pos<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">else</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"未找到"</span><span class="token punctuation">)</span>
<span class="token keyword">end</span>

<span class="token comment">-- 从指定位置开始查找</span>
<span class="token keyword">local</span> pos <span class="token operator">=</span> string<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> <span class="token string">"o"</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span>  <span class="token comment">-- 从第5个字符开始找</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n从第5位开始找'o': "</span> <span class="token operator">..</span> <span class="token punctuation">(</span>pos <span class="token keyword">or</span> <span class="token string">"未找到"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>		<span class="token comment">-- 14</span>

<span class="token comment">-- 查找最后一个匹配</span>
<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">find_last</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> pattern<span class="token punctuation">)</span>
    <span class="token keyword">local</span> last_pos
    <span class="token keyword">local</span> current_pos <span class="token operator">=</span> <span class="token number">1</span>
    
    <span class="token keyword">while</span> <span class="token keyword">true</span> <span class="token keyword">do</span>
        <span class="token keyword">local</span> start<span class="token punctuation">,</span> finish <span class="token operator">=</span> string<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> pattern<span class="token punctuation">,</span> current_pos<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> start <span class="token keyword">then</span> 
        	<span class="token keyword">break</span>
        <span class="token keyword">end</span>
        
        last_pos <span class="token operator">=</span> start
        current_pos <span class="token operator">=</span> start <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token keyword">end</span>
    
    <span class="token keyword">return</span> last_pos
<span class="token keyword">end</span>

<span class="token keyword">local</span> last_o <span class="token operator">=</span> <span class="token function">find_last</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> <span class="token string">"o"</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"最后一个'o'在位置: "</span> <span class="token operator">..</span> <span class="token punctuation">(</span>last_o <span class="token keyword">or</span> <span class="token string">"未找到"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">-- 查找所有匹配</span>
<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">find_all</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> pattern<span class="token punctuation">)</span>
    <span class="token keyword">local</span> positions <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">local</span> current_pos <span class="token operator">=</span> <span class="token number">1</span>
    
    <span class="token keyword">while</span> <span class="token keyword">true</span> <span class="token keyword">do</span>
        <span class="token keyword">local</span> start<span class="token punctuation">,</span> finish <span class="token operator">=</span> string<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> pattern<span class="token punctuation">,</span> current_pos<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> start <span class="token keyword">then</span> <span class="token keyword">break</span> <span class="token keyword">end</span>
        
        table<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>positions<span class="token punctuation">,</span> <span class="token punctuation">{</span>start <span class="token operator">=</span> start<span class="token punctuation">,</span> finish <span class="token operator">=</span> finish<span class="token punctuation">}</span><span class="token punctuation">)</span>
        current_pos <span class="token operator">=</span> start <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token keyword">end</span>
    
    <span class="token keyword">return</span> positions
<span class="token keyword">end</span>

<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n 查找所有'o':"</span><span class="token punctuation">)</span>
<span class="token keyword">local</span> all_o <span class="token operator">=</span> <span class="token function">find_all</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> <span class="token string">"o"</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i<span class="token punctuation">,</span> pos <span class="token keyword">in</span> <span class="token function">ipairs</span><span class="token punctuation">(</span>all_o<span class="token punctuation">)</span> <span class="token keyword">do</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"  匹配"</span> <span class="token operator">..</span> i <span class="token operator">..</span> <span class="token string">": 位置"</span> <span class="token operator">..</span> pos<span class="token punctuation">.</span>start <span class="token operator">..</span> <span class="token string">"-"</span> <span class="token operator">..</span> pos<span class="token punctuation">.</span>finish<span class="token punctuation">)</span>
<span class="token keyword">end</span>

<span class="token comment">-- 实际应用：查找邮箱地址</span>
<span class="token keyword">local</span> email_text <span class="token operator">=</span> <span class="token string">"联系我: user@example.com 或 admin@test.org "</span>
<span class="token keyword">local</span> email_pattern <span class="token operator">=</span> <span class="token string">"[%w%.%-]+@[%w%.%-]+%.[%w]+"</span>

<span class="token keyword">local</span> email_start<span class="token punctuation">,</span> email_end <span class="token operator">=</span> string<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>email_text<span class="token punctuation">,</span> email_pattern<span class="token punctuation">)</span>
<span class="token keyword">if</span> email_start <span class="token keyword">then</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n 找到邮箱: "</span> <span class="token operator">..</span> string<span class="token punctuation">.</span><span class="token function">sub</span><span class="token punctuation">(</span>email_text<span class="token punctuation">,</span> email_start<span class="token punctuation">,</span> email_end<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">end</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h3"><h3 data-heading="8.3.2 string.sub - 字符串截取" dir="auto" class="heading" id="8.3.2_string.sub_-_字符串截取_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>8.3.2 string.sub - 字符串截取</h3></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded">string<span class="token punctuation">.</span><span class="token function">sub</span><span class="token punctuation">(</span>字符串<span class="token punctuation">:</span> str<span class="token punctuation">,</span> 截取起始位置<span class="token punctuation">:</span> int<span class="token punctuation">,</span> 截取结束位置?<span class="token punctuation">:</span> int<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> 字符串<span class="token punctuation">:</span> str
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span>截取结束位置默认为 -1（截取到最后一个）</li>
</ul></div><div class="el-h4"><h4 data-heading="示例" dir="auto" class="heading" id="示例_2"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>示例</h4></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token keyword">local</span> sentence <span class="token operator">=</span> <span class="token string">"The quick brown fox jumps over the lazy dog"</span>

<span class="token comment">-- 提取子串</span>
<span class="token keyword">local</span> first_word <span class="token operator">=</span> string<span class="token punctuation">.</span><span class="token function">sub</span><span class="token punctuation">(</span>sentence<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"第一个单词: "</span> <span class="token operator">..</span> first_word<span class="token punctuation">)</span>  <span class="token comment">-- The</span>

<span class="token comment">-- 使用负索引（从末尾开始）</span>
<span class="token keyword">local</span> last_word <span class="token operator">=</span> string<span class="token punctuation">.</span><span class="token function">sub</span><span class="token punctuation">(</span>sentence<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span>  <span class="token comment">-- 最后 3 个字符</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"最后三个字符: "</span> <span class="token operator">..</span> last_word<span class="token punctuation">)</span>  <span class="token comment">-- dog</span>

<span class="token comment">-- 提取中间部分</span>
<span class="token keyword">local</span> middle <span class="token operator">=</span> string<span class="token punctuation">.</span><span class="token function">sub</span><span class="token punctuation">(</span>sentence<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"第 5-14 个字符: "</span> <span class="token operator">..</span> middle<span class="token punctuation">)</span>  <span class="token comment">-- quick bro</span>

<span class="token comment">-- 实际应用：提取文件名和扩展名</span>
<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">find_last</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> pattern<span class="token punctuation">)</span>
    <span class="token keyword">local</span> last_pos
    <span class="token keyword">local</span> current_pos <span class="token operator">=</span> <span class="token number">1</span>

    <span class="token keyword">while</span> <span class="token keyword">true</span> <span class="token keyword">do</span>
        <span class="token keyword">local</span> start<span class="token punctuation">,</span> finish <span class="token operator">=</span> string<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> pattern<span class="token punctuation">,</span> current_pos<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> start <span class="token keyword">then</span> <span class="token keyword">break</span> <span class="token keyword">end</span>

        last_pos <span class="token operator">=</span> start
        current_pos <span class="token operator">=</span> start <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token keyword">end</span>

    <span class="token keyword">return</span> last_pos
<span class="token keyword">end</span>

<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">split_filename</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span>
    <span class="token keyword">local</span> name_without_ext <span class="token operator">=</span> filename
    <span class="token keyword">local</span> ext <span class="token operator">=</span> <span class="token string">""</span>
    
    <span class="token comment">-- 查找最后一个点</span>
    <span class="token keyword">local</span> dot_pos <span class="token operator">=</span> <span class="token function">find_last</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">"%."</span><span class="token punctuation">)</span>
    
    <span class="token keyword">if</span> dot_pos <span class="token keyword">and</span> dot_pos <span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token keyword">then</span>
        name_without_ext <span class="token operator">=</span> string<span class="token punctuation">.</span><span class="token function">sub</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> dot_pos <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
        ext <span class="token operator">=</span> string<span class="token punctuation">.</span><span class="token function">sub</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> dot_pos <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">end</span>
    
    <span class="token keyword">return</span> name_without_ext<span class="token punctuation">,</span> ext
<span class="token keyword">end</span>

<span class="token keyword">local</span> files <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"document.pdf"</span><span class="token punctuation">,</span> <span class="token string">"image.jpg"</span><span class="token punctuation">,</span> <span class="token string">"no_extension"</span><span class="token punctuation">,</span> <span class="token string">".hidden"</span><span class="token punctuation">,</span> <span class="token string">"archive.tar.gz"</span><span class="token punctuation">}</span>

<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n 文件名分割:"</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> _<span class="token punctuation">,</span> filename <span class="token keyword">in</span> <span class="token function">ipairs</span><span class="token punctuation">(</span>files<span class="token punctuation">)</span> <span class="token keyword">do</span>
    <span class="token keyword">local</span> name<span class="token punctuation">,</span> ext <span class="token operator">=</span> <span class="token function">split_filename</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span>string<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"  %-20s -&gt; 名称: %-15s 扩展名: %s"</span><span class="token punctuation">,</span> filename<span class="token punctuation">,</span> name<span class="token punctuation">,</span> ext<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">end</span>

<span class="token comment">-- 实际应用：提取 URL 各部分</span>
<span class="token keyword">function</span> <span class="token function">parse_url</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
    <span class="token keyword">local</span> protocol<span class="token punctuation">,</span> domain<span class="token punctuation">,</span> path
    
    <span class="token comment">-- 查找协议</span>
    <span class="token keyword">local</span> protocol_end <span class="token operator">=</span> string<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token string">"://"</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> protocol_end <span class="token keyword">then</span>
        protocol <span class="token operator">=</span> string<span class="token punctuation">.</span><span class="token function">sub</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> protocol_end <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
        url <span class="token operator">=</span> string<span class="token punctuation">.</span><span class="token function">sub</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> protocol_end <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">)</span>
    <span class="token keyword">end</span>
    
    <span class="token comment">-- 查找路径</span>
    <span class="token keyword">local</span> path_start <span class="token operator">=</span> string<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token string">"/"</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> path_start <span class="token keyword">then</span>
        domain <span class="token operator">=</span> string<span class="token punctuation">.</span><span class="token function">sub</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> path_start <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
        path <span class="token operator">=</span> string<span class="token punctuation">.</span><span class="token function">sub</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> path_start<span class="token punctuation">)</span>
    <span class="token keyword">else</span>
        domain <span class="token operator">=</span> url
        path <span class="token operator">=</span> <span class="token string">"/"</span>
    <span class="token keyword">end</span>
    
    <span class="token keyword">return</span> protocol<span class="token punctuation">,</span> domain<span class="token punctuation">,</span> path
<span class="token keyword">end</span>

<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\nURL 解析:"</span><span class="token punctuation">)</span>
<span class="token keyword">local</span> urls <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">"https://www.example.com/path/to/page"</span><span class="token punctuation">,</span>
    <span class="token string">"http://localhost:8080"</span><span class="token punctuation">,</span>
    <span class="token string">"ftp://files.server.com/download/file.zip"</span>
<span class="token punctuation">}</span>

<span class="token keyword">for</span> _<span class="token punctuation">,</span> url <span class="token keyword">in</span> <span class="token function">ipairs</span><span class="token punctuation">(</span>urls<span class="token punctuation">)</span> <span class="token keyword">do</span>
    <span class="token keyword">local</span> protocol<span class="token punctuation">,</span> domain<span class="token punctuation">,</span> path <span class="token operator">=</span> <span class="token function">parse_url</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span>string<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"  %-40s -&gt; 协议: %-6s 域名: %-20s 路径: %s"</span><span class="token punctuation">,</span> 
          url<span class="token punctuation">,</span> protocol <span class="token keyword">or</span> <span class="token string">"无"</span><span class="token punctuation">,</span> domain<span class="token punctuation">,</span> path<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">end</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h3"><h3 data-heading="8.3.3 字符串分割" dir="auto" class="heading" id="8.3.3_字符串分割_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>8.3.3 字符串分割</h3></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token comment">-- Lua 没有内置的字符串分割函数，需要自己实现</span>
<span class="token comment">-- 按分隔符分割字符串</span>
<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">string_split</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> delimiter<span class="token punctuation">)</span>
    <span class="token keyword">local</span> result <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">local</span> pattern <span class="token operator">=</span> string<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"([^%s]+)"</span><span class="token punctuation">,</span> delimiter<span class="token punctuation">)</span>
    
    <span class="token keyword">for</span> match <span class="token keyword">in</span> string<span class="token punctuation">.</span><span class="token function">gmatch</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> pattern<span class="token punctuation">)</span> <span class="token keyword">do</span>
        table<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> match<span class="token punctuation">)</span>
    <span class="token keyword">end</span>
    
    <span class="token keyword">return</span> result
<span class="token keyword">end</span>

<span class="token comment">-- 按空格分割</span>
<span class="token keyword">local</span> sentence <span class="token operator">=</span> <span class="token string">"The quick brown fox jumps over the lazy dog"</span>
<span class="token keyword">local</span> words <span class="token operator">=</span> <span class="token function">string_split</span><span class="token punctuation">(</span>sentence<span class="token punctuation">,</span> <span class="token string">" "</span><span class="token punctuation">)</span>

<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n 句子单词:"</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> i<span class="token punctuation">,</span> word <span class="token keyword">in</span> <span class="token function">ipairs</span><span class="token punctuation">(</span>words<span class="token punctuation">)</span> <span class="token keyword">do</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"  单词"</span> <span class="token operator">..</span> i <span class="token operator">..</span> <span class="token string">": "</span> <span class="token operator">..</span> word<span class="token punctuation">)</span>
<span class="token keyword">end</span>
<span class="token comment">--[[ 输出
句子单词:
 单词1: The
 单词2: quick
 单词3: brown
 单词4: fox
 单词5: jumps
 单词6: over
 单词7: the
 单词8: lazy
 单词9: dog
--]]</span>

<span class="token comment">-- 按行分割</span>
<span class="token keyword">local</span> multi_line <span class="token operator">=</span> <span class="token string">"第一行\n 第二行\n 第三行"</span>
<span class="token keyword">local</span> lines <span class="token operator">=</span> <span class="token function">string_split</span><span class="token punctuation">(</span>multi_line<span class="token punctuation">,</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>

<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n 按行分割:"</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> i<span class="token punctuation">,</span> line <span class="token keyword">in</span> <span class="token function">ipairs</span><span class="token punctuation">(</span>lines<span class="token punctuation">)</span> <span class="token keyword">do</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"  行"</span> <span class="token operator">..</span> i <span class="token operator">..</span> <span class="token string">": "</span> <span class="token operator">..</span> line<span class="token punctuation">)</span>
<span class="token keyword">end</span>
<span class="token comment">--[[ 输出
按行分割:
 行1: 第一行
 行2:  第二行
 行3:  第三行
--]]</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h2"><h2 data-heading="8.4 - 字符串模式匹配" dir="auto" class="heading" id="8.4_-_字符串模式匹配_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>8.4 - 字符串模式匹配</h2></div><div class="el-p"><p dir="auto">Lua 的模式匹配（pattern matching）是一种轻量级的正则表达式，功能强大但语法更简单，使用具有特殊意义的符号（修饰符）表示各种字符。</p></div><div class="el-p"><p dir="auto">所有模式匹配修饰符见 <a data-href="6. 字符串#模式匹配修饰符" href="总结/6.-字符串.html#模式匹配修饰符" class="internal-link" target="_self" rel="noopener nofollow">6. 字符串 &gt; 模式匹配修饰符</a></p></div><div class="el-h3"><h3 data-heading="8.4.1 string.match - 匹配单个模式" dir="auto" class="heading" id="8.4.1_string.match_-_匹配单个模式_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>8.4.1 string.match - 匹配单个模式</h3></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded">string<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>字符串<span class="token punctuation">:</span> str<span class="token punctuation">,</span> 匹配模式<span class="token punctuation">:</span> pattern<span class="token punctuation">,</span> 起始位置?<span class="token punctuation">:</span> init<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> 匹配结果<span class="token punctuation">:</span> str
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h4"><h4 data-heading="示例" dir="auto" class="heading" id="示例_3"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>示例</h4></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token comment">-- Lua 模式匹配的特殊字符</span>

<span class="token comment">-- . 匹配任意字符</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"'.'匹配任意字符: "</span> <span class="token operator">..</span> string<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token string">"abc123"</span><span class="token punctuation">,</span> <span class="token string">"."</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">-- %a 匹配字母</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"'%a'匹配字母: "</span> <span class="token operator">..</span> string<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token string">"abc123!@#"</span><span class="token punctuation">,</span> <span class="token string">"%a"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">-- %d 匹配数字</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"'%d'匹配数字: "</span> <span class="token operator">..</span> string<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token string">"abc123!@#"</span><span class="token punctuation">,</span> <span class="token string">"%d"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">--[[ 输出
'.'匹配任意字符: a
'%a'匹配字母: a
'%d'匹配数字: 1
--]]</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h3"><h3 data-heading="8.4.2 string.gmatch - 匹配多个模式" dir="auto" class="heading" id="8.4.2_string.gmatch_-_匹配多个模式_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>8.4.2 string.gmatch - 匹配多个模式</h3></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded">string<span class="token punctuation">.</span><span class="token function">gmatch</span><span class="token punctuation">(</span>字符串<span class="token punctuation">:</span> str<span class="token punctuation">,</span> 匹配模式<span class="token punctuation">:</span> str<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> 迭代器函数<span class="token punctuation">:</span> func
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h4"><h4 data-heading="示例" dir="auto" class="heading" id="示例_4"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>示例</h4></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token comment">-- . 匹配任意字符</span>
<span class="token keyword">local</span> matches <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">for</span> match <span class="token keyword">in</span> string<span class="token punctuation">.</span><span class="token function">gmatch</span><span class="token punctuation">(</span><span class="token string">"abc123"</span><span class="token punctuation">,</span> <span class="token string">"."</span><span class="token punctuation">)</span> <span class="token keyword">do</span>	<span class="token comment">-- 迭代器函数用于遍历，每次调用 string.match 匹配字符串中下一个结果</span>
    table<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>matches<span class="token punctuation">,</span> match<span class="token punctuation">)</span>
<span class="token keyword">end</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"'.'匹配任意字符: "</span> <span class="token operator">..</span> table<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>matches<span class="token punctuation">,</span> <span class="token string">", "</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">-- %a 匹配字母</span>
matches <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">for</span> match <span class="token keyword">in</span> string<span class="token punctuation">.</span><span class="token function">gmatch</span><span class="token punctuation">(</span><span class="token string">"abc123!@#"</span><span class="token punctuation">,</span> <span class="token string">"%a"</span><span class="token punctuation">)</span> <span class="token keyword">do</span>
    table<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>matches<span class="token punctuation">,</span> match<span class="token punctuation">)</span>
<span class="token keyword">end</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"'%a'匹配字母: "</span> <span class="token operator">..</span> table<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>matches<span class="token punctuation">,</span> <span class="token string">", "</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">-- %d 匹配数字</span>
matches <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">for</span> match <span class="token keyword">in</span> string<span class="token punctuation">.</span><span class="token function">gmatch</span><span class="token punctuation">(</span><span class="token string">"abc123!@#"</span><span class="token punctuation">,</span> <span class="token string">"%d"</span><span class="token punctuation">)</span> <span class="token keyword">do</span>
    table<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>matches<span class="token punctuation">,</span> match<span class="token punctuation">)</span>
<span class="token keyword">end</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"'%d'匹配数字: "</span> <span class="token operator">..</span> table<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>matches<span class="token punctuation">,</span> <span class="token string">", "</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">--[[ 输出
'.'匹配任意字符: a, b, c, 1, 2, 3
'%a'匹配字母: a, b, c
'%d'匹配数字: 1, 2, 3
--]]</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h3"><h3 data-heading="8.4.3 [] - 字符类" dir="auto" class="heading" id="8.4.3_[]_-_字符类_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>8.4.3 [] - 字符类</h3></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token comment">-- 字符类：用 [] 定义自定义字符集</span>
<span class="token keyword">local</span> text <span class="token operator">=</span> <span class="token string">"abc123!@ #DEF "</span>

<span class="token comment">-- [abc] 匹配 a、b 或 c</span>
<span class="token keyword">local</span> matches <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">for</span> match <span class="token keyword">in</span> string<span class="token punctuation">.</span><span class="token function">gmatch</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> <span class="token string">"[abc]"</span><span class="token punctuation">)</span> <span class="token keyword">do</span>
    table<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>matches<span class="token punctuation">,</span> match<span class="token punctuation">)</span>
<span class="token keyword">end</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"[abc]匹配: "</span> <span class="token operator">..</span> table<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>matches<span class="token punctuation">,</span> <span class="token string">", "</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">-- [0-9] 匹配数字</span>
matches <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">for</span> match <span class="token keyword">in</span> string<span class="token punctuation">.</span><span class="token function">gmatch</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> <span class="token string">"[0-9]"</span><span class="token punctuation">)</span> <span class="token keyword">do</span>
    table<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>matches<span class="token punctuation">,</span> match<span class="token punctuation">)</span>
<span class="token keyword">end</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"[0-9]匹配: "</span> <span class="token operator">..</span> table<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>matches<span class="token punctuation">,</span> <span class="token string">", "</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">-- [A-Z] 匹配大写字母</span>
matches <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">for</span> match <span class="token keyword">in</span> string<span class="token punctuation">.</span><span class="token function">gmatch</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> <span class="token string">"[A-Z]"</span><span class="token punctuation">)</span> <span class="token keyword">do</span>
    table<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>matches<span class="token punctuation">,</span> match<span class="token punctuation">)</span>
<span class="token keyword">end</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"[A-Z]匹配: "</span> <span class="token operator">..</span> table<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>matches<span class="token punctuation">,</span> <span class="token string">", "</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">-- [^abc] 匹配除了 a、b、c 之外的字符</span>
matches <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">for</span> match <span class="token keyword">in</span> string<span class="token punctuation">.</span><span class="token function">gmatch</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> <span class="token string">"[^abc]"</span><span class="token punctuation">)</span> <span class="token keyword">do</span>
    table<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>matches<span class="token punctuation">,</span> match<span class="token punctuation">)</span>
<span class="token keyword">end</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"[^abc]匹配: "</span> <span class="token operator">..</span> table<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>matches<span class="token punctuation">,</span> <span class="token string">", "</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">-- 组合字符类</span>
matches <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">for</span> match <span class="token keyword">in</span> string<span class="token punctuation">.</span><span class="token function">gmatch</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> <span class="token string">"[a-z0-9]"</span><span class="token punctuation">)</span> <span class="token keyword">do</span>
    table<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>matches<span class="token punctuation">,</span> match<span class="token punctuation">)</span>
<span class="token keyword">end</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"[a-z0-9]匹配: "</span> <span class="token operator">..</span> table<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>matches<span class="token punctuation">,</span> <span class="token string">", "</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">-- 实际应用：验证用户名</span>
<span class="token keyword">function</span> <span class="token function">validate_username</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span>
    <span class="token comment">-- 用户名要求：字母开头，只能包含字母、数字、下划线，长度 3-20</span>
    <span class="token keyword">local</span> pattern <span class="token operator">=</span> <span class="token string">"^[a-zA-Z][%w_]{2,19}$"</span>
    <span class="token keyword">return</span> string<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span> pattern<span class="token punctuation">)</span> <span class="token operator">~=</span> <span class="token keyword">nil</span>
<span class="token keyword">end</span>

<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n 用户名验证:"</span><span class="token punctuation">)</span>
<span class="token keyword">local</span> test_usernames <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"abc"</span><span class="token punctuation">,</span> <span class="token string">"123"</span><span class="token punctuation">,</span> <span class="token string">"a_1"</span><span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">,</span> <span class="token string">"very_long_username_here"</span><span class="token punctuation">,</span> <span class="token string">"user-name"</span><span class="token punctuation">}</span>
<span class="token keyword">for</span> _<span class="token punctuation">,</span> name <span class="token keyword">in</span> <span class="token function">ipairs</span><span class="token punctuation">(</span>test_usernames<span class="token punctuation">)</span> <span class="token keyword">do</span>
    <span class="token function">print</span><span class="token punctuation">(</span>string<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"  %-25s -&gt; %s"</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> <span class="token function">validate_username</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token string">"有效"</span> <span class="token keyword">or</span> <span class="token string">"无效"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">end</span>

<span class="token comment">-- 实际应用：提取颜色代码</span>
<span class="token keyword">function</span> <span class="token function">extract_color_codes</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span>
    <span class="token keyword">local</span> colors <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    
    <span class="token comment">-- 匹配 #RRGGBB 或 #RGB 格式</span>
    <span class="token keyword">for</span> code <span class="token keyword">in</span> string<span class="token punctuation">.</span><span class="token function">gmatch</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> <span class="token string">"#[0-9a-fA-F]+"</span><span class="token punctuation">)</span> <span class="token keyword">do</span>
        <span class="token keyword">if</span> <span class="token operator">#</span>code <span class="token operator">==</span> <span class="token number">4</span> <span class="token keyword">or</span> <span class="token operator">#</span>code <span class="token operator">==</span> <span class="token number">7</span> <span class="token keyword">then</span>  <span class="token comment">-- #RGB 或 #RRGGBB</span>
            table<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>colors<span class="token punctuation">,</span> code<span class="token punctuation">)</span>
        <span class="token keyword">end</span>
    <span class="token keyword">end</span>
    
    <span class="token keyword">return</span> colors
<span class="token keyword">end</span>

<span class="token keyword">local</span> color_text <span class="token operator">=</span> <span class="token string">"背景色: #FFFFFF , 文字色: #000 , 高亮: #FF0000 , 无效: #12345 "</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n 提取颜色代码:"</span><span class="token punctuation">)</span>
<span class="token keyword">local</span> colors <span class="token operator">=</span> <span class="token function">extract_color_codes</span><span class="token punctuation">(</span>color_text<span class="token punctuation">)</span>
<span class="token keyword">for</span> _<span class="token punctuation">,</span> color <span class="token keyword">in</span> <span class="token function">ipairs</span><span class="token punctuation">(</span>colors<span class="token punctuation">)</span> <span class="token keyword">do</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"  颜色: "</span> <span class="token operator">..</span> color<span class="token punctuation">)</span>
<span class="token keyword">end</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h3"><h3 data-heading="8.4.4 重复修饰符" dir="auto" class="heading" id="8.4.4_重复修饰符_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>8.4.4 重复修饰符</h3></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token comment">-- 重复修饰符控制匹配次数</span>
<span class="token keyword">local</span> text <span class="token operator">=</span> <span class="token string">"aaabbcccddddeeee"</span>

<span class="token comment">-- * 匹配 0 次或多次（贪婪）</span>
<span class="token keyword">local</span> matches <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">for</span> match <span class="token keyword">in</span> string<span class="token punctuation">.</span><span class="token function">gmatch</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> <span class="token string">"a*"</span><span class="token punctuation">)</span> <span class="token keyword">do</span>
    <span class="token keyword">if</span> <span class="token operator">#</span>match <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">then</span>
        table<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>matches<span class="token punctuation">,</span> <span class="token string">"'"</span> <span class="token operator">..</span> match <span class="token operator">..</span> <span class="token string">"'"</span><span class="token punctuation">)</span>
    <span class="token keyword">end</span>
<span class="token keyword">end</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"*匹配（贪婪）: "</span> <span class="token operator">..</span> table<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>matches<span class="token punctuation">,</span> <span class="token string">", "</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">-- + 匹配 1 次或多次</span>
matches <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">for</span> match <span class="token keyword">in</span> string<span class="token punctuation">.</span><span class="token function">gmatch</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> <span class="token string">"a+"</span><span class="token punctuation">)</span> <span class="token keyword">do</span>
    table<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>matches<span class="token punctuation">,</span> <span class="token string">"'"</span> <span class="token operator">..</span> match <span class="token operator">..</span> <span class="token string">"'"</span><span class="token punctuation">)</span>
<span class="token keyword">end</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"+匹配: "</span> <span class="token operator">..</span> table<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>matches<span class="token punctuation">,</span> <span class="token string">", "</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">-- ? 匹配 0 次或 1 次</span>
matches <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">for</span> match <span class="token keyword">in</span> string<span class="token punctuation">.</span><span class="token function">gmatch</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> <span class="token string">"a?"</span><span class="token punctuation">)</span> <span class="token keyword">do</span>
    table<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>matches<span class="token punctuation">,</span> <span class="token string">"'"</span> <span class="token operator">..</span> match <span class="token operator">..</span> <span class="token string">"'"</span><span class="token punctuation">)</span>
<span class="token keyword">end</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"?匹配: "</span> <span class="token operator">..</span> table<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>matches<span class="token punctuation">,</span> <span class="token string">", "</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">-- - 匹配 0 次或多次（非贪婪）</span>
matches <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">for</span> match <span class="token keyword">in</span> string<span class="token punctuation">.</span><span class="token function">gmatch</span><span class="token punctuation">(</span><span class="token string">"aaaa"</span><span class="token punctuation">,</span> <span class="token string">"a-"</span><span class="token punctuation">)</span> <span class="token keyword">do</span>
    table<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>matches<span class="token punctuation">,</span> <span class="token string">"'"</span> <span class="token operator">..</span> match <span class="token operator">..</span> <span class="token string">"'"</span><span class="token punctuation">)</span>
<span class="token keyword">end</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"-匹配（非贪婪）: "</span> <span class="token operator">..</span> table<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>matches<span class="token punctuation">,</span> <span class="token string">", "</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">--[[ 输出
*匹配（贪婪）: 'aaa'
+匹配: 'aaa'
?匹配: 'a', 'a', 'a', '', '', '', '', '', '', '', '', '', '', '', '', '', ''
-匹配（非贪婪）: '', '', '', '', ''
--]]</span>

<span class="token comment">-- 实际应用：匹配浮点数</span>
<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">extract_numbers</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span>
    <span class="token keyword">local</span> numbers <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    
    <span class="token comment">-- 匹配整数和浮点数</span>
    <span class="token keyword">for</span> num <span class="token keyword">in</span> string<span class="token punctuation">.</span><span class="token function">gmatch</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> <span class="token string">"[+-]?%d+%.?%d*"</span><span class="token punctuation">)</span> <span class="token keyword">do</span>
        <span class="token comment">-- 过滤掉单独的点和无效格式</span>
        <span class="token keyword">if</span> num <span class="token operator">~=</span> <span class="token string">"."</span> <span class="token keyword">and</span> num <span class="token operator">~=</span> <span class="token string">"+"</span> <span class="token keyword">and</span> num <span class="token operator">~=</span> <span class="token string">"-"</span> <span class="token keyword">then</span>
            table<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>numbers<span class="token punctuation">,</span> num<span class="token punctuation">)</span>
        <span class="token keyword">end</span>
    <span class="token keyword">end</span>
    
    <span class="token keyword">return</span> numbers
<span class="token keyword">end</span>

<span class="token keyword">local</span> number_text <span class="token operator">=</span> <span class="token string">"价格: 12.5, -3.14, +100, .5, 3., abc, 123"</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n 提取数字:"</span><span class="token punctuation">)</span>
<span class="token keyword">local</span> numbers <span class="token operator">=</span> <span class="token function">extract_numbers</span><span class="token punctuation">(</span>number_text<span class="token punctuation">)</span>

<span class="token keyword">for</span> _<span class="token punctuation">,</span> num <span class="token keyword">in</span> <span class="token function">ipairs</span><span class="token punctuation">(</span>numbers<span class="token punctuation">)</span> <span class="token keyword">do</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"  数字: "</span> <span class="token operator">..</span> num<span class="token punctuation">)</span>
<span class="token keyword">end</span>
<span class="token comment">--[[ 输出
提取数字:
  数字: 12.5
  数字: -3.14
  数字: +100
  数字: 5
  数字: 3.
  数字: 123
--]]</span>

<span class="token comment">-- 实际应用：匹配 HTML 标签</span>
<span class="token keyword">function</span> <span class="token function">extract_html_tags</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span>
    <span class="token keyword">local</span> tags <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    
    <span class="token comment">-- 简单匹配标签（不包括属性）</span>
    <span class="token keyword">for</span> tag <span class="token keyword">in</span> string<span class="token punctuation">.</span><span class="token function">gmatch</span><span class="token punctuation">(</span>html<span class="token punctuation">,</span> <span class="token string">"&lt;([^&gt;]+)&gt;"</span><span class="token punctuation">)</span> <span class="token keyword">do</span>
        table<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>tags<span class="token punctuation">,</span> tag<span class="token punctuation">)</span>
    <span class="token keyword">end</span>
    
    <span class="token keyword">return</span> tags
<span class="token keyword">end</span>

<span class="token keyword">local</span> html <span class="token operator">=</span> <span class="token string">"&lt;div class='container'&gt;&lt;p&gt;Hello&lt;/p&gt;&lt;br/&gt;&lt;img src='test.jpg'&gt;&lt;/div&gt;"</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n 提取 HTML 标签:"</span><span class="token punctuation">)</span>
<span class="token keyword">local</span> tags <span class="token operator">=</span> <span class="token function">extract_html_tags</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span>

<span class="token keyword">for</span> _<span class="token punctuation">,</span> tag <span class="token keyword">in</span> <span class="token function">ipairs</span><span class="token punctuation">(</span>tags<span class="token punctuation">)</span> <span class="token keyword">do</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"  标签: &lt;"</span> <span class="token operator">..</span> tag <span class="token operator">..</span> <span class="token string">"&gt;"</span><span class="token punctuation">)</span>
<span class="token keyword">end</span>
<span class="token comment">--[[ 输出
提取 HTML 标签:
  标签: &lt;div class='container'&gt;
  标签: &lt;p&gt;
  标签: &lt;/p&gt;
  标签: &lt;br/&gt;
  标签: &lt;img src='test.jpg'&gt;
  标签: &lt;/div&gt;
--]]</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h3"><h3 data-heading="8.4.5 () - 捕获和分组" dir="auto" class="heading" id="8.4.5_()_-_捕获和分组_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>8.4.5 () - 捕获和分组</h3></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token comment">-- 使用()进行捕获</span>
<span class="token comment">-- 基本捕获</span>
<span class="token keyword">local</span> date <span class="token operator">=</span> <span class="token string">"2024-12-27"</span>
<span class="token keyword">local</span> year<span class="token punctuation">,</span> month<span class="token punctuation">,</span> day <span class="token operator">=</span> string<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>date<span class="token punctuation">,</span> <span class="token string">"(%d+)-(%d+)-(%d+)"</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"日期解析:"</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"  年: "</span> <span class="token operator">..</span> <span class="token punctuation">(</span>year <span class="token keyword">or</span> <span class="token string">"无"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"  月: "</span> <span class="token operator">..</span> <span class="token punctuation">(</span>month <span class="token keyword">or</span> <span class="token string">"无"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"  日: "</span> <span class="token operator">..</span> <span class="token punctuation">(</span>day <span class="token keyword">or</span> <span class="token string">"无"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">--[[ 输出
日期解析:
  年: 2024
  月: 12
  日: 27
--]]</span>

<span class="token comment">-- 捕获邮箱的用户名和域名</span>
<span class="token keyword">local</span> email <span class="token operator">=</span> <span class="token string">" user@example.com "</span>
<span class="token keyword">local</span> username<span class="token punctuation">,</span> domain <span class="token operator">=</span> string<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>email<span class="token punctuation">,</span> <span class="token string">"([%w%.%-]+)@([%w%.%-]+%.[%w]+)"</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n 邮箱解析:"</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"  用户名: "</span> <span class="token operator">..</span> <span class="token punctuation">(</span>username <span class="token keyword">or</span> <span class="token string">"无"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"  域名: "</span> <span class="token operator">..</span> <span class="token punctuation">(</span>domain <span class="token keyword">or</span> <span class="token string">"无"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">--[[ 输出
邮箱解析:
 用户名: user
 域名: example.com
--]]</span>

<span class="token comment">-- 使用 gmatch 进行多次捕获</span>
<span class="token keyword">local</span> text <span class="token operator">=</span> <span class="token string">"alice:18,jack:20,bob:22"</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n 解析键值对:"</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> name<span class="token punctuation">,</span> age <span class="token keyword">in</span> string<span class="token punctuation">.</span><span class="token function">gmatch</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> <span class="token string">"([%u%l]+):(%d+)"</span><span class="token punctuation">)</span> <span class="token keyword">do</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"  姓名: "</span> <span class="token operator">..</span> name <span class="token operator">..</span> <span class="token string">", 年龄: "</span> <span class="token operator">..</span> age<span class="token punctuation">)</span>
<span class="token keyword">end</span>
<span class="token comment">--[[ 输出
解析键值对:
 姓名: alice, 年龄: 18
 姓名: jack, 年龄: 20
 姓名: bob, 年龄: 22
--]]</span>

<span class="token comment">-- 捕获 URL 各部分</span>
<span class="token keyword">function</span> <span class="token function">parse_url_detail</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
    <span class="token keyword">local</span> pattern <span class="token operator">=</span> <span class="token string">"^([%w]+)://([^/]+)(.*)$"</span>
    <span class="token keyword">local</span> protocol<span class="token punctuation">,</span> host<span class="token punctuation">,</span> path <span class="token operator">=</span> string<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> pattern<span class="token punctuation">)</span>
    
    <span class="token keyword">return</span> protocol<span class="token punctuation">,</span> host<span class="token punctuation">,</span> path
<span class="token keyword">end</span>

<span class="token comment">-- 实际应用：提取和格式化日期</span>
<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">reformat_date</span><span class="token punctuation">(</span>date_str<span class="token punctuation">)</span>
    <span class="token comment">-- 支持多种日期格式</span>
    <span class="token keyword">local</span> patterns <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string">"(%d%d%d%d)[-/](%d%d)[-/](%d%d)"</span><span class="token punctuation">,</span>  <span class="token comment">-- YYYY-MM-DD</span>
        <span class="token string">"(%d%d)[-/](%d%d)[-/](%d%d%d%d)"</span>   <span class="token comment">-- MM-DD-YYYY</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">for</span> _<span class="token punctuation">,</span> pattern <span class="token keyword">in</span> <span class="token function">ipairs</span><span class="token punctuation">(</span>patterns<span class="token punctuation">)</span> <span class="token keyword">do</span>
        <span class="token keyword">local</span> y<span class="token punctuation">,</span> m<span class="token punctuation">,</span> d <span class="token operator">=</span> string<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>date_str<span class="token punctuation">,</span> pattern<span class="token punctuation">)</span>
        
        <span class="token keyword">if</span> y <span class="token keyword">and</span> m <span class="token keyword">and</span> d <span class="token keyword">then</span>
            <span class="token comment">-- 如果年份是 2 位数，假设是 19xx 或 20xx</span>
            <span class="token keyword">if</span> <span class="token operator">#</span>y <span class="token operator">==</span> <span class="token number">2</span> <span class="token keyword">then</span>
                <span class="token keyword">local</span> temp <span class="token operator">=</span> y
                y <span class="token operator">=</span> d
                d <span class="token operator">=</span> temp
            <span class="token keyword">end</span>
            
            <span class="token keyword">return</span> string<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"%s 年 %s 月 %s 日"</span><span class="token punctuation">,</span> y<span class="token punctuation">,</span> m<span class="token punctuation">,</span> d<span class="token punctuation">)</span>
        <span class="token keyword">end</span>
    <span class="token keyword">end</span>
    
    <span class="token keyword">return</span> date_str  <span class="token comment">-- 无法解析，返回原样</span>
<span class="token keyword">end</span>

<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n 日期格式化:"</span><span class="token punctuation">)</span>
<span class="token keyword">local</span> dates <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"2024-12-27"</span><span class="token punctuation">,</span> <span class="token string">"12/27/2024"</span><span class="token punctuation">,</span> <span class="token string">"24-01-15"</span><span class="token punctuation">,</span> <span class="token string">"无效日期"</span><span class="token punctuation">}</span>
<span class="token keyword">for</span> _<span class="token punctuation">,</span> date <span class="token keyword">in</span> <span class="token function">ipairs</span><span class="token punctuation">(</span>dates<span class="token punctuation">)</span> <span class="token keyword">do</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"  "</span> <span class="token operator">..</span> date <span class="token operator">..</span> <span class="token string">" -&gt; "</span> <span class="token operator">..</span> <span class="token function">reformat_date</span><span class="token punctuation">(</span>date<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">end</span>
<span class="token comment">--[[ 输出
日期格式化:
 2024-12-27 -&gt; 2024 年 12 月 27 日
 12/27/2024 -&gt; 2024 年 27 月 12 日
 24-01-15 -&gt; 24-01-15
 无效日期 -&gt; 无效日期
--]]</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h3"><h3 data-heading="8.4.6 string.gsub - 字符串替换" dir="auto" class="heading" id="8.4.6_string.gsub_-_字符串替换_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>8.4.6 string.gsub - 字符串替换</h3></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded">string<span class="token punctuation">.</span><span class="token function">gsub</span><span class="token punctuation">(</span>字符串<span class="token punctuation">:</span> str<span class="token punctuation">,</span> 匹配模式<span class="token punctuation">:</span> str<span class="token punctuation">,</span> 替换为<span class="token punctuation">:</span> str<span class="token punctuation">,</span> 替换次数?<span class="token punctuation">:</span> int<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> 替换后的字符串<span class="token punctuation">:</span> str<span class="token punctuation">,</span> 替换次数<span class="token punctuation">:</span> int
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span>不指定替换次数将会替换所有匹配的字符串</li>
</ul></div><div class="el-h4"><h4 data-heading="示例" dir="auto" class="heading" id="示例_5"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>示例</h4></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token comment">-- 基本替换</span>
<span class="token keyword">local</span> text <span class="token operator">=</span> <span class="token string">"Hello World"</span>
<span class="token keyword">local</span> replaced <span class="token operator">=</span> string<span class="token punctuation">.</span><span class="token function">gsub</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> <span class="token string">"World"</span><span class="token punctuation">,</span> <span class="token string">"Lua"</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"基本替换: "</span> <span class="token operator">..</span> replaced<span class="token punctuation">)</span>
<span class="token comment">-- 输出 基本替换: Hello Lua</span>

<span class="token comment">-- 限制替换次数</span>
<span class="token keyword">local</span> text <span class="token operator">=</span> <span class="token string">"Hello World World World"</span>
<span class="token keyword">local</span> replaced <span class="token operator">=</span> string<span class="token punctuation">.</span><span class="token function">gsub</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> <span class="token string">"World"</span><span class="token punctuation">,</span> <span class="token string">"Lua"</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"替换两次: "</span> <span class="token operator">..</span> replaced<span class="token punctuation">)</span>
<span class="token comment">-- 输出 替换两次: Hello Lua Lua World</span>

<span class="token comment">-- 使用模式匹配替换</span>
<span class="token keyword">local</span> text <span class="token operator">=</span> <span class="token string">"Price: $10.99, Discount: 20%"</span>
<span class="token keyword">local</span> replaced <span class="token operator">=</span> string<span class="token punctuation">.</span><span class="token function">gsub</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> <span class="token string">"%$%d+%.%d%d"</span><span class="token punctuation">,</span> <span class="token string">"[价格隐藏]"</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"隐藏价格: "</span> <span class="token operator">..</span> replaced<span class="token punctuation">)</span>
<span class="token comment">-- 输出 隐藏价格: Price: [价格隐藏], Discount: 20%</span>

<span class="token comment">-- 使用函数进行替换</span>
<span class="token keyword">local</span> text <span class="token operator">=</span> <span class="token string">"The temperature is 25C and humidity is 60%"</span>
<span class="token keyword">local</span> replaced <span class="token operator">=</span> string<span class="token punctuation">.</span><span class="token function">gsub</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> <span class="token string">"(%d+)(%a?)"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> unit<span class="token punctuation">)</span>
    <span class="token keyword">if</span> unit <span class="token operator">==</span> <span class="token string">"C"</span> <span class="token keyword">then</span>
        <span class="token comment">-- 摄氏度转华氏度</span>
        <span class="token keyword">local</span> f <span class="token operator">=</span> <span class="token function">tonumber</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">9</span><span class="token operator">/</span><span class="token number">5</span> <span class="token operator">+</span> <span class="token number">32</span>
        <span class="token keyword">return</span> string<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"%.1fF"</span><span class="token punctuation">,</span> f<span class="token punctuation">)</span>
    <span class="token keyword">end</span>
    
    <span class="token keyword">return</span> value <span class="token operator">..</span> unit
<span class="token keyword">end</span><span class="token punctuation">)</span>

<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"单位转换: "</span> <span class="token operator">..</span> replaced<span class="token punctuation">)</span>
<span class="token comment">-- 输出 单位转换: The temperature is 77.0F and humidity is 60%</span>

<span class="token comment">-- 使用%n 引用捕获</span>
<span class="token comment">-- %1, %2 等引用之前的捕获</span>
<span class="token keyword">local</span> text <span class="token operator">=</span> <span class="token string">"Hello World"</span>
<span class="token keyword">local</span> swapped <span class="token operator">=</span> string<span class="token punctuation">.</span><span class="token function">gsub</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> <span class="token string">"(%S+)%s+(%S+)"</span><span class="token punctuation">,</span> <span class="token string">"%2 %1"</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n 交换单词:"</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"  原始: "</span> <span class="token operator">..</span> text<span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"  交换后: "</span> <span class="token operator">..</span> swapped<span class="token punctuation">)</span>
<span class="token comment">--[[ 输出
交换单词:
 原始: Hello World
 交换后: World Hello
--]]</span>

<span class="token comment">-- 实际应用：模板渲染（更好的方法是字符串格式化）</span>
<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">render_template</span><span class="token punctuation">(</span>template<span class="token punctuation">,</span> data<span class="token punctuation">)</span>
    <span class="token keyword">local</span> result <span class="token operator">=</span> string<span class="token punctuation">.</span><span class="token function">gsub</span><span class="token punctuation">(</span>template<span class="token punctuation">,</span> <span class="token string">"{{([%w_]+)}}"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
        <span class="token keyword">return</span> data<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token keyword">or</span> <span class="token string">""</span>
    <span class="token keyword">end</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> result
<span class="token keyword">end</span>

<span class="token keyword">local</span> template <span class="token operator">=</span> <span class="token string">"尊敬的 {{name}} ：您订购的 {{product}} 已发货，订单号： {{order_id}} "</span>
<span class="token keyword">local</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
    name <span class="token operator">=</span> <span class="token string">"张三"</span><span class="token punctuation">,</span>
    product <span class="token operator">=</span> <span class="token string">"Lua 编程书籍"</span><span class="token punctuation">,</span>
    order_id <span class="token operator">=</span> <span class="token string">"20241227001"</span>
<span class="token punctuation">}</span>

<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n 模板渲染:"</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"  模板: "</span> <span class="token operator">..</span> template<span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"  数据: "</span> <span class="token operator">..</span> <span class="token string">"name="</span> <span class="token operator">..</span> data<span class="token punctuation">.</span>name <span class="token operator">..</span> <span class="token string">", product="</span> <span class="token operator">..</span> data<span class="token punctuation">.</span>product <span class="token operator">..</span> <span class="token string">", order_id="</span> <span class="token operator">..</span> data<span class="token punctuation">.</span>order_id<span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"  结果: "</span> <span class="token operator">..</span> <span class="token function">render_template</span><span class="token punctuation">(</span>template<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">--[[ 输出
模板渲染:
 模板: 尊敬的 {{name}} ：您订购的 {{product}} 已发货，订单号： {{order_id}} 
 数据: name=张三, product=Lua 编程书籍, order_id=20241227001
 结果: 尊敬的 张三 ：您订购的 Lua 编程书籍 已发货，订单号： 20241227001 
--]]</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h2"><h2 data-heading="8.5 string.format - 字符串格式化" dir="auto" class="heading" id="8.5_string.format_-_字符串格式化_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>8.5 string.format - 字符串格式化</h2></div><div class="el-p"><p dir="auto">简单来说字符串格式化就是将占位符替换为实际值，同时替换时根据占位符来对实际值进行额外处理。</p></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded">string<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>被格式化的字符串<span class="token punctuation">:</span> str<span class="token punctuation">,</span> 替换值<span class="token punctuation">:</span> str<span class="token punctuation">...</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> 格式化后的字符串<span class="token punctuation">:</span> str
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">所有格式化修饰符见 <a data-href="6. 字符串#格式化修饰符" href="总结/6.-字符串.html#格式化修饰符" class="internal-link" target="_self" rel="noopener nofollow">6. 字符串 &gt; 格式化修饰符</a></p></div><div class="el-h4"><h4 data-heading="示例" dir="auto" class="heading" id="示例_6"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>示例</h4></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token comment">-- 基本格式化，%s 表示替换值是字符串，%d 表示替换值是数字</span>
<span class="token keyword">local</span> name <span class="token operator">=</span> <span class="token string">"小明"</span>
<span class="token keyword">local</span> age <span class="token operator">=</span> <span class="token number">18</span>
<span class="token keyword">local</span> formatted <span class="token operator">=</span> string<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"姓名: %s, 年龄: %d"</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> age<span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"基本格式化: "</span> <span class="token operator">..</span> formatted<span class="token punctuation">)</span>
<span class="token comment">-- 输出 姓名: 小明, 年龄: 18</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h4"><h4 data-heading="数字字符串格式化" dir="auto" class="heading" id="数字字符串格式化_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>数字字符串格式化</h4></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token keyword">local</span> price <span class="token operator">=</span> <span class="token number">19.99</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n 数字格式化:"</span><span class="token punctuation">)</span>
<span class="token comment">-- %f 表示浮点数（小数）默认小数精度 6 位</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"  默认: "</span> <span class="token operator">..</span> string<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"%f"</span><span class="token punctuation">,</span> price<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">-- %.nf 表示小数精度</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"  两位小数: "</span> <span class="token operator">..</span> string<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"%.2f"</span><span class="token punctuation">,</span> price<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">-- %d 表示整数，与替换值类型不符会自动转化，如果替换值为浮点会截断小数部分，数字字符串自动转化为数字</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"  整数: "</span> <span class="token operator">..</span> string<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> price<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">-- %e 对替换值进行处理，改为科学计数法表示</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"  科学计数法: "</span> <span class="token operator">..</span> string<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"%e"</span><span class="token punctuation">,</span> price<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">-- %nd 组合使用：整数 %d + n 右对齐</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"  宽度 10，右对齐: "</span> <span class="token operator">..</span> string<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"%10d"</span><span class="token punctuation">,</span> price<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">-- %-nd 组合使用：整数 %d + -n 左对齐</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"  宽度 10，左对齐: "</span> <span class="token operator">..</span> string<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"%-10d"</span><span class="token punctuation">,</span> price<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">-- %0nd 前导零</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"  前导零: "</span> <span class="token operator">..</span> string<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"%04d"</span><span class="token punctuation">,</span> price<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">--[[ 输出
 默认: 19.990000
 两位小数: 19.99
 整数: 19
 科学计数法: 1.999000e+001
 宽度 10，右对齐:      19
 宽度 10，左对齐: 19     
 前导零: 0019
]]</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h4"><h4 data-heading="字符串格式化" dir="auto" class="heading" id="字符串格式化_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>字符串格式化</h4></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token keyword">local</span> text <span class="token operator">=</span> <span class="token string">"Hello"</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n 字符串格式化:"</span><span class="token punctuation">)</span>
<span class="token comment">-- %s 表示字符串，同上与替换值类型不符会自动转化，数字自动转化为数字字符串</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"  默认: "</span> <span class="token operator">..</span> string<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> text<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">-- 同上</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"  宽度 10，右对齐: "</span> <span class="token operator">..</span> string<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"%10s"</span><span class="token punctuation">,</span> text<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"  宽度 10，左对齐: "</span> <span class="token operator">..</span> string<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"%-10s"</span><span class="token punctuation">,</span> text<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">-- %.ns 字符串截断</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"  截断为 3 字符: "</span> <span class="token operator">..</span> string<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"%.3s"</span><span class="token punctuation">,</span> text<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">--[[ 输出
 默认: Hello
 宽度 10，右对齐:      Hello
 宽度 10，左对齐: Hello     
 截断为 3 字符: Hel
--]]</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h4"><h4 data-heading="示例" dir="auto" class="heading" id="示例_7"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>示例</h4></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token comment">-- 实际应用：创建表格</span>
<span class="token keyword">function</span> <span class="token function">create_table</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    <span class="token keyword">local</span> rows <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    
    <span class="token comment">-- 表头</span>
    table<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>rows<span class="token punctuation">,</span> string<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"%-20s %-10s %-10s"</span><span class="token punctuation">,</span> <span class="token string">"姓名"</span><span class="token punctuation">,</span> <span class="token string">"年龄"</span><span class="token punctuation">,</span> <span class="token string">"分数"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    table<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>rows<span class="token punctuation">,</span> string<span class="token punctuation">.</span><span class="token function">rep</span><span class="token punctuation">(</span><span class="token string">"-"</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    
    <span class="token comment">-- 数据行</span>
    <span class="token keyword">for</span> _<span class="token punctuation">,</span> student <span class="token keyword">in</span> <span class="token function">ipairs</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token keyword">do</span>
        <span class="token keyword">local</span> row <span class="token operator">=</span> string<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"%-20s %-10d %-10.1f"</span><span class="token punctuation">,</span> 
                                 student<span class="token punctuation">.</span>name<span class="token punctuation">,</span> student<span class="token punctuation">.</span>age<span class="token punctuation">,</span> student<span class="token punctuation">.</span>score<span class="token punctuation">)</span>
        table<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>rows<span class="token punctuation">,</span> row<span class="token punctuation">)</span>
    <span class="token keyword">end</span>
    
    <span class="token keyword">return</span> table<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>rows<span class="token punctuation">,</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>
<span class="token keyword">end</span>

<span class="token keyword">local</span> students <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token punctuation">{</span>name <span class="token operator">=</span> <span class="token string">"张三"</span><span class="token punctuation">,</span> age <span class="token operator">=</span> <span class="token number">18</span><span class="token punctuation">,</span> score <span class="token operator">=</span> <span class="token number">85.5</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>name <span class="token operator">=</span> <span class="token string">"李四"</span><span class="token punctuation">,</span> age <span class="token operator">=</span> <span class="token number">19</span><span class="token punctuation">,</span> score <span class="token operator">=</span> <span class="token number">92.0</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>name <span class="token operator">=</span> <span class="token string">"王五"</span><span class="token punctuation">,</span> age <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">,</span> score <span class="token operator">=</span> <span class="token number">78.5</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n 学生表格:"</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">create_table</span><span class="token punctuation">(</span>students<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">--[[ 输出
 学生表格:
姓名               年龄     分数    
------------------------------------------
张三               18         85.5      
李四               19         92.0      
王五               20         78.5      
--]]</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h2"><h2 data-heading="8.6 字符串与数字转换" dir="auto" class="heading" id="8.6_字符串与数字转换_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>8.6 字符串与数字转换</h2></div><div class="el-h3"><h3 data-heading="8.6.1 tostring - 字符串转化" dir="auto" class="heading" id="8.6.1_tostring_-_字符串转化_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>8.6.1 tostring - 字符串转化</h3></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token function">tostring</span><span class="token punctuation">(</span>值<span class="token punctuation">:</span> any<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> 字符串<span class="token punctuation">:</span>str
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h4"><h4 data-heading="示例" dir="auto" class="heading" id="示例_8"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>示例</h4></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token keyword">local</span> num <span class="token operator">=</span> <span class="token number">123.456</span>
<span class="token keyword">local</span> str_num <span class="token operator">=</span> <span class="token function">tostring</span><span class="token punctuation">(</span><span class="token number">123.456</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"数字转字符串:"</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span>string<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"  数字: %.3f，类型： %s"</span><span class="token punctuation">,</span> num<span class="token punctuation">,</span> <span class="token function">type</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span>string<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"  字符串: \"%s\"，类型：%s"</span><span class="token punctuation">,</span> str_num<span class="token punctuation">,</span> <span class="token function">type</span><span class="token punctuation">(</span>str_num<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">--[[ 输出
数字: 123.456，类型： number
字符串: "123.456"，类型：string
--]]</span>

<span class="token comment">-- 连接或格式化时自动会将数字转化为字符串</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"连接自动转化字符串："</span> <span class="token operator">..</span> num<span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span>string<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"格式化自动转化字符串：%.3f"</span><span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">--[[ 输出
连接自动转化字符串：123.456
格式化自动转化字符串：123.456000
--]]</span>

<span class="token comment">-- 可以查看内存地址</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"表的内存地址："</span> <span class="token operator">..</span> <span class="token function">tostring</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token number">123</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"函数的内存地址："</span> <span class="token operator">..</span> <span class="token function">tostring</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token number">123</span><span class="token punctuation">,</span> <span class="token number">10</span>
<span class="token keyword">end</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">--[[ 输出
表的内存地址：table: 00D49D00
函数的内存地址：function: 00D4C390
--]]</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h3"><h3 data-heading="8.6.2 tonumber - 字符串转数字" dir="auto" class="heading" id="8.6.2_tonumber_-_字符串转数字_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>8.6.2 tonumber - 字符串转数字</h3></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token function">tonumber</span><span class="token punctuation">(</span>要转化的字符串<span class="token punctuation">:</span> str<span class="token punctuation">,</span> 转化的基数?<span class="token punctuation">:</span> <span class="token number">2</span><span class="token operator">-</span><span class="token number">36</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> 字符串<span class="token punctuation">:</span> str
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h4"><h4 data-heading="示例" dir="auto" class="heading" id="示例_9"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>示例</h4></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token keyword">local</span> str <span class="token operator">=</span> <span class="token string">"123.456"</span>
<span class="token keyword">local</span> num <span class="token operator">=</span> <span class="token function">tonumber</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"字符串转数字:"</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span>string<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"  字符串: \"%s\"，类型：%s"</span><span class="token punctuation">,</span> str<span class="token punctuation">,</span> <span class="token function">type</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span>string<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"  数字: %.3f，类型： %s"</span><span class="token punctuation">,</span> num<span class="token punctuation">,</span> <span class="token function">type</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">--[[ 输出
  字符串: "123.456"，类型：string
  数字: 123.456，类型： number
--]]</span>

<span class="token comment">-- 转换基数</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n 不同基数的转换:"</span><span class="token punctuation">)</span>
<span class="token keyword">local</span> hex_str <span class="token operator">=</span> <span class="token string">"FF"</span>
<span class="token keyword">local</span> dec_num <span class="token operator">=</span> <span class="token function">tonumber</span><span class="token punctuation">(</span>hex_str<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"  十六进制 "</span> <span class="token operator">..</span> hex_str <span class="token operator">..</span> <span class="token string">" -&gt; 十进制 "</span> <span class="token operator">..</span> dec_num<span class="token punctuation">)</span>
<span class="token keyword">local</span> bin_str <span class="token operator">=</span> <span class="token string">"1010"</span>
<span class="token keyword">local</span> bin_num <span class="token operator">=</span> <span class="token function">tonumber</span><span class="token punctuation">(</span>bin_str<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"  二进制 "</span> <span class="token operator">..</span> bin_str <span class="token operator">..</span> <span class="token string">" -&gt; 十进制 "</span> <span class="token operator">..</span> bin_num<span class="token punctuation">)</span>
<span class="token comment">--[[ 输出
 十六进制 FF -&gt; 十进制 255
 二进制 1010 -&gt; 十进制 10
--]]</span>

<span class="token comment">-- 解析字符串中的数字</span>
<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">extract_numbers_from_string</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span>
    <span class="token keyword">local</span> numbers <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    
    <span class="token keyword">for</span> num_str <span class="token keyword">in</span> string<span class="token punctuation">.</span><span class="token function">gmatch</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> <span class="token string">"[+-]?%d+%.?%d*"</span><span class="token punctuation">)</span> <span class="token keyword">do</span>
        <span class="token keyword">local</span> num <span class="token operator">=</span> <span class="token function">tonumber</span><span class="token punctuation">(</span>num_str<span class="token punctuation">)</span>
        <span class="token keyword">if</span> num <span class="token keyword">then</span>
            table<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>numbers<span class="token punctuation">,</span> num<span class="token punctuation">)</span>
        <span class="token keyword">end</span>
    <span class="token keyword">end</span>
    
    <span class="token keyword">return</span> numbers
<span class="token keyword">end</span>

<span class="token keyword">local</span> mixed_text <span class="token operator">=</span> <span class="token string">"攻击 10 次，伤害 25 点"</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n 从字符串提取数字:"</span><span class="token punctuation">)</span>
<span class="token keyword">local</span> numbers <span class="token operator">=</span> <span class="token function">extract_numbers_from_string</span><span class="token punctuation">(</span>mixed_text<span class="token punctuation">)</span>

<span class="token keyword">for</span> i<span class="token punctuation">,</span> num <span class="token keyword">in</span> <span class="token function">ipairs</span><span class="token punctuation">(</span>numbers<span class="token punctuation">)</span> <span class="token keyword">do</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"  数字"</span> <span class="token operator">..</span> i <span class="token operator">..</span> <span class="token string">": "</span> <span class="token operator">..</span> num<span class="token punctuation">)</span>
<span class="token keyword">end</span>
<span class="token comment">--[[ 输出
数字1: 10
数字2: 25
--]]</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h2"><h2 data-heading="8.7 常见错误" dir="auto" class="heading" id="8.7_常见错误_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>8.7 常见错误</h2></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token comment">-- 错误1：混淆模式匹配修饰符 %、格式化修饰符 % 以及转义符 /</span>
<span class="token keyword">local</span> wrong <span class="token operator">=</span> string<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"文件名: %s, 模式: %d+"</span><span class="token punctuation">,</span> s1<span class="token punctuation">,</span> s2<span class="token punctuation">)</span>  <span class="token comment">-- 错误：这里 %d+ 与模式匹配混淆了，+ 不是有效格式符</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h2"><h2 data-heading="8.8 练习" dir="auto" class="heading" id="8.8_练习_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>8.8 练习</h2></div><div class="el-h3"><h3 data-heading="练习 1：简单的文本分析器" dir="auto" class="heading" id="练习_1：简单的文本分析器_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>练习 1：简单的文本分析器</h3></div><div class="el-p"><p dir="auto">（答案见<a data-href="第 1 节 - 语法/参考答案#练习 8 1：简单的文本分析器" href="第-1-节-语法/参考答案.html#练习 8 1：简单的文本分析器" class="internal-link" target="_self" rel="noopener nofollow">第 1 节 - 语法/参考答案 &gt; 练习 8 1：简单的文本分析器</a>）</p></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token comment">-- 写一个文本分析器，可以分析给定的字符串有几行文本，有多少个单词，总字符数，统计最频繁的单词</span>
<span class="token comment">-- 使用示例：</span>
<span class="token comment">-- 测试文本分析器</span>
<span class="token keyword">local</span> test_text <span class="token operator">=</span> <span class="token string">[[
Lua is a powerful, efficient, lightweight, embeddable scripting language.
It supports procedural programming, object-oriented programming, functional
programming, data-driven programming, and data description.

Lua combines simple procedural syntax with powerful data description
constructs based on associative arrays and extensible semantics.
Lua is dynamically typed, runs by interpreting bytecode with a
register-based virtual machine, and has automatic memory management with
incremental garbage collection, making it ideal for configuration,
scripting, and rapid prototyping.
]]</span>

<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"=== 文本分析器 ==="</span><span class="token punctuation">)</span>
analysis<span class="token punctuation">:</span><span class="token function">analyze_text</span><span class="token punctuation">(</span>test_text<span class="token punctuation">)</span>

<span class="token keyword">local</span> data <span class="token operator">=</span> analysis<span class="token punctuation">.</span>data

<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"基本统计:"</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"  总字符数: "</span> <span class="token operator">..</span> data<span class="token punctuation">.</span>total_chars<span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"  行数: "</span> <span class="token operator">..</span> data<span class="token punctuation">.</span>lines<span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"  单词数: "</span> <span class="token operator">..</span> data<span class="token punctuation">.</span>word_count<span class="token punctuation">)</span>

<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n 最频繁的单词:"</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i<span class="token punctuation">,</span> item <span class="token keyword">in</span> <span class="token function">ipairs</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>most_frequent<span class="token punctuation">)</span> <span class="token keyword">do</span>
    <span class="token function">print</span><span class="token punctuation">(</span>string<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"  %2d. %-15s: %d 次"</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> item<span class="token punctuation">.</span>word<span class="token punctuation">,</span> item<span class="token punctuation">.</span>count<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">end</span>
<span class="token comment">--[[ 输出
基本统计:
  总字符数: 582
  行数: 11
  单词数: 70

 最频繁的单词:
   1. and            : 4 次
   2. programming    : 4 次
   3. lua            : 3 次
   4. with           : 3 次
   5. a              : 2 次
--]]</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h2"><h2 data-heading="8.9 本章总结" dir="auto" class="heading" id="8.9_本章总结_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>8.9 本章总结</h2></div><div class="el-h3"><h3 data-heading="关键知识点回顾" dir="auto" class="heading" id="关键知识点回顾_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>关键知识点回顾</h3></div><div class="el-ol"><ol>
<li data-line="0" dir="auto"><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>字符串基础</strong>：</p>
<ul class="has-list-bullet">
<li data-line="1" dir="auto"><span class="list-bullet"></span>三种字符串字面量：双引号、单引号、长括号</li>
<li data-line="2" dir="auto"><span class="list-bullet"></span>字符串是不可变的，操作会创建新字符串</li>
<li data-line="3" dir="auto"><span class="list-bullet"></span>使用 <code>#</code> 获取长度，注意多字节字符</li>
<li data-line="4" dir="auto"><span class="list-bullet"></span>使用 <code>\</code> 转义字符</li>
</ul>
</li>
<li data-line="6" dir="auto"><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>字符串操作</strong>：</p>
<ul class="has-list-bullet">
<li data-line="7" dir="auto"><span class="list-bullet"></span>连接：<code>..</code> 运算符</li>
<li data-line="8" dir="auto"><span class="list-bullet"></span>重复：<code>string.rep</code></li>
<li data-line="9" dir="auto"><span class="list-bullet"></span>性能优化：大量连接时使用 <code>table.concat</code></li>
</ul>
</li>
<li data-line="11" dir="auto"><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>字符串查找和提取</strong>：</p>
<ul class="has-list-bullet">
<li data-line="12" dir="auto"><span class="list-bullet"></span><code>string.find</code>：查找子串位置</li>
<li data-line="13" dir="auto"><span class="list-bullet"></span><code>string.sub</code>：提取子串</li>
</ul>
</li>
<li data-line="15" dir="auto"><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>字符串模式匹配</strong>：</p>
<ul class="has-list-bullet">
<li data-line="16" dir="auto"><span class="list-bullet"></span>字符类：<code>%a</code>（字母）、<code>%d</code>（数字）、<code>%s</code>（空白）等</li>
<li data-line="17" dir="auto"><span class="list-bullet"></span>重复修饰符：<code>*</code>、<code>+</code>、<code>?</code>、<code>-</code>、<code>{n,m}</code></li>
<li data-line="18" dir="auto"><span class="list-bullet"></span>捕获和分组：<code>()</code></li>
<li data-line="19" dir="auto"><span class="list-bullet"></span><code>string.match</code>：单次模式匹配和捕获</li>
<li data-line="20" dir="auto"><span class="list-bullet"></span><code>string.gmatch</code>：多次模式匹配和捕获</li>
<li data-line="21" dir="auto"><span class="list-bullet"></span><code>string.gsub</code>：模式匹配替换</li>
</ul>
</li>
<li data-line="23" dir="auto"><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>字符串格式化</strong>：</p>
<ul class="has-list-bullet">
<li data-line="24" dir="auto"><span class="list-bullet"></span><code>string.format</code>：格式化字符串</li>
<li data-line="25" dir="auto"><span class="list-bullet"></span>格式修饰符：<code>%s</code>（字符串）、<code>%d</code>（整数）、<code>%f</code>（浮点数）等</li>
</ul>
</li>
<li data-line="27" dir="auto"><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>字符串转换</strong>：</p>
<ul class="has-list-bullet">
<li data-line="28" dir="auto"><span class="list-bullet"></span><code>tostring</code>：转换为字符串</li>
<li data-line="29" dir="auto"><span class="list-bullet"></span><code>tonumber</code>：转换为数字，支持指定基数</li>
</ul>
</li>
</ol></div><div class="el-h3"><h3 data-heading="性能优化技巧" dir="auto" class="heading" id="性能优化技巧_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>性能优化技巧</h3></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token comment">-- 1. 对于大量字符串使用表连接</span>
<span class="token comment">-- 不好</span>
<span class="token keyword">local</span> result <span class="token operator">=</span> <span class="token string">""</span>

<span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1000</span> <span class="token keyword">do</span>
    result <span class="token operator">=</span> result <span class="token operator">..</span> <span class="token string">"x"</span>  <span class="token comment">-- 创建 1000 个新字符串</span>
<span class="token keyword">end</span>

<span class="token comment">-- 好</span>
<span class="token keyword">local</span> parts <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1000</span> <span class="token keyword">do</span>
    parts<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"x"</span>
<span class="token keyword">end</span>

<span class="token keyword">local</span> result <span class="token operator">=</span> table<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>parts<span class="token punctuation">)</span>

<span class="token comment">-- 2. 对于少量字符串连接使用字符串格式化</span>

<span class="token comment">-- 不好</span>
<span class="token keyword">local</span> current_path <span class="token operator">=</span> <span class="token string">"D/Program Files/"</span>
<span class="token keyword">local</span> filepath <span class="token operator">=</span> current_path <span class="token operator">..</span> <span class="token string">"steam/"</span> <span class="token operator">..</span> <span class="token string">"common/"</span> <span class="token operator">..</span> <span class="token string">"game"</span>

<span class="token comment">-- 好</span>
<span class="token keyword">local</span> current_path <span class="token operator">=</span> <span class="token string">"D/Program Files"</span>
<span class="token keyword">local</span> filepath <span class="token operator">=</span> string<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"%s/%s/%s/%s"</span><span class="token punctuation">,</span> current_path<span class="token punctuation">,</span> <span class="token string">"steam"</span><span class="token punctuation">,</span> <span class="token string">"common"</span><span class="token punctuation">,</span> <span class="token string">"game"</span><span class="token punctuation">)</span>

<span class="token comment">-- 3. 重用模式对象（对于频繁使用的模式）</span>
<span class="token keyword">local</span> pattern <span class="token operator">=</span> <span class="token string">"[%w%.%-]+@[%w%.%-]+%.[%w]+"</span>
<span class="token comment">-- 然后多次使用这个 pattern</span>

<span class="token comment">-- 4. 使用 string.gmatch 代替多次 string.find</span>
<span class="token comment">-- 当需要找到所有匹配时</span>
<span class="token keyword">for</span> match <span class="token keyword">in</span> string<span class="token punctuation">.</span><span class="token function">gmatch</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> pattern<span class="token punctuation">)</span> <span class="token keyword">do</span>
    <span class="token comment">-- 处理每个匹配</span>
<span class="token keyword">end</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h3"><h3 data-heading="常见错误" dir="auto" class="heading" id="常见错误_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>常见错误</h3></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token comment">-- 错误 1：误用 string.len 和 #操作符</span>
<span class="token keyword">local</span> str <span class="token operator">=</span> <span class="token string">"你好"</span>
<span class="token function">print</span><span class="token punctuation">(</span> <span class="token operator">#</span>str <span class="token punctuation">)</span>               <span class="token comment">-- 2（正确）</span>
<span class="token function">print</span><span class="token punctuation">(</span>string<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment">-- 6（UTF-8 字节数）</span>

<span class="token comment">-- 错误 2：忘记字符串不可变</span>
<span class="token keyword">local</span> s <span class="token operator">=</span> <span class="token string">"Hello"</span>
s <span class="token operator">=</span> string<span class="token punctuation">.</span><span class="token function">gsub</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token string">"H"</span><span class="token punctuation">,</span> <span class="token string">"J"</span><span class="token punctuation">)</span>  <span class="token comment">-- 正确：创建新字符串并赋值</span>
<span class="token comment">-- string.gsub(s, "H", "J")   -- 错误：不会修改原字符串</span>

<span class="token comment">-- 错误 3：模式匹配中的贪婪匹配</span>
<span class="token keyword">local</span> text <span class="token operator">=</span> <span class="token string">"&lt;div&gt;content&lt;/div&gt;"</span>
<span class="token comment">-- 贪婪匹配</span>
<span class="token keyword">local</span> greedy <span class="token operator">=</span> string<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> <span class="token string">"&lt;.-&gt;"</span><span class="token punctuation">)</span>  <span class="token comment">-- 整个字符串</span>
<span class="token comment">-- 非贪婪匹配</span>
<span class="token keyword">local</span> non_greedy <span class="token operator">=</span> string<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> <span class="token string">"&lt;.- &gt;"</span><span class="token punctuation">)</span>  <span class="token comment">-- &lt;div&gt;</span>

<span class="token comment">-- 错误 4：转义特殊字符</span>
<span class="token keyword">local</span> pattern <span class="token operator">=</span> <span class="token string">"10.5"</span>  <span class="token comment">-- .在模式中匹配任意字符</span>
<span class="token keyword">local</span> text <span class="token operator">=</span> <span class="token string">"10x5"</span>
<span class="token function">print</span><span class="token punctuation">(</span>string<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> pattern<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">-- 会匹配！</span>
<span class="token comment">-- 应该转义</span>
pattern <span class="token operator">=</span> <span class="token string">"10\.5"</span>

<span class="token comment">-- 错误 5：忽略多行字符串的换行符</span>
<span class="token keyword">local</span> str <span class="token operator">=</span> <span class="token string">[[第一行
第二行]]</span>
<span class="token function">print</span><span class="token punctuation">(</span> <span class="token operator">#</span>str <span class="token punctuation">)</span>  <span class="token comment">-- 注意：包含换行符</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h3"><h3 data-heading="检查清单" dir="auto" class="heading" id="检查清单_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>检查清单</h3></div><div class="el-p"><p dir="auto">（点击勾选框勾选）<br>
完成本章后，你应该能够：</p></div><div class="el-ul"><ul class="contains-task-list has-list-bullet">
<li data-line="0" data-task="" class="task-list-item" dir="auto"><span class="list-bullet"></span><input data-line="0" type="checkbox" class="task-list-item-checkbox">理解字符串的不可变性及其影响</li>
<li data-line="1" data-task="" class="task-list-item" dir="auto"><span class="list-bullet"></span><input data-line="1" type="checkbox" class="task-list-item-checkbox">使用各种方式创建字符串</li>
<li data-line="2" data-task="" class="task-list-item" dir="auto"><span class="list-bullet"></span><input data-line="2" type="checkbox" class="task-list-item-checkbox">进行字符串的连接、重复和长度计算</li>
<li data-line="3" data-task="" class="task-list-item" dir="auto"><span class="list-bullet"></span><input data-line="3" type="checkbox" class="task-list-item-checkbox">查找、提取和分割字符串</li>
<li data-line="4" data-task="" class="task-list-item" dir="auto"><span class="list-bullet"></span><input data-line="4" type="checkbox" class="task-list-item-checkbox">使用 Lua 模式匹配进行复杂的字符串操作</li>
<li data-line="5" data-task="" class="task-list-item" dir="auto"><span class="list-bullet"></span><input data-line="5" type="checkbox" class="task-list-item-checkbox">进行字符串的替换和格式化</li>
<li data-line="6" data-task="" class="task-list-item" dir="auto"><span class="list-bullet"></span><input data-line="6" type="checkbox" class="task-list-item-checkbox">在字符串和数字之间进行转换</li>
<li data-line="7" data-task="" class="task-list-item" dir="auto"><span class="list-bullet"></span><input data-line="7" type="checkbox" class="task-list-item-checkbox">编写性能良好的字符串处理代码</li>
</ul></div><div class="el-h3"><h3 data-heading="思考题" dir="auto" class="heading" id="思考题_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>思考题</h3></div><div class="el-ol"><ol>
<li data-line="0" dir="auto">为什么 Lua 选择使用不可变字符串？这种设计有什么优缺点？</li>
<li data-line="1" dir="auto">Lua 的模式匹配和正则表达式有什么区别？各有什么适用场景？</li>
<li data-line="2" dir="auto">在处理大量文本数据时，如何优化字符串操作的性能？</li>
<li data-line="3" dir="auto">如何正确处理包含多字节字符（如中文、emoji）的字符串？</li>
<li data-line="4" dir="auto">在什么情况下应该使用 <code>string.gsub</code> 的函数替换功能？</li>
</ol></div><div class="el-h3"><h3 data-heading="拓展练习" dir="auto" class="heading" id="拓展练习_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>拓展练习</h3></div><div class="el-ol"><ol>
<li data-line="0" dir="auto">编写一个 JSON 解析器（简化版），将 JSON 字符串转换为 Lua 表</li>
<li data-line="1" dir="auto">开发一个数据验证库，验证各种格式的数据（邮箱、URL、日期等）</li>
</ol></div><div class="el-hr"><hr></div><div class="el-p"><p dir="auto"><strong>下一章预告</strong>：在第 9 章中，我们将学习模块和包。模块是组织和重用代码的重要方式，我们将学习如何创建模块、使用模块、管理依赖，以及了解 Lua 的标准库。</p></div><div class="el-p"><p dir="auto"><strong>学习建议</strong>：</p></div><div class="el-ol"><ol>
<li data-line="0" dir="auto">多练习模式匹配，这是 Lua 字符串处理的精华</li>
<li data-line="1" dir="auto">理解字符串不可变性的影响，编写性能良好的代码</li>
<li data-line="2" dir="auto">熟悉常用的字符串操作函数</li>
<li data-line="3" dir="auto">尝试用字符串处理解决实际问题，如文本分析、数据提取等</li>
<li data-line="4" dir="auto">注意处理多字节字符时的特殊考虑</li>
</ol></div><div class="footer"><div class="data-bar"></div></div></div></div></div><div id="right-content" class="leaf" style="--sidebar-width: var(--sidebar-width-right);"><div id="right-sidebar" class="sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><label class="theme-toggle-container" for="theme-toggle-input" id=""><input class="theme-toggle-input" type="checkbox" id="theme-toggle-input"><div class="toggle-background"></div></label></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content-wrapper"><div id="right-sidebar-content" class="leaf-content"><div id="outline" class=" tree-container"><div class="feature-header"><div class="feature-title">Table Of Contents</div><button class="clickable-icon nav-action-button tree-collapse-all" aria-label="Collapse All"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-item mod-collapsible" data-depth="1"><a class="tree-item-self is-clickable mod-collapsible" href="第-1-节-语法/8.-字符串.html#8._字符串_0" data-path="#8._字符串_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="8. 字符串">8. 字符串</div></a><div class="tree-item-children"><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-item-self is-clickable mod-collapsible" href="第-1-节-语法/8.-字符串.html#8.1_字符串基础_0" data-path="#8.1_字符串基础_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="8.1 字符串基础">8.1 字符串基础</div></a><div class="tree-item-children"><div class="tree-item mod-collapsible" data-depth="3"><a class="tree-item-self is-clickable mod-collapsible" href="第-1-节-语法/8.-字符串.html#8.1.1_字符串的创建_0" data-path="#8.1.1_字符串的创建_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="8.1.1 字符串的创建">8.1.1 字符串的创建</div></a><div class="tree-item-children"><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="第-1-节-语法/8.-字符串.html#转义符_0" data-path="#转义符_0"><div class="tree-item-inner heading-link" heading-name="转义符">转义符</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="第-1-节-语法/8.-字符串.html#8.1.2_字符串是不可变的_0" data-path="#8.1.2_字符串是不可变的_0"><div class="tree-item-inner heading-link" heading-name="8.1.2 字符串是不可变的">8.1.2 字符串是不可变的</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-item-self is-clickable mod-collapsible" href="第-1-节-语法/8.-字符串.html#8.2_字符串基本操作_0" data-path="#8.2_字符串基本操作_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="8.2 字符串基本操作">8.2 字符串基本操作</div></a><div class="tree-item-children"><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="第-1-节-语法/8.-字符串.html#8.2.1_#_-_字符串长度_0" data-path="#8.2.1_#_-_字符串长度_0"><div class="tree-item-inner heading-link" heading-name="8.2.1 # - 字符串长度">8.2.1 # - 字符串长度</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="第-1-节-语法/8.-字符串.html#8.2.2_.._/_table.concat_-_字符串连接_0" data-path="#8.2.2_.._/_table.concat_-_字符串连接_0"><div class="tree-item-inner heading-link" heading-name="8.2.2 .. / table.concat - 字符串连接">8.2.2 .. / table.concat - 字符串连接</div></a><div class="tree-item-children"></div></div><div class="tree-item mod-collapsible" data-depth="3"><a class="tree-item-self is-clickable mod-collapsible" href="第-1-节-语法/8.-字符串.html#8.2.3_string.rep_-_字符串重复_0" data-path="#8.2.3_string.rep_-_字符串重复_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="8.2.3 string.rep - 字符串重复">8.2.3 string.rep - 字符串重复</div></a><div class="tree-item-children"><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="第-1-节-语法/8.-字符串.html#示例_0" data-path="#示例_0"><div class="tree-item-inner heading-link" heading-name="示例">示例</div></a><div class="tree-item-children"></div></div></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-item-self is-clickable mod-collapsible" href="第-1-节-语法/8.-字符串.html#8.3_字符串查找和提取_0" data-path="#8.3_字符串查找和提取_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="8.3 字符串查找和提取">8.3 字符串查找和提取</div></a><div class="tree-item-children"><div class="tree-item mod-collapsible" data-depth="3"><a class="tree-item-self is-clickable mod-collapsible" href="第-1-节-语法/8.-字符串.html#8.3.1_string.find_-_字符串查找_0" data-path="#8.3.1_string.find_-_字符串查找_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="8.3.1 string.find - 字符串查找">8.3.1 string.find - 字符串查找</div></a><div class="tree-item-children"><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="第-1-节-语法/8.-字符串.html#示例_1" data-path="#示例_1"><div class="tree-item-inner heading-link" heading-name="示例">示例</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="3"><a class="tree-item-self is-clickable mod-collapsible" href="第-1-节-语法/8.-字符串.html#8.3.2_string.sub_-_字符串截取_0" data-path="#8.3.2_string.sub_-_字符串截取_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="8.3.2 string.sub - 字符串截取">8.3.2 string.sub - 字符串截取</div></a><div class="tree-item-children"><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="第-1-节-语法/8.-字符串.html#示例_2" data-path="#示例_2"><div class="tree-item-inner heading-link" heading-name="示例">示例</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="第-1-节-语法/8.-字符串.html#8.3.3_字符串分割_0" data-path="#8.3.3_字符串分割_0"><div class="tree-item-inner heading-link" heading-name="8.3.3 字符串分割">8.3.3 字符串分割</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-item-self is-clickable mod-collapsible" href="第-1-节-语法/8.-字符串.html#8.4_-_字符串模式匹配_0" data-path="#8.4_-_字符串模式匹配_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="8.4 - 字符串模式匹配">8.4 - 字符串模式匹配</div></a><div class="tree-item-children"><div class="tree-item mod-collapsible" data-depth="3"><a class="tree-item-self is-clickable mod-collapsible" href="第-1-节-语法/8.-字符串.html#8.4.1_string.match_-_匹配单个模式_0" data-path="#8.4.1_string.match_-_匹配单个模式_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="8.4.1 string.match - 匹配单个模式">8.4.1 string.match - 匹配单个模式</div></a><div class="tree-item-children"><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="第-1-节-语法/8.-字符串.html#示例_3" data-path="#示例_3"><div class="tree-item-inner heading-link" heading-name="示例">示例</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="3"><a class="tree-item-self is-clickable mod-collapsible" href="第-1-节-语法/8.-字符串.html#8.4.2_string.gmatch_-_匹配多个模式_0" data-path="#8.4.2_string.gmatch_-_匹配多个模式_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="8.4.2 string.gmatch - 匹配多个模式">8.4.2 string.gmatch - 匹配多个模式</div></a><div class="tree-item-children"><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="第-1-节-语法/8.-字符串.html#示例_4" data-path="#示例_4"><div class="tree-item-inner heading-link" heading-name="示例">示例</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="第-1-节-语法/8.-字符串.html#8.4.3_[]_-_字符类_0" data-path="#8.4.3_[]_-_字符类_0"><div class="tree-item-inner heading-link" heading-name="8.4.3 [] - 字符类">8.4.3 [] - 字符类</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="第-1-节-语法/8.-字符串.html#8.4.4_重复修饰符_0" data-path="#8.4.4_重复修饰符_0"><div class="tree-item-inner heading-link" heading-name="8.4.4 重复修饰符">8.4.4 重复修饰符</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="第-1-节-语法/8.-字符串.html#8.4.5_()_-_捕获和分组_0" data-path="#8.4.5_()_-_捕获和分组_0"><div class="tree-item-inner heading-link" heading-name="8.4.5 () - 捕获和分组">8.4.5 () - 捕获和分组</div></a><div class="tree-item-children"></div></div><div class="tree-item mod-collapsible" data-depth="3"><a class="tree-item-self is-clickable mod-collapsible" href="第-1-节-语法/8.-字符串.html#8.4.6_string.gsub_-_字符串替换_0" data-path="#8.4.6_string.gsub_-_字符串替换_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="8.4.6 string.gsub - 字符串替换">8.4.6 string.gsub - 字符串替换</div></a><div class="tree-item-children"><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="第-1-节-语法/8.-字符串.html#示例_5" data-path="#示例_5"><div class="tree-item-inner heading-link" heading-name="示例">示例</div></a><div class="tree-item-children"></div></div></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-item-self is-clickable mod-collapsible" href="第-1-节-语法/8.-字符串.html#8.5_string.format_-_字符串格式化_0" data-path="#8.5_string.format_-_字符串格式化_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="8.5 string.format - 字符串格式化">8.5 string.format - 字符串格式化</div></a><div class="tree-item-children"><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="第-1-节-语法/8.-字符串.html#示例_6" data-path="#示例_6"><div class="tree-item-inner heading-link" heading-name="示例">示例</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="第-1-节-语法/8.-字符串.html#数字字符串格式化_0" data-path="#数字字符串格式化_0"><div class="tree-item-inner heading-link" heading-name="数字字符串格式化">数字字符串格式化</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="第-1-节-语法/8.-字符串.html#字符串格式化_0" data-path="#字符串格式化_0"><div class="tree-item-inner heading-link" heading-name="字符串格式化">字符串格式化</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="第-1-节-语法/8.-字符串.html#示例_7" data-path="#示例_7"><div class="tree-item-inner heading-link" heading-name="示例">示例</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-item-self is-clickable mod-collapsible" href="第-1-节-语法/8.-字符串.html#8.6_字符串与数字转换_0" data-path="#8.6_字符串与数字转换_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="8.6 字符串与数字转换">8.6 字符串与数字转换</div></a><div class="tree-item-children"><div class="tree-item mod-collapsible" data-depth="3"><a class="tree-item-self is-clickable mod-collapsible" href="第-1-节-语法/8.-字符串.html#8.6.1_tostring_-_字符串转化_0" data-path="#8.6.1_tostring_-_字符串转化_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="8.6.1 tostring - 字符串转化">8.6.1 tostring - 字符串转化</div></a><div class="tree-item-children"><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="第-1-节-语法/8.-字符串.html#示例_8" data-path="#示例_8"><div class="tree-item-inner heading-link" heading-name="示例">示例</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="3"><a class="tree-item-self is-clickable mod-collapsible" href="第-1-节-语法/8.-字符串.html#8.6.2_tonumber_-_字符串转数字_0" data-path="#8.6.2_tonumber_-_字符串转数字_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="8.6.2 tonumber - 字符串转数字">8.6.2 tonumber - 字符串转数字</div></a><div class="tree-item-children"><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="第-1-节-语法/8.-字符串.html#示例_9" data-path="#示例_9"><div class="tree-item-inner heading-link" heading-name="示例">示例</div></a><div class="tree-item-children"></div></div></div></div></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="第-1-节-语法/8.-字符串.html#8.7_常见错误_0" data-path="#8.7_常见错误_0"><div class="tree-item-inner heading-link" heading-name="8.7 常见错误">8.7 常见错误</div></a><div class="tree-item-children"></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-item-self is-clickable mod-collapsible" href="第-1-节-语法/8.-字符串.html#8.8_练习_0" data-path="#8.8_练习_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="8.8 练习">8.8 练习</div></a><div class="tree-item-children"><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="第-1-节-语法/8.-字符串.html#练习_1：简单的文本分析器_0" data-path="#练习_1：简单的文本分析器_0"><div class="tree-item-inner heading-link" heading-name="练习 1：简单的文本分析器">练习 1：简单的文本分析器</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-item-self is-clickable mod-collapsible" href="第-1-节-语法/8.-字符串.html#8.9_本章总结_0" data-path="#8.9_本章总结_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="8.9 本章总结">8.9 本章总结</div></a><div class="tree-item-children"><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="第-1-节-语法/8.-字符串.html#关键知识点回顾_0" data-path="#关键知识点回顾_0"><div class="tree-item-inner heading-link" heading-name="关键知识点回顾">关键知识点回顾</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="第-1-节-语法/8.-字符串.html#性能优化技巧_0" data-path="#性能优化技巧_0"><div class="tree-item-inner heading-link" heading-name="性能优化技巧">性能优化技巧</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="第-1-节-语法/8.-字符串.html#常见错误_0" data-path="#常见错误_0"><div class="tree-item-inner heading-link" heading-name="常见错误">常见错误</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="第-1-节-语法/8.-字符串.html#检查清单_0" data-path="#检查清单_0"><div class="tree-item-inner heading-link" heading-name="检查清单">检查清单</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="第-1-节-语法/8.-字符串.html#思考题_0" data-path="#思考题_0"><div class="tree-item-inner heading-link" heading-name="思考题">思考题</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="第-1-节-语法/8.-字符串.html#拓展练习_0" data-path="#拓展练习_0"><div class="tree-item-inner heading-link" heading-name="拓展练习">拓展练习</div></a><div class="tree-item-children"></div></div></div></div></div></div></div></div></div><script defer="">let rs = document.querySelector("#right-sidebar"); rs.classList.toggle("is-collapsed", window.innerWidth < 768); rs.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-right-width"));</script></div></div></div></div></body></html>