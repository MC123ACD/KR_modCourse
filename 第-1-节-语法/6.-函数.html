<!DOCTYPE html> <html lang="zh-cn"><head>
<title>6. 函数</title>
<base href="..">
<meta name="pathname" content="第-1-节-语法/6.-函数.html">
<meta name="description" content="王国保卫战修改教程 - 6. 函数">
<meta property="og:title" content="6. 函数">
<meta property="og:description" content="王国保卫战修改教程 - 6. 函数">
<meta property="og:type" content="website">
<meta property="og:url" content="第-1-节-语法/6.-函数.html">
<meta property="og:image" content="site-lib/media/pasted-image-20251208134125.png">
<meta charset="UTF-8"><meta property="og:site_name" content="王国保卫战修改教程"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0"><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="site-lib/rss.xml"><script async="" id="webpage-script" src="site-lib/scripts/webpage.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><link rel="icon" href="site-lib/media/favicon.png"><link rel="preload" href="site-lib/styles/snippets.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/snippets.css"></noscript><link rel="stylesheet" href="site-lib/styles/obsidian.css"><link rel="preload" href="site-lib/styles/other-plugins.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/other-plugins.css"></noscript><link rel="stylesheet" href="site-lib/styles/theme.css"><link rel="preload" href="site-lib/styles/global-variable-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/global-variable-styles.css"></noscript><link rel="preload" href="site-lib/styles/supported-plugins.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/supported-plugins.css"></noscript><link rel="preload" href="site-lib/styles/main-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/main-styles.css"></noscript><style>body{--line-width:40em;--line-width-adaptive:40em;--file-line-width:40em;--sidebar-width:min(20em, 80vw);--collapse-arrow-size:11px;--tree-vertical-spacing:1.3em;--sidebar-margin:12px}:root{background-color:#202124}.sidebar{height:100%;font-size:14px;z-index:10;min-width:calc(var(--sidebar-width) + var(--divider-width-hover));max-width:calc(var(--sidebar-width) + var(--divider-width-hover));position:relative;overflow:hidden;overflow:clip;transition:min-width ease-in-out,max-width ease-in-out;transition-duration:.2s;contain:size}#left-sidebar{left:0}#right-sidebar{right:0}.sidebar.is-collapsed{min-width:0;max-width:0}.sidebar.floating{position:absolute}.sidebar .leaf-content{height:100%;min-width:calc(var(--sidebar-width) - var(--divider-width-hover));top:0;padding:var(--sidebar-margin);padding-top:4em;line-height:var(--line-height-tight);background-color:var(--background-secondary);transition:background-color,border-right,border-left,box-shadow;transition-duration:var(--color-fade-speed);transition-timing-function:ease-in-out;position:absolute;display:flex;flex-direction:column}.sidebar:not(.is-collapsed) .leaf-content{min-width:calc(max(100%,var(--sidebar-width)) - 3px);max-width:calc(max(100%,var(--sidebar-width)) - 3px)}#left-sidebar-content{left:0;border-top-right-radius:var(--radius-l);border-bottom-right-radius:var(--radius-l)}#right-sidebar-content{right:0;border-top-left-radius:var(--radius-l);border-bottom-left-radius:var(--radius-l)}.sidebar #left-sidebar-content,.sidebar #right-sidebar-content{contain:none!important;container-type:normal!important;animation:none!important}.sidebar:has(.leaf-content:empty):has(.topbar-content:empty){display:none}.sidebar-topbar{height:calc(2.3em + 2 * var(--sidebar-margin));width:var(--sidebar-width);padding:var(--sidebar-margin);z-index:1;position:fixed;display:flex;align-items:center;transition:width ease-in-out;transition-duration:inherit}.sidebar.is-collapsed .sidebar-topbar{width:calc(2.3em + var(--sidebar-margin) * 2)}.sidebar .sidebar-topbar.is-collapsed{width:0}#left-sidebar .sidebar-topbar{left:0;flex-direction:row;border-top-right-radius:var(--radius-l)}#right-sidebar .sidebar-topbar{right:0;flex-direction:row-reverse;border-top-left-radius:var(--radius-l)}#left-sidebar .topbar-content{margin-right:calc(2.3em + var(--sidebar-margin));flex-direction:row}#right-sidebar .topbar-content{margin-left:calc(2.3em + var(--sidebar-margin));flex-direction:row-reverse}.topbar-content{overflow:hidden visible;overflow:clip visible;width:100%;height:100%;display:flex;align-items:center;transition:inherit}.sidebar.is-collapsed .topbar-content{width:0;transition:inherit}.clickable-icon.sidebar-collapse-icon{background-color:transparent;color:var(--icon-color-focused);padding:2px!important;margin:0!important;height:100%!important;width:2.3em!important;margin-inline:0.14em!important;position:absolute}#left-sidebar .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);right:var(--sidebar-margin)}#right-sidebar .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);left:var(--sidebar-margin)}.clickable-icon.sidebar-collapse-icon svg.svg-icon{width:100%;height:100%}.feature-title{margin-left:1px;text-transform:uppercase;letter-spacing:.06em;margin-top:.75em;margin-bottom:.75em}.feature-header{display:flex;align-items:center;padding-top:0;font-size:1em;padding-left:0}body.floating-sidebars .sidebar{position:absolute}body{transition:background-color var(--color-fade-speed) ease-in-out}#navbar:not(:empty){display:flex;align-items:center;justify-content:space-between;padding:.5em 1em;width:100%}#main{display:flex;flex-direction:column;height:100%;width:100%;align-items:stretch;justify-content:center}#main-horizontal{display:flex;flex-direction:row;flex-grow:1;width:100%;align-items:stretch;justify-content:center}#center-content{flex-basis:100%;max-width:100%;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;transition:opacity .2s ease-in-out;contain:inline-size}.hide{opacity:0!important;transition:opacity .2s ease-in-out;pointer-events:none}#center-content>.obsidian-document{padding-left:2em;padding-right:1em;margin-bottom:0;width:100%;width:-webkit-fill-available;width:-moz-available;width:fill-available;transition:background-color var(--color-fade-speed) ease-in-out;border-top-right-radius:var(--window-radius,var(--radius-m));border-top-left-radius:var(--window-radius,var(--radius-m));overflow-x:hidden!important;overflow-y:auto!important;display:flex!important;flex-direction:column!important;align-items:center!important;contain:inline-size}body #center-content>.obsidian-document>.markdown-preview-sizer{padding-bottom:80vh;width:100%;max-width:var(--line-width);flex-basis:var(--line-width);transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}#center-content>.obsidian-document>div{width:100%!important;transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}#center-content>.obsidian-document:not([data-type=markdown]).embed{display:flex;padding:1em;height:100%;width:100%;align-items:center;justify-content:center}#center-content>.obsidian-document:not([data-type=markdown]).embed>*{max-width:100%;max-height:100%;object-fit:contain}:not(h1,h2,h3,h4,h5,h6,li):has(> :is(.math,table)){overflow-x:auto!important}#center-content>.obsidian-document:not([data-type=markdown]){overflow-x:auto;contain:content;padding:0;margin:0;height:100%}.obsidian-document[data-type=attachment]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;width:100%}.obsidian-document[data-type=attachment]>*{outline:0;border:none;box-shadow:none}.obsidian-document[data-type=attachment] :is(img){max-width:90%;max-height:90%;object-fit:contain}.obsidian-document[data-type=attachment]>:is(audio){width:100%;max-width:min(90%,var(--line-width))}.obsidian-document[data-type=attachment]>:is(embed,iframe,video){width:100%;height:100%;max-width:100%;max-height:100%;object-fit:contain}.canvas-wrapper>:is(.header,.footer){z-index:100;position:absolute;display:flex;justify-content:center;flex-direction:column;width:100%;align-items:center}.scroll-highlight{position:absolute;width:100%;height:100%;pointer-events:none;z-index:1000;background-color:hsla(var(--color-accent-hsl),.25);opacity:0;padding:1em;inset:50%;translate:-50% -50%;border-radius:var(--radius-s)}</style><script defer="">async function loadIncludes(){let e=document.querySelectorAll("link[itemprop='include']");for(const t of e){let e=t.getAttribute("href");try{let o="";if(e.startsWith("https:")||e.startsWith("http:")||"file:"!=window.location.protocol){const n=await fetch(e);if(!n.ok){console.log("Could not include file: "+e),t?.remove();continue}o=await n.text()}else{const t=document.getElementById(btoa(encodeURI(e)));if(t){const e=JSON.parse(decodeURI(atob(t.getAttribute("value")??"")));o=e?.data??""}}let n=document.createRange().createContextualFragment(o);t.before(n),t.remove(),console.log("Included text: "+o),console.log("Included file: "+e)}catch(o){t?.remove(),console.log("Could not include file: "+e,o);continue}}}document.addEventListener("DOMContentLoaded",(()=>{loadIncludes()}));let isFileProtocol="file:"==location.protocol;function waitLoadScripts(e,t){let o=e.map((e=>document.getElementById(e+"-script")));!function e(n){let l=o[n],c=n+1;l?(l&&"true"!=l.getAttribute("loaded")||n<o.length&&e(c),n<o.length&&l.addEventListener("load",(()=>e(c)))):n<o.length?e(c):t()}(0)}</script></head><body class="publish css-settings-manager mod-windows is-frameless is-hidden-frameless styled-scrollbars show-inline-title show-ribbon background-settings-workplace-theme-dark-in-the-sky background-image-settings-markdown-page-custom notebook-liked-markdown-page-grid-notebook-1 panel-page-bg-theme-light-custom panel-page-bg-theme-dark-plant hide-left-ribbon-retention-drawer toggle-divider-lines toggle-header-bottom-line bt-bubble-layout bt-bubble-layout-hide-borders remove-heading-indicator h1-toggle-underline toggle-left-aligned-content fancy-hr-no-icon custom-unordered-list custom-ordered-list list-no-border folder-icons bt-toggle-colorful-folder folder-style-change-options-colorful-default folder-colorful-one table-width-auto table-style-two link-underline-internal enable-alternative-checkboxes default-loading-page loading-text-typing-style rainbow-tag translucent-setting-panel underline-tab-style canvas-card-text-middle admonition-bg-color-same toggle-calendar-shadow style-options-for-buttons-plugin dataview-list-style-pacman memos-banner-gradient thino-frosted-style thino-background-default quiet-outline-optimize code-theme-sublime is-focused"><script defer="">let theme=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");"dark"==theme?(document.body.classList.add("theme-dark"),document.body.classList.remove("theme-light")):(document.body.classList.add("theme-light"),document.body.classList.remove("theme-dark")),window.innerWidth<480?document.body.classList.add("is-phone"):window.innerWidth<768?document.body.classList.add("is-tablet"):window.innerWidth<1024?document.body.classList.add("is-small-screen"):document.body.classList.add("is-large-screen")</script><div class="parsed-feature-container" style="display: contents;"><link itemprop="include" href="site-lib/html/custom-head-content-content.html"></div><div id="main"><div id="navbar"></div><div id="main-horizontal"><div id="left-content" class="leaf" style="--sidebar-width: var(--sidebar-width-left);"><div id="left-sidebar" class="sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><div id="search-container"><div id="search-wrapper"><input enterkeyhint="search" type="search" spellcheck="false" placeholder="Search..."><div aria-label="Clear search" id="search-clear-button"></div></div></div></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content-wrapper"><div id="left-sidebar-content" class="leaf-content"><link itemprop="include" href="site-lib/html/file-tree-content.html"></div></div><script defer="">let ls = document.querySelector("#left-sidebar"); ls.classList.toggle("is-collapsed", window.innerWidth < 768); ls.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-left-width"));</script></div></div><div id="center-content" class="leaf"><div class="obsidian-document markdown-preview-view markdown-rendered node-insert-event allow-fold-headings show-indentation-guide show-properties is-readable-line-width" data-type="markdown"><style id="MJX-CHTML-styles"></style><div class="markdown-preview-sizer markdown-preview-section"><div class="header"><h1 class="page-title heading inline-title" id="6._函数_0">6. 函数</h1><div class="data-bar"></div></div><div class="markdown-preview-pusher" style="width: 1px; height: 0.1px; margin-bottom: 0px;"></div><div class="el-h2"><h2 data-heading="6.1 函数的基本概念" dir="auto" class="heading" id="6.1_函数的基本概念_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>6.1 函数的基本概念</h2></div><div class="el-p"><p dir="auto">函数是组织和重用代码的基本单元。它让我们可以将一段具有特定功能的代码封装起来，通过名称调用执行。</p></div><div class="el-h4"><h4 data-heading="为什么要使用函数？" dir="auto" class="heading" id="为什么要使用函数？_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>为什么要使用函数？</h4></div><div class="el-p"><p dir="auto">在开始学习函数语法之前，先看看不使用函数时的问题：</p></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token comment">-- 不使用函数的重复代码</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"=== 玩家1 ==="</span><span class="token punctuation">)</span>
<span class="token keyword">local</span> player1_name <span class="token operator">=</span> <span class="token string">"小明"</span>
<span class="token keyword">local</span> player1_level <span class="token operator">=</span> <span class="token number">10</span>
<span class="token keyword">local</span> player1_health <span class="token operator">=</span> <span class="token number">100</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"姓名："</span> <span class="token operator">..</span> player1_name<span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"等级："</span> <span class="token operator">..</span> player1_level<span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"生命值："</span> <span class="token operator">..</span> player1_health<span class="token punctuation">)</span>

<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"=== 玩家2 ==="</span><span class="token punctuation">)</span>
<span class="token keyword">local</span> player2_name <span class="token operator">=</span> <span class="token string">"小红"</span>
<span class="token keyword">local</span> player2_level <span class="token operator">=</span> <span class="token number">8</span>
<span class="token keyword">local</span> player2_health <span class="token operator">=</span> <span class="token number">80</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"姓名："</span> <span class="token operator">..</span> player2_name<span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"等级："</span> <span class="token operator">..</span> player2_level<span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"生命值："</span> <span class="token operator">..</span> player2_health<span class="token punctuation">)</span>

<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"=== 玩家3 ==="</span><span class="token punctuation">)</span>
<span class="token keyword">local</span> player3_name <span class="token operator">=</span> <span class="token string">"小刚"</span>
<span class="token keyword">local</span> player3_level <span class="token operator">=</span> <span class="token number">12</span>
<span class="token keyword">local</span> player3_health <span class="token operator">=</span> <span class="token number">120</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"姓名："</span> <span class="token operator">..</span> player3_name<span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"等级："</span> <span class="token operator">..</span> player3_level<span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"生命值："</span> <span class="token operator">..</span> player3_health<span class="token punctuation">)</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">上面的代码有很多重复模式。函数可以解决这个问题！</p></div><div class="el-h2"><h2 data-heading="6.2 函数的定义与调用" dir="auto" class="heading" id="6.2_函数的定义与调用_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>6.2 函数的定义与调用</h2></div><div class="el-h3"><h3 data-heading="6.2.1 函数定义的基本语法" dir="auto" class="heading" id="6.2.1_函数定义的基本语法_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>6.2.1 函数定义的基本语法</h3></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token comment">-- 使用function关键字定义的全局</span>
<span class="token keyword">local</span> <span class="token keyword">function</span> 函数名<span class="token punctuation">(</span>参数<span class="token punctuation">:</span> any<span class="token punctuation">...</span><span class="token punctuation">)</span>
    <span class="token comment">-- 函数体</span>
    <span class="token comment">-- 可以包含多条语句</span>
    <span class="token keyword">return</span> 返回值  <span class="token comment">-- 可选</span>
<span class="token keyword">end</span>

<span class="token comment">-- 以上语法等价于此</span>
<span class="token keyword">local</span> 函数名 <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>参数<span class="token punctuation">:</span> any<span class="token punctuation">...</span><span class="token punctuation">)</span>
    <span class="token comment">-- 函数体</span>
    <span class="token keyword">return</span> 返回值
<span class="token keyword">end</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h4"><h4 data-heading="示例" dir="auto" class="heading" id="示例_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>示例</h4></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token comment">-- 示例1：简单的问候函数</span>
<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">greet</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"你好！欢迎来到Lua世界！"</span><span class="token punctuation">)</span>
<span class="token keyword">end</span>

<span class="token comment">-- 调用函数</span>
<span class="token function">greet</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">-- 输出：你好！欢迎来到Lua世界！</span>
<span class="token function">greet</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">-- 可以多次调用</span>
<span class="token function">greet</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">-- 示例2：带参数的函数</span>
<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">greet_person</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"你好，"</span> <span class="token operator">..</span> name <span class="token operator">..</span> <span class="token string">"！"</span><span class="token punctuation">)</span>
<span class="token keyword">end</span>

<span class="token comment">-- 调用带参数的函数</span>
<span class="token function">greet_person</span><span class="token punctuation">(</span><span class="token string">"小明"</span><span class="token punctuation">)</span>   <span class="token comment">-- 输出：你好，小明！</span>
<span class="token function">greet_person</span><span class="token punctuation">(</span><span class="token string">"小红"</span><span class="token punctuation">)</span>   <span class="token comment">-- 输出：你好，小红！</span>
<span class="token function">greet_person</span><span class="token punctuation">(</span><span class="token string">"老师"</span><span class="token punctuation">)</span>   <span class="token comment">-- 输出：你好，老师！</span>

<span class="token comment">-- 示例3：使用函数表达式</span>
<span class="token keyword">local</span> calculate_area <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>width<span class="token punctuation">,</span> height<span class="token punctuation">)</span>
    <span class="token keyword">local</span> area <span class="token operator">=</span> width <span class="token operator">*</span> height
    <span class="token keyword">return</span> area
<span class="token keyword">end</span>

<span class="token comment">-- 调用函数表达式</span>
<span class="token keyword">local</span> result <span class="token operator">=</span> <span class="token function">calculate_area</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"面积为："</span> <span class="token operator">..</span> result<span class="token punctuation">)</span>  <span class="token comment">-- 输出：面积为：15</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h3"><h3 data-heading="6.2.2 改进的玩家信息显示程序" dir="auto" class="heading" id="6.2.2_改进的玩家信息显示程序_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>6.2.2 改进的玩家信息显示程序</h3></div><div class="el-p"><p dir="auto">现在用函数重构之前的重复代码：</p></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token comment">-- 定义显示玩家信息的函数</span>
<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">show_player_info</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> level<span class="token punctuation">,</span> health<span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"=== "</span> <span class="token operator">..</span> name <span class="token operator">..</span> <span class="token string">" ==="</span><span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"姓名："</span> <span class="token operator">..</span> name<span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"等级："</span> <span class="token operator">..</span> level<span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"生命值："</span> <span class="token operator">..</span> health<span class="token punctuation">)</span>
<span class="token keyword">end</span>

<span class="token comment">-- 使用函数，使代码变得更简洁</span>
<span class="token function">show_player_info</span><span class="token punctuation">(</span><span class="token string">"小明"</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>
<span class="token function">show_player_info</span><span class="token punctuation">(</span><span class="token string">"小红"</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span>
<span class="token function">show_player_info</span><span class="token punctuation">(</span><span class="token string">"小刚"</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">)</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h2"><h2 data-heading="6.3 参数传递" dir="auto" class="heading" id="6.3_参数传递_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>6.3 参数传递</h2></div><div class="el-h3"><h3 data-heading="6.3.1 基本参数传递" dir="auto" class="heading" id="6.3.1_基本参数传递_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>6.3.1 基本参数传递</h3></div><div class="el-h4"><h4 data-heading="单个参数" dir="auto" class="heading" id="单个参数_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>单个参数</h4></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">double_number</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    <span class="token keyword">return</span> x <span class="token operator">*</span> <span class="token number">2</span>
<span class="token keyword">end</span>

<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"5的两倍是："</span> <span class="token operator">..</span> <span class="token function">double_number</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">-- 输出：10</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h4"><h4 data-heading="多个参数" dir="auto" class="heading" id="多个参数_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>多个参数</h4></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">calculate_rectangle</span><span class="token punctuation">(</span>width<span class="token punctuation">,</span> height<span class="token punctuation">)</span>
    <span class="token keyword">local</span> area <span class="token operator">=</span> width <span class="token operator">*</span> height
    <span class="token keyword">local</span> perimeter <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token punctuation">(</span>width <span class="token operator">+</span> height<span class="token punctuation">)</span>
    <span class="token keyword">return</span> area<span class="token punctuation">,</span> perimeter
<span class="token keyword">end</span>

<span class="token comment">-- 接收多个返回值</span>
<span class="token keyword">local</span> area<span class="token punctuation">,</span> perimeter <span class="token operator">=</span> <span class="token function">calculate_rectangle</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"长方形：面积="</span> <span class="token operator">..</span> area <span class="token operator">..</span> <span class="token string">", 周长="</span> <span class="token operator">..</span> perimeter<span class="token punctuation">)</span>  <span class="token comment">-- 面积=12, 周长=14</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h4"><h4 data-heading="示例" dir="auto" class="heading" id="示例_1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>示例</h4></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token comment">-- 实际游戏示例：计算伤害</span>
<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">calculate_damage</span><span class="token punctuation">(</span>attack<span class="token punctuation">,</span> defense<span class="token punctuation">,</span> multiplier<span class="token punctuation">)</span>
    <span class="token keyword">local</span> damage <span class="token operator">=</span> attack <span class="token operator">-</span> defense
    
    <span class="token keyword">if</span> damage <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token keyword">then</span>
        damage <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">end</span>
    
    damage <span class="token operator">=</span> damage <span class="token operator">*</span> <span class="token punctuation">(</span>multiplier <span class="token keyword">or</span> <span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment">-- multiplier可选，默认为1</span>
    <span class="token keyword">return</span> damage
<span class="token keyword">end</span>

<span class="token comment">-- 测试伤害计算</span>
<span class="token keyword">local</span> damage1 <span class="token operator">=</span> <span class="token function">calculate_damage</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">1.5</span><span class="token punctuation">)</span>  <span class="token comment">-- 攻击50，防御30，倍率1.5</span>
<span class="token keyword">local</span> damage2 <span class="token operator">=</span> <span class="token function">calculate_damage</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">)</span>  <span class="token comment">-- 攻击40，防御45</span>
<span class="token keyword">local</span> damage3 <span class="token operator">=</span> <span class="token function">calculate_damage</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>      <span class="token comment">-- multiplier未提供，使用默认值1</span>

<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"伤害1："</span> <span class="token operator">..</span> damage1<span class="token punctuation">)</span>  <span class="token comment">-- 输出：30 ((50-30)*1.5)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"伤害2："</span> <span class="token operator">..</span> damage2<span class="token punctuation">)</span>  <span class="token comment">-- 输出：0 ((40-45)为负，设为0)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"伤害3："</span> <span class="token operator">..</span> damage3<span class="token punctuation">)</span>  <span class="token comment">-- 输出：80</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h3"><h3 data-heading="6.3.2 参数传递的特性" dir="auto" class="heading" id="6.3.2_参数传递的特性_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>6.3.2 参数传递的特性</h3></div><div class="el-h4"><h4 data-heading="引用传递" dir="auto" class="heading" id="引用传递_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>引用传递</h4></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token comment">-- 对于表类型，参数传递的是引用（表的内容可以被修改）</span>
<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">modify_table</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span>
    t<span class="token punctuation">.</span>x <span class="token operator">=</span> t<span class="token punctuation">.</span>x <span class="token operator">*</span> <span class="token number">2</span>  <span class="token comment">-- 修改表的内容</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"函数内 t.x = "</span> <span class="token operator">..</span> t<span class="token punctuation">.</span>x<span class="token punctuation">)</span>
<span class="token keyword">end</span>

<span class="token keyword">local</span> my_table <span class="token operator">=</span> <span class="token punctuation">{</span>x <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">}</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"调用前 my_table.x = "</span> <span class="token operator">..</span> my_table<span class="token punctuation">.</span>x<span class="token punctuation">)</span>	<span class="token comment">-- 10</span>

<span class="token function">modify_table</span><span class="token punctuation">(</span>my_table<span class="token punctuation">)</span>		<span class="token comment">-- 函数内 t.x = 20</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"调用后 my_table.x = "</span> <span class="token operator">..</span> my_table<span class="token punctuation">.</span>x<span class="token punctuation">)</span>	<span class="token comment">-- 20（改变了！）</span>

<span class="token comment">-- 注意：表本身不会被替换</span>
<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">replace_table</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span>
    t <span class="token operator">=</span> <span class="token punctuation">{</span>x <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">}</span>  <span class="token comment">-- 这不会影响原始表，只是让 t 指向了 {x = 100, y = 200} 这个表</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"函数内 t.x = "</span> <span class="token operator">..</span> t<span class="token punctuation">.</span>x<span class="token punctuation">)</span>
<span class="token keyword">end</span>

<span class="token keyword">local</span> original_table <span class="token operator">=</span> <span class="token punctuation">{</span>x <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">}</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"调用前 original_table.x = "</span> <span class="token operator">..</span> original_table<span class="token punctuation">.</span>x<span class="token punctuation">)</span>	<span class="token comment">-- 10</span>

<span class="token function">replace_table</span><span class="token punctuation">(</span>original_table<span class="token punctuation">)</span>		<span class="token comment">-- 函数内 t.x = 100</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"调用后 original_table.x = "</span> <span class="token operator">..</span> original_table<span class="token punctuation">.</span>x<span class="token punctuation">)</span>	<span class="token comment">-- 10（没有改变！）</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">这个 <code>t</code> 变量可以理解为箭头（指针）指向表这个“盒子”，给指针 <code>t</code> 赋值，只是让指针指向了另一个表，通过 <code>t.x</code> 访问则是先通过指针找到指向的表然后修改里面的 <code>x</code> 键。</p></div><div class="el-p"><p dir="auto"><strong>示意图</strong>：<br>
<span alt="Pasted image 20251208134125.png" src="site-lib/media/pasted-image-20251208134125.png" class="internal-embed media-embed image-embed is-loaded" target="_self" style="width: 600px; max-width: 100%;"><img alt="Pasted image 20251208134125.png" src="site-lib/media/pasted-image-20251208134125.png" target="_self" style="width: 600px; max-width: 100%;"></span></p></div><div class="el-h4"><h4 data-heading="值传递" dir="auto" class="heading" id="值传递_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>值传递</h4></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token comment">-- 数字等值，传递的是 "值"</span>
<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">modify_value</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    x <span class="token operator">=</span> x <span class="token operator">*</span> <span class="token number">2</span>  <span class="token comment">-- 修改的是副本，不影响原始值</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"函数内 x = "</span> <span class="token operator">..</span> x<span class="token punctuation">)</span>
<span class="token keyword">end</span>

<span class="token keyword">local</span> num <span class="token operator">=</span> <span class="token number">10</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"调用前 num = "</span> <span class="token operator">..</span> num<span class="token punctuation">)</span>	<span class="token comment">-- 10</span>

<span class="token function">modify_value</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span>		<span class="token comment">-- 函数内 x = 20</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"调用后 num = "</span> <span class="token operator">..</span> num<span class="token punctuation">)</span>	<span class="token comment">-- 10（没有改变！）</span>

<span class="token comment">--[[ 这些类型（值类型）都是直接传递值的副本：
	local a = 10      -- 数字
	local b = true    -- 布尔
	local c = nil     -- nil
--]]</span> 
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h3"><h3 data-heading="6.3.3 变长参数（可变参数）" dir="auto" class="heading" id="6.3.3_变长参数（可变参数）_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>6.3.3 变长参数（可变参数）</h3></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token comment">-- 使用 ... 接收可变数量的参数</span>
<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token punctuation">...</span><span class="token punctuation">)</span>
    <span class="token keyword">local</span> numbers <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token punctuation">}</span>  <span class="token comment">-- 将参数收集到表中</span>
    <span class="token keyword">local</span> total <span class="token operator">=</span> <span class="token number">0</span>
    
    <span class="token keyword">for</span> i<span class="token punctuation">,</span> num <span class="token keyword">in</span> <span class="token function">ipairs</span><span class="token punctuation">(</span>numbers<span class="token punctuation">)</span> <span class="token keyword">do</span>
        total <span class="token operator">=</span> total <span class="token operator">+</span> num
    <span class="token keyword">end</span>
    
    <span class="token keyword">return</span> total
<span class="token keyword">end</span>

<span class="token comment">-- 测试变长参数函数</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"1+2 = "</span> <span class="token operator">..</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                    <span class="token comment">-- 3</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"1+2+3 = "</span> <span class="token operator">..</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>              <span class="token comment">-- 6</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"1+2+3+4+5 = "</span> <span class="token operator">..</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment">-- 15</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"空参数 = "</span> <span class="token operator">..</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                     <span class="token comment">-- 0</span>

<span class="token comment">-- 混合固定参数和可变参数</span>
<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">format_string</span><span class="token punctuation">(</span>separator<span class="token punctuation">,</span> <span class="token punctuation">...</span><span class="token punctuation">)</span>
    <span class="token keyword">local</span> parts <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token punctuation">}</span>
    <span class="token keyword">local</span> result <span class="token operator">=</span> <span class="token string">""</span>
    
    <span class="token keyword">for</span> i<span class="token punctuation">,</span> part <span class="token keyword">in</span> <span class="token function">ipairs</span><span class="token punctuation">(</span>parts<span class="token punctuation">)</span> <span class="token keyword">do</span>
        <span class="token keyword">if</span> i <span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token keyword">then</span>
            result <span class="token operator">=</span> result <span class="token operator">..</span> separator
        <span class="token keyword">end</span>
        result <span class="token operator">=</span> result <span class="token operator">..</span> <span class="token function">tostring</span><span class="token punctuation">(</span>part<span class="token punctuation">)</span>
    <span class="token keyword">end</span>
    
    <span class="token keyword">return</span> result
<span class="token keyword">end</span>

<span class="token comment">-- 测试格式化函数</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">format_string</span><span class="token punctuation">(</span><span class="token string">", "</span><span class="token punctuation">,</span> <span class="token string">"苹果"</span><span class="token punctuation">,</span> <span class="token string">"香蕉"</span><span class="token punctuation">,</span> <span class="token string">"橙子"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment">-- 苹果, 香蕉, 橙子</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">format_string</span><span class="token punctuation">(</span><span class="token string">" - "</span><span class="token punctuation">,</span> <span class="token string">"A"</span><span class="token punctuation">,</span> <span class="token string">"B"</span><span class="token punctuation">,</span> <span class="token string">"C"</span><span class="token punctuation">,</span> <span class="token string">"D"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>      <span class="token comment">-- A - B - C - D</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">format_string</span><span class="token punctuation">(</span><span class="token string">" and "</span><span class="token punctuation">,</span> <span class="token string">"猫"</span><span class="token punctuation">,</span> <span class="token string">"狗"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>             <span class="token comment">-- 猫 and 狗</span>

<span class="token comment">-- 实际应用：计算平均值</span>
<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">average</span><span class="token punctuation">(</span><span class="token punctuation">...</span><span class="token punctuation">)</span>
    <span class="token keyword">local</span> numbers <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token punctuation">}</span>
    <span class="token keyword">local</span> count <span class="token operator">=</span> <span class="token operator">#</span>numbers
    
    <span class="token keyword">if</span> count <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">then</span>
        <span class="token keyword">return</span> <span class="token number">0</span>
    <span class="token keyword">end</span>
    
    <span class="token keyword">local</span> total <span class="token operator">=</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token punctuation">...</span><span class="token punctuation">)</span>  <span class="token comment">-- 重用之前的sum函数</span>
    <span class="token keyword">return</span> total <span class="token operator">/</span> count
<span class="token keyword">end</span>

<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"平均值1："</span> <span class="token operator">..</span> <span class="token function">average</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token comment">-- 20</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"平均值2："</span> <span class="token operator">..</span> <span class="token function">average</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>     <span class="token comment">-- 3</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"平均值3："</span> <span class="token operator">..</span> <span class="token function">average</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span>               <span class="token comment">-- 100</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h2"><h2 data-heading="6.4 返回值" dir="auto" class="heading" id="6.4_返回值_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>6.4 返回值</h2></div><div class="el-h3"><h3 data-heading="6.4.1 单返回值" dir="auto" class="heading" id="6.4.1_单返回值_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>6.4.1 单返回值</h3></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token comment">-- 返回单个值</span>
<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">is_even</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span>
    <span class="token keyword">if</span> number <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">then</span>
        <span class="token keyword">return</span> <span class="token keyword">true</span>
    <span class="token keyword">else</span>
        <span class="token keyword">return</span> <span class="token keyword">false</span>
    <span class="token keyword">end</span>
<span class="token keyword">end</span>

<span class="token comment">-- 调用单返回值函数</span>
<span class="token keyword">local</span> result <span class="token operator">=</span> <span class="token function">is_even</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"10是偶数吗？"</span> <span class="token operator">..</span> <span class="token function">tostring</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">-- true</span>

<span class="token comment">-- 更简洁的写法</span>
<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">is_odd</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span>
    <span class="token keyword">return</span> number <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">1</span>
<span class="token keyword">end</span>

<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"7是奇数吗？"</span> <span class="token operator">..</span> <span class="token function">tostring</span><span class="token punctuation">(</span><span class="token function">is_odd</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">-- true</span>

<span class="token comment">-- 注意：返回值后面的代码不会被执行</span>
<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">is_odd</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span>
    <span class="token keyword">return</span> number <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">1</span>
    
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"这里不会被执行"</span><span class="token punctuation">)</span>
<span class="token keyword">end</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h4"><h4 data-heading="示例" dir="auto" class="heading" id="示例_2"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>示例</h4></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token comment">-- 实际游戏示例：计算等级所需经验</span>
<span class="token keyword">function</span> <span class="token function">get_exp_for_level</span><span class="token punctuation">(</span>level<span class="token punctuation">)</span>
    <span class="token comment">-- 假设每级所需经验是 level * 100</span>
    <span class="token keyword">return</span> level <span class="token operator">*</span> <span class="token number">100</span>
<span class="token keyword">end</span>

<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"升到10级需要经验："</span> <span class="token operator">..</span> <span class="token function">get_exp_for_level</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">-- 1000</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h3"><h3 data-heading="6.4.2 多返回值" dir="auto" class="heading" id="6.4.2_多返回值_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>6.4.2 多返回值</h3></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token comment">-- 返回多个值</span>
<span class="token keyword">function</span> <span class="token function">min_max</span><span class="token punctuation">(</span>numbers<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token operator">#</span>numbers <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">then</span>
        <span class="token keyword">return</span> <span class="token keyword">nil</span><span class="token punctuation">,</span> <span class="token keyword">nil</span>  <span class="token comment">-- 返回两个nil</span>
    <span class="token keyword">end</span>
    
    <span class="token keyword">local</span> min_val <span class="token operator">=</span> numbers<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    <span class="token keyword">local</span> max_val <span class="token operator">=</span> numbers<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    
    <span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">#</span>numbers <span class="token keyword">do</span>
        <span class="token keyword">if</span> numbers<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> min_val <span class="token keyword">then</span>
            min_val <span class="token operator">=</span> numbers<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
        <span class="token keyword">end</span>
        <span class="token keyword">if</span> numbers<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;</span> max_val <span class="token keyword">then</span>
            max_val <span class="token operator">=</span> numbers<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
        <span class="token keyword">end</span>
    <span class="token keyword">end</span>
    
    <span class="token keyword">return</span> min_val<span class="token punctuation">,</span> max_val
<span class="token keyword">end</span>

<span class="token comment">-- 接收多个返回值</span>
<span class="token keyword">local</span> scores <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">85</span><span class="token punctuation">,</span> <span class="token number">92</span><span class="token punctuation">,</span> <span class="token number">78</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">88</span><span class="token punctuation">}</span>
<span class="token keyword">local</span> min_score<span class="token punctuation">,</span> max_score <span class="token operator">=</span> <span class="token function">min_max</span><span class="token punctuation">(</span>scores<span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"最低分："</span> <span class="token operator">..</span> min_score<span class="token punctuation">)</span>  <span class="token comment">-- 78</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"最高分："</span> <span class="token operator">..</span> max_score<span class="token punctuation">)</span>  <span class="token comment">-- 92</span>

<span class="token comment">-- 如果只需要部分返回值，可以用下划线忽略</span>
<span class="token keyword">local</span> _<span class="token punctuation">,</span> highest <span class="token operator">=</span> <span class="token function">min_max</span><span class="token punctuation">(</span>scores<span class="token punctuation">)</span>  <span class="token comment">-- 只关心最高分</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"只关心最高分："</span> <span class="token operator">..</span> highest<span class="token punctuation">)</span>

<span class="token comment">-- 返回值和接收值的数量可以不匹配（多余的会被视为 nil）</span>
<span class="token keyword">local</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c <span class="token operator">=</span> <span class="token function">min_max</span><span class="token punctuation">(</span>scores<span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"a = "</span> <span class="token operator">..</span> <span class="token function">tostring</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">-- 78</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"b = "</span> <span class="token operator">..</span> <span class="token function">tostring</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">-- 92</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"c = "</span> <span class="token operator">..</span> <span class="token function">tostring</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">-- nil（只有两个返回值）</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h4"><h4 data-heading="示例" dir="auto" class="heading" id="示例_3"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>示例</h4></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token comment">-- 游戏示例：获取玩家位置</span>
<span class="token keyword">function</span> <span class="token function">get_player_position</span><span class="token punctuation">(</span>player_id<span class="token punctuation">)</span>
    <span class="token comment">-- 模拟从游戏引擎获取位置</span>
    <span class="token keyword">local</span> x <span class="token operator">=</span> <span class="token number">100</span> <span class="token operator">+</span> player_id <span class="token operator">*</span> <span class="token number">10</span>
    <span class="token keyword">local</span> y <span class="token operator">=</span> <span class="token number">50</span> <span class="token operator">+</span> player_id <span class="token operator">*</span> <span class="token number">5</span>
    <span class="token keyword">local</span> z <span class="token operator">=</span> <span class="token number">0</span>  <span class="token comment">-- 2D游戏中的高度</span>
    
    <span class="token keyword">return</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z
<span class="token keyword">end</span>

<span class="token comment">-- 获取玩家1的位置</span>
<span class="token keyword">local</span> x1<span class="token punctuation">,</span> y1<span class="token punctuation">,</span> z1 <span class="token operator">=</span> <span class="token function">get_player_position</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"玩家1位置：("</span> <span class="token operator">..</span> x1 <span class="token operator">..</span> <span class="token string">", "</span> <span class="token operator">..</span> y1 <span class="token operator">..</span> <span class="token string">", "</span> <span class="token operator">..</span> z1 <span class="token operator">..</span> <span class="token string">")"</span><span class="token punctuation">)</span>

<span class="token comment">-- 获取玩家2的位置（只关心x和y坐标）</span>
<span class="token keyword">local</span> x2<span class="token punctuation">,</span> y2 <span class="token operator">=</span> <span class="token function">get_player_position</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"玩家2位置：("</span> <span class="token operator">..</span> x2 <span class="token operator">..</span> <span class="token string">", "</span> <span class="token operator">..</span> y2 <span class="token operator">..</span> <span class="token string">")"</span><span class="token punctuation">)</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h3"><h3 data-heading="6.4.3 返回表的技巧" dir="auto" class="heading" id="6.4.3_返回表的技巧_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>6.4.3 返回表的技巧</h3></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token comment">-- 有时返回表比返回多个值更方便</span>
<span class="token keyword">function</span> <span class="token function">get_player_stats</span><span class="token punctuation">(</span>player_id<span class="token punctuation">)</span>
    <span class="token comment">-- 模拟获取玩家状态</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        health <span class="token operator">=</span> <span class="token number">100</span> <span class="token operator">-</span> player_id <span class="token operator">*</span> <span class="token number">10</span><span class="token punctuation">,</span>
        mana <span class="token operator">=</span> <span class="token number">50</span> <span class="token operator">+</span> player_id <span class="token operator">*</span> <span class="token number">5</span><span class="token punctuation">,</span>
        level <span class="token operator">=</span> player_id<span class="token punctuation">,</span>
        experience <span class="token operator">=</span> player_id <span class="token operator">*</span> <span class="token number">100</span>
    <span class="token punctuation">}</span>
<span class="token keyword">end</span>

<span class="token comment">-- 使用返回的表</span>
<span class="token keyword">local</span> stats <span class="token operator">=</span> <span class="token function">get_player_stats</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"玩家3状态："</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"生命值："</span> <span class="token operator">..</span> stats<span class="token punctuation">.</span>health<span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"魔法值："</span> <span class="token operator">..</span> stats<span class="token punctuation">.</span>mana<span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"等级："</span> <span class="token operator">..</span> stats<span class="token punctuation">.</span>level<span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"经验："</span> <span class="token operator">..</span> stats<span class="token punctuation">.</span>experience<span class="token punctuation">)</span>

<span class="token comment">-- 可以直接在表达式中使用</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"生命值/魔法值比例："</span> <span class="token operator">..</span> <span class="token function">get_player_stats</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span>health <span class="token operator">/</span> <span class="token function">get_player_stats</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mana<span class="token punctuation">)</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h3"><h3 data-heading="6.4.4 返回函数" dir="auto" class="heading" id="6.4.4_返回函数_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>6.4.4 返回函数</h3></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token comment">-- 函数可以返回另一个函数</span>
<span class="token keyword">function</span> <span class="token function">create_multiplier</span><span class="token punctuation">(</span>factor<span class="token punctuation">)</span>
    <span class="token comment">-- 返回一个新的函数</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        <span class="token keyword">return</span> x <span class="token operator">*</span> factor
    <span class="token keyword">end</span>
<span class="token keyword">end</span>

<span class="token comment">-- 创建特定的乘法器</span>
<span class="token keyword">local</span> double <span class="token operator">=</span> <span class="token function">create_multiplier</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token keyword">local</span> triple <span class="token operator">=</span> <span class="token function">create_multiplier</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token keyword">local</span> times_ten <span class="token operator">=</span> <span class="token function">create_multiplier</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>

<span class="token comment">-- 使用返回的函数</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"2的两倍："</span> <span class="token operator">..</span> <span class="token function">double</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>      <span class="token comment">-- 4</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"2的三倍："</span> <span class="token operator">..</span> <span class="token function">triple</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>      <span class="token comment">-- 6</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"2的十倍："</span> <span class="token operator">..</span> <span class="token function">times_ten</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>   <span class="token comment">-- 20</span>

<span class="token comment">-- 实际应用：创建不同难度的游戏关卡</span>
<span class="token keyword">function</span> <span class="token function">create_enemy_generator</span><span class="token punctuation">(</span>difficulty<span class="token punctuation">)</span>
    <span class="token keyword">local</span> health_multiplier <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">+</span> <span class="token punctuation">(</span>difficulty <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">0.5</span>  <span class="token comment">-- 难度越高，生命值越高</span>
    
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span>base_health<span class="token punctuation">)</span>
        <span class="token keyword">return</span> base_health <span class="token operator">*</span> health_multiplier
    <span class="token keyword">end</span>
<span class="token keyword">end</span>

<span class="token comment">-- 创建不同难度的敌人生成器</span>
<span class="token keyword">local</span> easy_enemy <span class="token operator">=</span> <span class="token function">create_enemy_generator</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>   <span class="token comment">-- 简单</span>
<span class="token keyword">local</span> normal_enemy <span class="token operator">=</span> <span class="token function">create_enemy_generator</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">-- 普通</span>
<span class="token keyword">local</span> hard_enemy <span class="token operator">=</span> <span class="token function">create_enemy_generator</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>   <span class="token comment">-- 困难</span>

<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"简单敌人生命值："</span> <span class="token operator">..</span> <span class="token function">easy_enemy</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment">-- 100</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"普通敌人生命值："</span> <span class="token operator">..</span> <span class="token function">normal_enemy</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">-- 150</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"困难敌人生命值："</span> <span class="token operator">..</span> <span class="token function">hard_enemy</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment">-- 200</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h3"><h3 data-heading="6.5.5 技巧" dir="auto" class="heading" id="6.5.5_技巧_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>6.5.5 技巧</h3></div><div class="el-p"><p dir="auto">有些函数内的判断可以使用<strong>卫语句</strong>来提前返回，降低镶套与缩进层数，同时也可以提高性能</p></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token comment">-- 解锁关卡检查</span>
<span class="token keyword">local</span> player_level <span class="token operator">=</span> <span class="token number">10</span>

<span class="token keyword">local</span> info_level <span class="token operator">=</span> <span class="token string">"森林"</span>	<span class="token comment">-- 模拟玩家点击关卡</span>
<span class="token keyword">local</span> level_mode <span class="token operator">=</span> <span class="token string">"夜晚模式"</span>
<span class="token keyword">local</span> unlocked_level <span class="token operator">=</span> <span class="token punctuation">{</span>forest <span class="token operator">=</span> <span class="token keyword">true</span><span class="token punctuation">}</span>

<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">check_level_unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> info_level <span class="token operator">==</span> <span class="token string">"森林"</span> <span class="token keyword">then</span>
	    <span class="token keyword">if</span> player_level <span class="token operator">&gt;=</span> <span class="token number">1</span> <span class="token keyword">then</span>	<span class="token comment">-- 玩家等级大于等于 1</span>
	        <span class="token keyword">if</span> level_mode <span class="token operator">==</span> <span class="token string">"夜晚模式"</span> <span class="token keyword">then</span>	<span class="token comment">-- 判断关卡模式</span>
				<span class="token keyword">if</span> unlocked_level<span class="token punctuation">.</span>forest <span class="token keyword">then</span>
					<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"玩家进入夜晚的森林"</span><span class="token punctuation">)</span>
				<span class="token keyword">else</span>
					<span class="token keyword">return</span> <span class="token string">"错误，玩家未解锁森林"</span>
				<span class="token keyword">end</span>
	        <span class="token keyword">elseif</span> level_mode <span class="token operator">==</span> <span class="token string">"白天模式"</span> <span class="token keyword">then</span>
	            <span class="token keyword">if</span> unlocked_level<span class="token punctuation">.</span>forest <span class="token keyword">then</span>
					<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"玩家进入白天的森林"</span><span class="token punctuation">)</span>
				<span class="token keyword">else</span>
					<span class="token keyword">return</span> <span class="token string">"错误，玩家未解锁森林"</span>
				<span class="token keyword">end</span>
	        <span class="token keyword">else</span>
	            <span class="token keyword">return</span> <span class="token string">"错误，未知模式"</span>
	        <span class="token keyword">end</span>
	    <span class="token keyword">else</span>
	        <span class="token keyword">return</span> <span class="token string">"错误，玩家等级不足，不能进入森林"</span>
	    <span class="token keyword">end</span>
	<span class="token keyword">end</span>
<span class="token keyword">end</span>

<span class="token comment">-- 改进版本</span>
<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">check_level_unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> info_level <span class="token operator">==</span> <span class="token string">"森林"</span> <span class="token keyword">then</span>
	    <span class="token keyword">if</span> player_level <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token keyword">then</span>	<span class="token comment">-- 提前判断等级是否足够，不足直接返回</span>
	    	<span class="token keyword">return</span> <span class="token string">"玩家等级不足，不能进入森林"</span>
	    <span class="token keyword">end</span>
	    
	    <span class="token keyword">if</span> <span class="token keyword">not</span> unlocked_level<span class="token punctuation">.</span>forest <span class="token keyword">then</span>	<span class="token comment">-- 提前判断是否解锁关卡，没有解锁直接返回</span>
			<span class="token keyword">return</span> <span class="token string">"错误，玩家未解锁森林"</span>
		<span class="token keyword">end</span>
		
		<span class="token keyword">if</span> level_mode <span class="token operator">==</span> <span class="token string">"夜晚模式"</span> <span class="token keyword">then</span>	<span class="token comment">-- 判断关卡模式</span>
			<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"玩家进入夜晚的森林"</span><span class="token punctuation">)</span>
		<span class="token keyword">elseif</span> level_mode <span class="token operator">==</span> <span class="token string">"白天模式"</span> <span class="token keyword">then</span>
			<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"玩家进入白天的森林"</span><span class="token punctuation">)</span>
		<span class="token keyword">else</span>
			<span class="token keyword">return</span> <span class="token string">"错误，未知模式"</span>
		<span class="token keyword">end</span>
	<span class="token keyword">end</span>
<span class="token keyword">end</span>

<span class="token keyword">local</span> err <span class="token operator">=</span> <span class="token function">check_level_unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token keyword">then</span>
	<span class="token function">print</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
<span class="token keyword">end</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h2"><h2 data-heading="6.5 匿名函数" dir="auto" class="heading" id="6.5_匿名函数_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>6.5 匿名函数</h2></div><div class="el-p"><p dir="auto">匿名函数（也叫 lambda 函数）是没有名字的函数，通常作为值使用。</p></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token comment">-- 基本匿名函数</span>
<span class="token keyword">local</span> add <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
    <span class="token keyword">return</span> a <span class="token operator">+</span> b
<span class="token keyword">end</span>

<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"5 + 3 = "</span> <span class="token operator">..</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">-- 8</span>

<span class="token comment">-- 立即调用的匿名函数（IIFE）</span>
<span class="token keyword">local</span> result <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    <span class="token keyword">return</span> x <span class="token operator">*</span> x
<span class="token keyword">end</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>

<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"5 的平方："</span> <span class="token operator">..</span> result<span class="token punctuation">)</span>  <span class="token comment">-- 25</span>

<span class="token comment">-- 作为参数传递给其他函数</span>
<span class="token keyword">local</span> numbers <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">}</span>

<span class="token comment">-- 使用匿名函数作为回调</span>
<span class="token keyword">function</span> <span class="token function">process_numbers</span><span class="token punctuation">(</span>numbers<span class="token punctuation">,</span> processor<span class="token punctuation">)</span>
    <span class="token keyword">for</span> i<span class="token punctuation">,</span> num <span class="token keyword">in</span> <span class="token function">ipairs</span><span class="token punctuation">(</span>numbers<span class="token punctuation">)</span> <span class="token keyword">do</span>
        numbers<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">processor</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span>
    <span class="token keyword">end</span>
    
    <span class="token keyword">return</span> numbers
<span class="token keyword">end</span>

<span class="token comment">-- 传入匿名函数处理数组</span>
<span class="token keyword">local</span> doubled <span class="token operator">=</span> <span class="token function">process_numbers</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">return</span> x <span class="token operator">*</span> <span class="token number">2</span> <span class="token keyword">end</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"加倍后的数组："</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i<span class="token punctuation">,</span> v <span class="token keyword">in</span> <span class="token function">ipairs</span><span class="token punctuation">(</span>doubled<span class="token punctuation">)</span> <span class="token keyword">do</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"  "</span> <span class="token operator">..</span> v<span class="token punctuation">)</span>  <span class="token comment">-- 2, 4, 6</span>
<span class="token keyword">end</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h2"><h2 data-heading="6.6 函数的作用域和闭包" dir="auto" class="heading" id="6.6_函数的作用域和闭包_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>6.6 函数的作用域和闭包</h2></div><div class="el-h3"><h3 data-heading="6.6.1 作用域" dir="auto" class="heading" id="6.6.1_作用域_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>6.6.1 作用域</h3></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">outer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"进入 outer 函数的局部作用域"</span><span class="token punctuation">)</span>
    
    <span class="token keyword">local</span> outer_var <span class="token operator">=</span> <span class="token string">"局部变量"</span>
    
    <span class="token keyword">function</span> <span class="token function">inner</span><span class="token punctuation">(</span><span class="token punctuation">)</span>	<span class="token comment">-- 全局函数</span>
        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"inner 函数访问: "</span> <span class="token operator">..</span> outer_var<span class="token punctuation">)</span>
    <span class="token keyword">end</span>
    
    <span class="token comment">-- 调用全局函数</span>
    <span class="token function">inner</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"退出 outer 函数的局部作用域"</span><span class="token punctuation">)</span>
<span class="token keyword">end</span>

<span class="token function">outer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">-- 注意：inner 函数如果在外部调用，需要先调用 outer 函数定义 inner</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h3"><h3 data-heading="6.6.2 闭包" dir="auto" class="heading" id="6.6.2_闭包_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>6.6.2 闭包</h3></div><div class="el-p"><p dir="auto">闭包是 Lua 中一个强大而有趣的概念。简单说，闭包就是一个能记住并访问其创建时环境的函数。</p></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token comment">-- 基本闭包示例</span>
<span class="token comment">-- 计数器函数</span>
<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">make_counter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">local</span> count <span class="token operator">=</span> <span class="token number">0</span>  <span class="token comment">-- 局部变量，外部无法直接访问</span>
    
    <span class="token comment">-- 返回一个函数，这个函数能访问 count</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        count <span class="token operator">=</span> count <span class="token operator">+</span> <span class="token number">1</span>
        <span class="token keyword">return</span> count
    <span class="token keyword">end</span>
<span class="token keyword">end</span>

<span class="token comment">-- 创建两个独立的计数器</span>
<span class="token keyword">local</span> counter1 <span class="token operator">=</span> <span class="token function">make_counter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>		<span class="token comment">-- 存储了一个独立的 count，每次调用 counter1 将存储的 count + 1</span>
<span class="token keyword">local</span> counter2 <span class="token operator">=</span> <span class="token function">make_counter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>		<span class="token comment">-- 这里创建了一个新的 count</span>

<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"计数器 1:"</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">counter1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">-- 1</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">counter1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">-- 2</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">counter1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">-- 3</span>

<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"计数器 2:"</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">counter2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">-- 1（独立计数）</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">counter2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">-- 2</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">counter2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">-- 3</span>

<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">counter1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">-- 4</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">counter2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">-- 4</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h4"><h4 data-heading="示例" dir="auto" class="heading" id="示例_4"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>示例</h4></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token comment">-- 闭包的实际应用：创建配置器</span>
<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">create_configurator</span><span class="token punctuation">(</span>default_config<span class="token punctuation">)</span>
    <span class="token keyword">local</span> config <span class="token operator">=</span> default_config
    
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        get <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
            <span class="token keyword">return</span> config<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
        <span class="token keyword">end</span><span class="token punctuation">,</span>
        
        set <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span>
            config<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> value
            <span class="token keyword">return</span> <span class="token keyword">true</span>
        <span class="token keyword">end</span><span class="token punctuation">,</span>
        
        show <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"当前配置:"</span><span class="token punctuation">)</span>
            <span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span> <span class="token keyword">do</span>
                <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"  "</span> <span class="token operator">..</span> k <span class="token operator">..</span> <span class="token string">": "</span> <span class="token operator">..</span> <span class="token function">tostring</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">end</span>
        <span class="token keyword">end</span>
    <span class="token punctuation">}</span>
<span class="token keyword">end</span>

<span class="token comment">-- 使用配置器</span>
<span class="token keyword">local</span> game_config <span class="token operator">=</span> <span class="token function">create_configurator</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    sound <span class="token operator">=</span> <span class="token keyword">true</span><span class="token punctuation">,</span>
    music <span class="token operator">=</span> <span class="token keyword">true</span><span class="token punctuation">,</span>
    difficulty <span class="token operator">=</span> <span class="token string">"normal"</span><span class="token punctuation">,</span>
    volume <span class="token operator">=</span> <span class="token number">70</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

game_config<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
game_config<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"difficulty"</span><span class="token punctuation">,</span> <span class="token string">"hard"</span><span class="token punctuation">)</span>
game_config<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"volume"</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"新的难度："</span> <span class="token operator">..</span> game_config<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"difficulty"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">--[[ 输出
当前配置:
  difficulty: normal
  music: true
  sound: true
  volume: 70
新的难度：hard
--]]</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h2"><h2 data-heading="6.7 递归函数" dir="auto" class="heading" id="6.7_递归函数_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>6.7 递归函数</h2></div><div class="el-p"><p dir="auto">递归是函数调用自身的技术，常用于解决分治问题。</p></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token comment">-- 经典的阶乘函数</span>
<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">factorial</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
    <span class="token keyword">if</span> n <span class="token operator">&lt;=</span> <span class="token number">1</span> <span class="token keyword">then</span>
        <span class="token keyword">return</span> <span class="token number">1</span>
	<span class="token keyword">end</span>
	
    <span class="token keyword">return</span> n <span class="token operator">*</span> <span class="token function">factorial</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">end</span>

<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"5 的阶乘: "</span> <span class="token operator">..</span> <span class="token function">factorial</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">-- 120</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"10 的阶乘: "</span> <span class="token operator">..</span> <span class="token function">factorial</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">-- 3628800</span>

<span class="token comment">-- 斐波那契数列</span>
<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">fibonacci</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
    <span class="token keyword">if</span> n <span class="token operator">&lt;=</span> <span class="token number">0</span> <span class="token keyword">then</span>
        <span class="token keyword">return</span> <span class="token number">0</span>
    <span class="token keyword">elseif</span> n <span class="token operator">==</span> <span class="token number">1</span> <span class="token keyword">then</span>
        <span class="token keyword">return</span> <span class="token number">1</span>
    <span class="token keyword">end</span>
    
    <span class="token keyword">return</span> <span class="token function">fibonacci</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">fibonacci</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token keyword">end</span>

<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"斐波那契数列前 10 项:"</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">9</span> <span class="token keyword">do</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token function">fibonacci</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">..</span> <span class="token string">" "</span><span class="token punctuation">)</span>  <span class="token comment">-- 0 1 1 2 3 5 8 13 21 34</span>
<span class="token keyword">end</span>

<span class="token comment">-- 注意：递归要有终止条件，否则会导致栈溢出</span>
<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">infinite_recursion</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">infinite_recursion</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">-- 无限递归，会导致错误</span>
<span class="token keyword">end</span>

<span class="token comment">-- infinite_recursion()  -- 不要真的调用！</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h2"><h2 data-heading="6.8 文档注释" dir="auto" class="heading" id="6.8_文档注释_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>6.8 文档注释</h2></div><div class="el-p"><p dir="auto">文档注释类似于类型注解，标注函数作用、每个参数的作用、返回值，同时集成在 vscode 中，鼠标悬浮在函数上即可直接显示参数作用。</p></div><div class="el-p"><p dir="auto">推荐给你的所有函数增加文档注释，便于阅读代码。</p></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token comment">---函数作用</span>
<span class="token comment">---@param 参数 参数类型 参数作用</span>
<span class="token comment">---@return 返回类型 返回描述</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h4"><h4 data-heading="示例" dir="auto" class="heading" id="示例_5"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>示例</h4></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token comment">-- 注意：只能写到定义函数的上面</span>

<span class="token comment">---对某人说 hello</span>
<span class="token comment">---@param name string 名称</span>
<span class="token comment">---@return string 完整文本</span>
<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">say_hello</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
	<span class="token keyword">local</span> text <span class="token operator">=</span> <span class="token string">"hello "</span> <span class="token operator">..</span> name

	<span class="token function">print</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span>
	<span class="token keyword">return</span> text
<span class="token keyword">end</span>

<span class="token function">say_hello</span><span class="token punctuation">(</span><span class="token string">"bob"</span><span class="token punctuation">)</span>
<span class="token comment">-- 输出 hello bob</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">鼠标悬浮到 <code>say_hello</code> 函数上面显示：<br>
<span alt="Pasted image 20251211205307.png" src="site-lib/media/pasted-image-20251211205307.png" class="internal-embed media-embed image-embed is-loaded" target="_self" style="width: 345px; max-width: 100%;"><img alt="Pasted image 20251211205307.png" src="site-lib/media/pasted-image-20251211205307.png" target="_self" style="width: 345px; max-width: 100%;"></span></p></div><div class="el-h2"><h2 data-heading="6.9 练习" dir="auto" class="heading" id="6.9_练习_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>6.9 练习</h2></div><div class="el-h3"><h3 data-heading="练习 1：简单的计算器函数库" dir="auto" class="heading" id="练习_1：简单的计算器函数库_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>练习 1：简单的计算器函数库</h3></div><div class="el-p"><p dir="auto">（答案见 <a data-href="第 1 节 - 语法/参考答案#练习 6 1：简单的计算器函数库" href="第-1-节-语法/参考答案.html#练习 6 1：简单的计算器函数库" class="internal-link" target="_self" rel="noopener nofollow">第 1 节 - 语法/参考答案 &gt; 练习 6 1：简单的计算器函数库</a>）</p></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token comment">-- 写几个计算器用的函数，需要有基础四则运算，平均值计算</span>
<span class="token comment">-- 使用示例：</span>
<span class="token comment">-- 使用函数库</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"5 + 3 = "</span> <span class="token operator">..</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"10 - 4 = "</span> <span class="token operator">..</span> <span class="token function">subtract</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"6 * 7 = "</span> <span class="token operator">..</span> <span class="token function">multiply</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">local</span> result<span class="token punctuation">,</span> error_msg <span class="token operator">=</span> <span class="token function">divide</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> error_msg <span class="token keyword">then</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"错误: "</span> <span class="token operator">..</span> error_msg<span class="token punctuation">)</span>
<span class="token keyword">else</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"10 / 2 = "</span> <span class="token operator">..</span> result<span class="token punctuation">)</span>
<span class="token keyword">end</span>

<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"平均值(1,2,3,4,5) = "</span> <span class="token operator">..</span> <span class="token function">average</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">--[[ 输出
5 + 3 = 8
10 - 4 = 6
6 * 7 = 42
错误: 除数不能为 0
平均值(1,2,3,4,5) = 3
--]]</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h3"><h3 data-heading="练习 2：提取函数，优化代码" dir="auto" class="heading" id="练习_2：提取函数，优化代码_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>练习 2：提取函数，优化代码</h3></div><div class="el-p"><p dir="auto">（答案见 <a data-href="第 1 节 - 语法/参考答案#练习 6 2：提取函数，优化代码" href="第-1-节-语法/参考答案.html#练习 6 2：提取函数，优化代码" class="internal-link" target="_self" rel="noopener nofollow">第 1 节 - 语法/参考答案 &gt; 练习 6 2：提取函数，优化代码</a>）</p></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token comment">-- 将以下所有代码提取为函数，再改进代码，要求：使用卫语句</span>

<span class="token comment">-- 购物车商品处理程序</span>

<span class="token comment">-- 模拟购买的物品</span>
<span class="token keyword">local</span> cart <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token punctuation">{</span> name <span class="token operator">=</span> <span class="token string">"苹果"</span><span class="token punctuation">,</span> price <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">,</span> quantity <span class="token operator">=</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> name <span class="token operator">=</span> <span class="token string">"香蕉"</span><span class="token punctuation">,</span> price <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> quantity <span class="token operator">=</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> name <span class="token operator">=</span> <span class="token string">"橙子"</span><span class="token punctuation">,</span> price <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">,</span> quantity <span class="token operator">=</span> <span class="token number">4</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> name <span class="token operator">=</span> <span class="token string">"葡萄"</span><span class="token punctuation">,</span> price <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">,</span> quantity <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">-- 打印商品详细信息</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"=== 商品详情 ==="</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> _<span class="token punctuation">,</span> item <span class="token keyword">in</span> <span class="token function">ipairs</span><span class="token punctuation">(</span>cart<span class="token punctuation">)</span> <span class="token keyword">do</span>
    <span class="token keyword">local</span> item_total <span class="token operator">=</span> item<span class="token punctuation">.</span>price <span class="token operator">*</span> item<span class="token punctuation">.</span>quantity

    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"商品: "</span> <span class="token operator">..</span> item<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"单价: "</span> <span class="token operator">..</span> item<span class="token punctuation">.</span>price <span class="token operator">..</span> <span class="token string">"元"</span><span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"数量: "</span> <span class="token operator">..</span> item<span class="token punctuation">.</span>quantity<span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"小计: "</span> <span class="token operator">..</span> item_total <span class="token operator">..</span> <span class="token string">"元"</span><span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"------------"</span><span class="token punctuation">)</span>
<span class="token keyword">end</span>

<span class="token comment">-- 计算购物车信息</span>
<span class="token keyword">local</span> total_price <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">local</span> total_quantity <span class="token operator">=</span> <span class="token number">0</span>

<span class="token keyword">for</span> _<span class="token punctuation">,</span> item <span class="token keyword">in</span> <span class="token function">ipairs</span><span class="token punctuation">(</span>cart<span class="token punctuation">)</span> <span class="token keyword">do</span>
    total_price <span class="token operator">=</span> total_price <span class="token operator">+</span> <span class="token punctuation">(</span>item<span class="token punctuation">.</span>price <span class="token operator">*</span> item<span class="token punctuation">.</span>quantity<span class="token punctuation">)</span>
    total_quantity <span class="token operator">=</span> total_quantity <span class="token operator">+</span> item<span class="token punctuation">.</span>quantity
<span class="token keyword">end</span>

<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"购物车总价: "</span> <span class="token operator">..</span> total_price <span class="token operator">..</span> <span class="token string">"元"</span><span class="token punctuation">)</span>

<span class="token comment">-- 判断是否有优惠（满50减10，满100减25，买10个赠1个）</span>
<span class="token keyword">if</span> total_price <span class="token operator">&gt;=</span> <span class="token number">50</span> <span class="token keyword">and</span> total_price <span class="token operator">&lt;</span> <span class="token number">100</span> <span class="token keyword">then</span>
    <span class="token keyword">if</span> total_quantity <span class="token operator">&gt;=</span> <span class="token number">10</span> <span class="token keyword">then</span>
        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"购物车物品总数："</span> <span class="token operator">..</span> total_quantity <span class="token operator">..</span> <span class="token string">"个，赠品1个"</span><span class="token punctuation">)</span>
        <span class="token keyword">local</span> discount_price <span class="token operator">=</span> total_price <span class="token operator">-</span> <span class="token number">10</span>
        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"符合优惠条件，满50减10"</span><span class="token punctuation">)</span>
        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"优惠后价格: "</span> <span class="token operator">..</span> discount_price <span class="token operator">..</span> <span class="token string">"元"</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span>
        <span class="token keyword">local</span> discount_price <span class="token operator">=</span> total_price <span class="token operator">-</span> <span class="token number">10</span>
        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"符合优惠条件，满50减10"</span><span class="token punctuation">)</span>
        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"优惠后价格: "</span> <span class="token operator">..</span> discount_price <span class="token operator">..</span> <span class="token string">"元"</span><span class="token punctuation">)</span>
    <span class="token keyword">end</span>
<span class="token keyword">elseif</span> total_price <span class="token operator">&gt;=</span> <span class="token number">100</span> <span class="token keyword">then</span>
    <span class="token keyword">if</span> total_quantity <span class="token operator">&gt;=</span> <span class="token number">10</span> <span class="token keyword">then</span>
        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"购物车物品总数："</span> <span class="token operator">..</span> total_quantity <span class="token operator">..</span> <span class="token string">"个，赠品1个"</span><span class="token punctuation">)</span>
        <span class="token keyword">local</span> discount_price <span class="token operator">=</span> total_price <span class="token operator">-</span> <span class="token number">25</span>
        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"符合优惠条件，满100减25"</span><span class="token punctuation">)</span>
        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"优惠后价格: "</span> <span class="token operator">..</span> discount_price <span class="token operator">..</span> <span class="token string">"元"</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span>
        <span class="token keyword">local</span> discount_price <span class="token operator">=</span> total_price <span class="token operator">-</span> <span class="token number">25</span>
        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"符合优惠条件，满100减25"</span><span class="token punctuation">)</span>
        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"优惠后价格: "</span> <span class="token operator">..</span> discount_price <span class="token operator">..</span> <span class="token string">"元"</span><span class="token punctuation">)</span>
    <span class="token keyword">end</span>
<span class="token keyword">else</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"未满50元，无优惠"</span><span class="token punctuation">)</span>
<span class="token keyword">end</span>

<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n=== 推荐商品 ==="</span><span class="token punctuation">)</span>
<span class="token comment">-- 根据购物车推荐相关商品</span>
<span class="token keyword">local</span> recommendations <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token punctuation">{</span> name <span class="token operator">=</span> <span class="token string">"梨子"</span><span class="token punctuation">,</span> price <span class="token operator">=</span> <span class="token number">6</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> name <span class="token operator">=</span> <span class="token string">"芒果"</span><span class="token punctuation">,</span> price <span class="token operator">=</span> <span class="token number">10</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">for</span> _<span class="token punctuation">,</span> cart_item <span class="token keyword">in</span> <span class="token function">ipairs</span><span class="token punctuation">(</span>cart<span class="token punctuation">)</span> <span class="token keyword">do</span>
    <span class="token keyword">if</span> cart_item<span class="token punctuation">.</span>name <span class="token operator">==</span> <span class="token string">"苹果"</span> <span class="token keyword">then</span>
        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"您购买了苹果，可能也喜欢:"</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> _<span class="token punctuation">,</span> rec <span class="token keyword">in</span> <span class="token function">ipairs</span><span class="token punctuation">(</span>recommendations<span class="token punctuation">)</span> <span class="token keyword">do</span>
            <span class="token keyword">local</span> rec_total <span class="token operator">=</span> rec<span class="token punctuation">.</span>price <span class="token operator">*</span> <span class="token number">1</span> <span class="token comment">-- 假设推荐买1个</span>
            <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"  "</span> <span class="token operator">..</span> rec<span class="token punctuation">.</span>name <span class="token operator">..</span> <span class="token string">": "</span> <span class="token operator">..</span> rec<span class="token punctuation">.</span>price <span class="token operator">..</span> <span class="token string">"元/个"</span><span class="token punctuation">)</span>
        <span class="token keyword">end</span>
    <span class="token keyword">end</span>

    <span class="token keyword">if</span> cart_item<span class="token punctuation">.</span>name <span class="token operator">==</span> <span class="token string">"香蕉"</span> <span class="token keyword">then</span>
        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"您购买了香蕉，可能也喜欢:"</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> _<span class="token punctuation">,</span> rec <span class="token keyword">in</span> <span class="token function">ipairs</span><span class="token punctuation">(</span>recommendations<span class="token punctuation">)</span> <span class="token keyword">do</span>
            <span class="token keyword">local</span> rec_total <span class="token operator">=</span> rec<span class="token punctuation">.</span>price <span class="token operator">*</span> <span class="token number">1</span>
            <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"  "</span> <span class="token operator">..</span> rec<span class="token punctuation">.</span>name <span class="token operator">..</span> <span class="token string">": "</span> <span class="token operator">..</span> rec<span class="token punctuation">.</span>price <span class="token operator">..</span> <span class="token string">"元/个"</span><span class="token punctuation">)</span>
        <span class="token keyword">end</span>
    <span class="token keyword">end</span>

    <span class="token keyword">if</span> cart_item<span class="token punctuation">.</span>name <span class="token operator">==</span> <span class="token string">"橙子"</span> <span class="token keyword">then</span>
        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"您购买了橙子，可能也喜欢:"</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> _<span class="token punctuation">,</span> rec <span class="token keyword">in</span> <span class="token function">ipairs</span><span class="token punctuation">(</span>recommendations<span class="token punctuation">)</span> <span class="token keyword">do</span>
            <span class="token keyword">local</span> rec_total <span class="token operator">=</span> rec<span class="token punctuation">.</span>price <span class="token operator">*</span> <span class="token number">1</span>
            <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"  "</span> <span class="token operator">..</span> rec<span class="token punctuation">.</span>name <span class="token operator">..</span> <span class="token string">": "</span> <span class="token operator">..</span> rec<span class="token punctuation">.</span>price <span class="token operator">..</span> <span class="token string">"元/个"</span><span class="token punctuation">)</span>
        <span class="token keyword">end</span>
    <span class="token keyword">end</span>
<span class="token keyword">end</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h2"><h2 data-heading="6.10 本章总结" dir="auto" class="heading" id="6.10_本章总结_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>6.10 本章总结</h2></div><div class="el-h3"><h3 data-heading="关键知识点回顾" dir="auto" class="heading" id="关键知识点回顾_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>关键知识点回顾</h3></div><div class="el-ol"><ol>
<li data-line="0" dir="auto"><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>函数定义</strong>：</p>
<ul class="has-list-bullet">
<li data-line="1" dir="auto"><span class="list-bullet"></span><code>function name(params) ... end</code> 语法</li>
<li data-line="2" dir="auto"><span class="list-bullet"></span>函数表达式：<code>local name = function(params) ... end</code></li>
<li data-line="3" dir="auto"><span class="list-bullet"></span>匿名函数：直接作为值使用</li>
</ul>
</li>
<li data-line="5" dir="auto"><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>参数传递</strong>：</p>
<ul class="has-list-bullet">
<li data-line="6" dir="auto"><span class="list-bullet"></span>值类型是值传递，表是引用传递</li>
<li data-line="7" dir="auto"><span class="list-bullet"></span>变长参数：使用 <code>...</code></li>
<li data-line="8" dir="auto"><span class="list-bullet"></span>参数可以有默认值（通过 <code>or</code> 实现）</li>
</ul>
</li>
<li data-line="10" dir="auto"><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>返回值</strong>：</p>
<ul class="has-list-bullet">
<li data-line="11" dir="auto"><span class="list-bullet"></span>可以返回单个值或多个值</li>
<li data-line="12" dir="auto"><span class="list-bullet"></span>可以返回函数（高阶函数）</li>
<li data-line="13" dir="auto"><span class="list-bullet"></span>可以返回表来组织复杂数据</li>
</ul>
</li>
<li data-line="15" dir="auto"><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>高级概念</strong>：</p>
<ul class="has-list-bullet">
<li data-line="16" dir="auto"><span class="list-bullet"></span>闭包：能记住创建环境的函数</li>
<li data-line="17" dir="auto"><span class="list-bullet"></span>递归：函数调用自身</li>
</ul>
</li>
<li data-line="19" dir="auto"><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>文档注释</strong>：</p>
<ul class="has-list-bullet">
<li data-line="20" dir="auto"><span class="list-bullet"></span>使用 --- 进行文档注释</li>
<li data-line="21" dir="auto"><span class="list-bullet"></span>使用 @param 和 @return 描述参数与返回值作用</li>
</ul>
</li>
</ol></div><div class="el-h3"><h3 data-heading="函数设计的最佳实践" dir="auto" class="heading" id="函数设计的最佳实践_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>函数设计的最佳实践</h3></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token comment">-- 1. 函数应该只做一件事（单一职责）</span>
<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">calculate_area</span><span class="token punctuation">(</span>width<span class="token punctuation">,</span> height<span class="token punctuation">)</span>  <span class="token comment">-- 好：只计算面积</span>
    <span class="token keyword">return</span> width <span class="token operator">*</span> height
<span class="token keyword">end</span>

<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">calculate_area_and_perimeter</span><span class="token punctuation">(</span>width<span class="token punctuation">,</span> height<span class="token punctuation">)</span>  <span class="token comment">-- 不太好：做两件事</span>
    <span class="token keyword">return</span> width <span class="token operator">*</span> height<span class="token punctuation">,</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token punctuation">(</span>width <span class="token operator">+</span> height<span class="token punctuation">)</span>
<span class="token keyword">end</span>

<span class="token comment">-- 2. 使用有意义的函数名</span>
<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">get_player_health</span><span class="token punctuation">(</span>player_id<span class="token punctuation">)</span>  <span class="token comment">-- 好：名字说明功能</span>
    <span class="token comment">-- ...</span>
<span class="token keyword">end</span>

<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">f1</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>  <span class="token comment">-- 不好：名字没有意义</span>
    <span class="token comment">-- ...</span>
<span class="token keyword">end</span>

<span class="token comment">-- 3. 参数数量适中（不超过 3-4 个）</span>
<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">create_player</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> class<span class="token punctuation">,</span> level<span class="token punctuation">)</span>  <span class="token comment">-- 好：参数明确</span>
    <span class="token comment">-- ...</span>
<span class="token keyword">end</span>

<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">setup_game</span><span class="token punctuation">(</span>player1_name<span class="token punctuation">,</span> player1_class<span class="token punctuation">,</span> player1_level<span class="token punctuation">,</span>
                    player2_name<span class="token punctuation">,</span> player2_class<span class="token punctuation">,</span> player2_level<span class="token punctuation">,</span>
                    map_name<span class="token punctuation">,</span> difficulty<span class="token punctuation">)</span>  <span class="token comment">-- 不好：参数太多</span>
    <span class="token comment">-- ...</span>
<span class="token keyword">end</span>

<span class="token comment">-- 4. 使用返回值表示成功/失败</span>
<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">load_file</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> file <span class="token keyword">then</span>
        <span class="token keyword">return</span> <span class="token keyword">nil</span><span class="token punctuation">,</span> <span class="token string">"错误，无法加载文件"</span>  <span class="token comment">-- 失败时返回 nil 和错误信息</span>
    <span class="token keyword">end</span>

    <span class="token keyword">return</span> file
<span class="token keyword">end</span>

<span class="token comment">-- 5. 局部函数应该声明为 local</span>
<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">helper_function</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">-- 好：不会污染全局命名空间</span>
    <span class="token comment">-- ...</span>
<span class="token keyword">end</span>

<span class="token comment">-- 6. 使用卫语句提前返回</span>
<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">get_player_info</span><span class="token punctuation">(</span>player<span class="token punctuation">)</span>	<span class="token comment">-- 不好：镶套过多</span>
	<span class="token keyword">if</span> <span class="token keyword">not</span> player<span class="token punctuation">.</span>dead <span class="token keyword">then</span>
		<span class="token keyword">if</span> player<span class="token punctuation">.</span>level_up <span class="token keyword">then</span>
			<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"玩家升级了"</span><span class="token punctuation">)</span>
		<span class="token keyword">end</span>
		<span class="token keyword">if</span> player<span class="token punctuation">.</span>walk <span class="token keyword">then</span>
			<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"玩家移动中..."</span><span class="token punctuation">)</span>
		<span class="token keyword">end</span>
	<span class="token keyword">else</span>
		<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"玩家已死亡"</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> <span class="token string">"玩家已死亡"</span>
	<span class="token keyword">end</span>
<span class="token keyword">end</span>

<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">get_player_info</span><span class="token punctuation">(</span>player<span class="token punctuation">)</span>	<span class="token comment">-- 好：较少镶套</span>
	<span class="token keyword">if</span> player<span class="token punctuation">.</span>dead <span class="token keyword">then</span>
		<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"玩家已死亡"</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> <span class="token string">"玩家已死亡"</span>
	<span class="token keyword">end</span>
	
	<span class="token keyword">if</span> player<span class="token punctuation">.</span>level_up <span class="token keyword">then</span>
		<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"玩家升级了"</span><span class="token punctuation">)</span>
	<span class="token keyword">end</span>
	<span class="token keyword">if</span> player<span class="token punctuation">.</span>walk <span class="token keyword">then</span>
		<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"玩家移动中..."</span><span class="token punctuation">)</span>
	<span class="token keyword">end</span>
<span class="token keyword">end</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h3"><h3 data-heading="常见错误" dir="auto" class="heading" id="常见错误_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>常见错误</h3></div><div class="el-pre"><pre class="language-lua"><code data-line="0" class="language-lua is-loaded"><span class="token comment">-- 错误 1：忘记写 return 语句</span>
<span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
    <span class="token keyword">local</span> sum <span class="token operator">=</span> a <span class="token operator">+</span> b
    <span class="token comment">-- 忘记写 return sum</span>
<span class="token keyword">end</span>

<span class="token keyword">local</span> result <span class="token operator">=</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>  <span class="token comment">-- 输出：nil</span>

<span class="token comment">-- 错误 2：递归没有终止条件</span>
<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">infinite_recursion</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
    <span class="token function">infinite_recursion</span><span class="token punctuation">(</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment">-- 无限递归！</span>
<span class="token keyword">end</span>
<span class="token comment">-- infinite_recursion(1)  -- 会导致栈溢出</span>

<span class="token comment">-- 错误 3：修改不应该修改的参数</span>
<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">process_user_data</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span>
    user <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>  <span class="token comment">-- 错误：这不会影响原始参数</span>
    <span class="token comment">-- 应该修改 user 的字段，而不是替换整个表</span>
<span class="token keyword">end</span>

<span class="token comment">-- 错误 4：全局变量污染</span>
<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">calculate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    result <span class="token operator">=</span> <span class="token number">10</span>  <span class="token comment">-- 错误：创建了全局变量</span>
    <span class="token keyword">local</span> local_result <span class="token operator">=</span> <span class="token number">10</span>  <span class="token comment">-- 正确：使用局部变量</span>
<span class="token keyword">end</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h3"><h3 data-heading="检查清单" dir="auto" class="heading" id="检查清单_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>检查清单</h3></div><div class="el-p"><p dir="auto">（点击勾选框勾选）<br>
完成本章后，你应该能够：</p></div><div class="el-ul"><ul class="contains-task-list has-list-bullet">
<li data-line="0" data-task="" class="task-list-item" dir="auto"><span class="list-bullet"></span><input data-line="0" type="checkbox" class="task-list-item-checkbox">定义和调用函数</li>
<li data-line="1" data-task="" class="task-list-item" dir="auto"><span class="list-bullet"></span><input data-line="1" type="checkbox" class="task-list-item-checkbox">理解参数传递的机制</li>
<li data-line="2" data-task="" class="task-list-item" dir="auto"><span class="list-bullet"></span><input data-line="2" type="checkbox" class="task-list-item-checkbox">使用变长参数处理不定数量的参数</li>
<li data-line="3" data-task="" class="task-list-item" dir="auto"><span class="list-bullet"></span><input data-line="3" type="checkbox" class="task-list-item-checkbox">从函数返回单个或多个值</li>
<li data-line="4" data-task="" class="task-list-item" dir="auto"><span class="list-bullet"></span><input data-line="4" type="checkbox" class="task-list-item-checkbox">创建和使用匿名函数</li>
<li data-line="5" data-task="" class="task-list-item" dir="auto"><span class="list-bullet"></span><input data-line="5" type="checkbox" class="task-list-item-checkbox">理解闭包的概念和用途</li>
<li data-line="6" data-task="" class="task-list-item" dir="auto"><span class="list-bullet"></span><input data-line="6" type="checkbox" class="task-list-item-checkbox">编写递归函数</li>
<li data-line="7" data-task="" class="task-list-item" dir="auto"><span class="list-bullet"></span><input data-line="7" type="checkbox" class="task-list-item-checkbox">设计模块化的函数库</li>
</ul></div><div class="el-h3"><h3 data-heading="思考题" dir="auto" class="heading" id="思考题_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>思考题</h3></div><div class="el-ol"><ol>
<li data-line="0" dir="auto">什么时候应该使用多个返回值，什么时候应该返回表？</li>
<li data-line="1" dir="auto">闭包和普通函数有什么区别？什么时候应该使用闭包？</li>
<li data-line="2" dir="auto">递归有什么优缺点？如何避免递归导致的栈溢出？</li>
<li data-line="3" dir="auto">为什么应该优先使用局部函数而不是全局函数？</li>
<li data-line="4" dir="auto">如何设计一个良好的函数 API（参数、返回值、错误处理）？</li>
</ol></div><div class="el-h3"><h3 data-heading="拓展练习" dir="auto" class="heading" id="拓展练习_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>拓展练习</h3></div><div class="el-ol"><ol>
<li data-line="0" dir="auto">创建一个简单的银行账户系统，包含存款、取款、查询功能</li>
<li data-line="1" dir="auto">实现一个简单的缓存系统，使用闭包来保存缓存数据</li>
<li data-line="2" dir="auto">编写一个函数，可以生成不同难度的数学题目</li>
<li data-line="3" dir="auto">创建一个事件系统，允许注册回调函数并在特定事件发生时调用</li>
<li data-line="4" dir="auto">实现一个简单的状态机，使用函数表示不同状态的行为</li>
</ol></div><div class="el-hr"><hr></div><div class="el-p"><p dir="auto"><strong>下一章预告</strong>：在第 7 章中，我们将深入学习 Lua 的核心数据结构——表（Table）。表是 Lua 中最重要、最灵活的数据结构，它可以用来实现数组、字典、对象、模块等几乎所有复杂数据结构。我们将学习表的创建、操作、遍历以及各种高级用法。</p></div><div class="el-p"><p dir="auto"><strong>学习建议</strong>：</p></div><div class="el-ol"><ol>
<li data-line="0" dir="auto">多练习函数的设计和实现</li>
<li data-line="1" dir="auto">尝试用函数重构重复的代码</li>
<li data-line="2" dir="auto">理解闭包的概念，这是 Lua 的精华之一</li>
<li data-line="3" dir="auto">注意函数的命名和参数设计，写出易读易用的代码</li>
<li data-line="4" dir="auto">尝试编写一些实用的小工具函数库</li>
</ol></div><div class="el-p"><p dir="auto"><strong>常见问题解答</strong>：<br>
Q: 为什么值类型，参数传递时传递的是副本？<br>
A: 值类型传递副本是因为它们<strong>简单且不可变</strong>，复制开销小且语义安全。表传递引用是因为它<strong>可能很大且需要共享修改（多个变量操作一个表）</strong>，传递指针更高效。</p></div><div class="footer"><div class="data-bar"></div></div></div></div></div><div id="right-content" class="leaf" style="--sidebar-width: var(--sidebar-width-right);"><div id="right-sidebar" class="sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><label class="theme-toggle-container" for="theme-toggle-input" id=""><input class="theme-toggle-input" type="checkbox" id="theme-toggle-input"><div class="toggle-background"></div></label></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content-wrapper"><div id="right-sidebar-content" class="leaf-content"><div id="outline" class=" tree-container"><div class="feature-header"><div class="feature-title">Table Of Contents</div><button class="clickable-icon nav-action-button tree-collapse-all" aria-label="Collapse All"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-item mod-collapsible" data-depth="1"><a class="tree-item-self is-clickable mod-collapsible" href="第-1-节-语法/6.-函数.html#6._函数_0" data-path="#6._函数_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="6. 函数">6. 函数</div></a><div class="tree-item-children"><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-item-self is-clickable mod-collapsible" href="第-1-节-语法/6.-函数.html#6.1_函数的基本概念_0" data-path="#6.1_函数的基本概念_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="6.1 函数的基本概念">6.1 函数的基本概念</div></a><div class="tree-item-children"><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="第-1-节-语法/6.-函数.html#为什么要使用函数？_0" data-path="#为什么要使用函数？_0"><div class="tree-item-inner heading-link" heading-name="为什么要使用函数？">为什么要使用函数？</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-item-self is-clickable mod-collapsible" href="第-1-节-语法/6.-函数.html#6.2_函数的定义与调用_0" data-path="#6.2_函数的定义与调用_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="6.2 函数的定义与调用">6.2 函数的定义与调用</div></a><div class="tree-item-children"><div class="tree-item mod-collapsible" data-depth="3"><a class="tree-item-self is-clickable mod-collapsible" href="第-1-节-语法/6.-函数.html#6.2.1_函数定义的基本语法_0" data-path="#6.2.1_函数定义的基本语法_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="6.2.1 函数定义的基本语法">6.2.1 函数定义的基本语法</div></a><div class="tree-item-children"><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="第-1-节-语法/6.-函数.html#示例_0" data-path="#示例_0"><div class="tree-item-inner heading-link" heading-name="示例">示例</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="第-1-节-语法/6.-函数.html#6.2.2_改进的玩家信息显示程序_0" data-path="#6.2.2_改进的玩家信息显示程序_0"><div class="tree-item-inner heading-link" heading-name="6.2.2 改进的玩家信息显示程序">6.2.2 改进的玩家信息显示程序</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-item-self is-clickable mod-collapsible" href="第-1-节-语法/6.-函数.html#6.3_参数传递_0" data-path="#6.3_参数传递_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="6.3 参数传递">6.3 参数传递</div></a><div class="tree-item-children"><div class="tree-item mod-collapsible" data-depth="3"><a class="tree-item-self is-clickable mod-collapsible" href="第-1-节-语法/6.-函数.html#6.3.1_基本参数传递_0" data-path="#6.3.1_基本参数传递_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="6.3.1 基本参数传递">6.3.1 基本参数传递</div></a><div class="tree-item-children"><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="第-1-节-语法/6.-函数.html#单个参数_0" data-path="#单个参数_0"><div class="tree-item-inner heading-link" heading-name="单个参数">单个参数</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="第-1-节-语法/6.-函数.html#多个参数_0" data-path="#多个参数_0"><div class="tree-item-inner heading-link" heading-name="多个参数">多个参数</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="第-1-节-语法/6.-函数.html#示例_1" data-path="#示例_1"><div class="tree-item-inner heading-link" heading-name="示例">示例</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="3"><a class="tree-item-self is-clickable mod-collapsible" href="第-1-节-语法/6.-函数.html#6.3.2_参数传递的特性_0" data-path="#6.3.2_参数传递的特性_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="6.3.2 参数传递的特性">6.3.2 参数传递的特性</div></a><div class="tree-item-children"><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="第-1-节-语法/6.-函数.html#引用传递_0" data-path="#引用传递_0"><div class="tree-item-inner heading-link" heading-name="引用传递">引用传递</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="第-1-节-语法/6.-函数.html#值传递_0" data-path="#值传递_0"><div class="tree-item-inner heading-link" heading-name="值传递">值传递</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="第-1-节-语法/6.-函数.html#6.3.3_变长参数（可变参数）_0" data-path="#6.3.3_变长参数（可变参数）_0"><div class="tree-item-inner heading-link" heading-name="6.3.3 变长参数（可变参数）">6.3.3 变长参数（可变参数）</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-item-self is-clickable mod-collapsible" href="第-1-节-语法/6.-函数.html#6.4_返回值_0" data-path="#6.4_返回值_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="6.4 返回值">6.4 返回值</div></a><div class="tree-item-children"><div class="tree-item mod-collapsible" data-depth="3"><a class="tree-item-self is-clickable mod-collapsible" href="第-1-节-语法/6.-函数.html#6.4.1_单返回值_0" data-path="#6.4.1_单返回值_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="6.4.1 单返回值">6.4.1 单返回值</div></a><div class="tree-item-children"><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="第-1-节-语法/6.-函数.html#示例_2" data-path="#示例_2"><div class="tree-item-inner heading-link" heading-name="示例">示例</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="3"><a class="tree-item-self is-clickable mod-collapsible" href="第-1-节-语法/6.-函数.html#6.4.2_多返回值_0" data-path="#6.4.2_多返回值_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="6.4.2 多返回值">6.4.2 多返回值</div></a><div class="tree-item-children"><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="第-1-节-语法/6.-函数.html#示例_3" data-path="#示例_3"><div class="tree-item-inner heading-link" heading-name="示例">示例</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="第-1-节-语法/6.-函数.html#6.4.3_返回表的技巧_0" data-path="#6.4.3_返回表的技巧_0"><div class="tree-item-inner heading-link" heading-name="6.4.3 返回表的技巧">6.4.3 返回表的技巧</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="第-1-节-语法/6.-函数.html#6.4.4_返回函数_0" data-path="#6.4.4_返回函数_0"><div class="tree-item-inner heading-link" heading-name="6.4.4 返回函数">6.4.4 返回函数</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="第-1-节-语法/6.-函数.html#6.5.5_技巧_0" data-path="#6.5.5_技巧_0"><div class="tree-item-inner heading-link" heading-name="6.5.5 技巧">6.5.5 技巧</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="第-1-节-语法/6.-函数.html#6.5_匿名函数_0" data-path="#6.5_匿名函数_0"><div class="tree-item-inner heading-link" heading-name="6.5 匿名函数">6.5 匿名函数</div></a><div class="tree-item-children"></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-item-self is-clickable mod-collapsible" href="第-1-节-语法/6.-函数.html#6.6_函数的作用域和闭包_0" data-path="#6.6_函数的作用域和闭包_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="6.6 函数的作用域和闭包">6.6 函数的作用域和闭包</div></a><div class="tree-item-children"><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="第-1-节-语法/6.-函数.html#6.6.1_作用域_0" data-path="#6.6.1_作用域_0"><div class="tree-item-inner heading-link" heading-name="6.6.1 作用域">6.6.1 作用域</div></a><div class="tree-item-children"></div></div><div class="tree-item mod-collapsible" data-depth="3"><a class="tree-item-self is-clickable mod-collapsible" href="第-1-节-语法/6.-函数.html#6.6.2_闭包_0" data-path="#6.6.2_闭包_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="6.6.2 闭包">6.6.2 闭包</div></a><div class="tree-item-children"><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="第-1-节-语法/6.-函数.html#示例_4" data-path="#示例_4"><div class="tree-item-inner heading-link" heading-name="示例">示例</div></a><div class="tree-item-children"></div></div></div></div></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="第-1-节-语法/6.-函数.html#6.7_递归函数_0" data-path="#6.7_递归函数_0"><div class="tree-item-inner heading-link" heading-name="6.7 递归函数">6.7 递归函数</div></a><div class="tree-item-children"></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-item-self is-clickable mod-collapsible" href="第-1-节-语法/6.-函数.html#6.8_文档注释_0" data-path="#6.8_文档注释_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="6.8 文档注释">6.8 文档注释</div></a><div class="tree-item-children"><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="第-1-节-语法/6.-函数.html#示例_5" data-path="#示例_5"><div class="tree-item-inner heading-link" heading-name="示例">示例</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-item-self is-clickable mod-collapsible" href="第-1-节-语法/6.-函数.html#6.9_练习_0" data-path="#6.9_练习_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="6.9 练习">6.9 练习</div></a><div class="tree-item-children"><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="第-1-节-语法/6.-函数.html#练习_1：简单的计算器函数库_0" data-path="#练习_1：简单的计算器函数库_0"><div class="tree-item-inner heading-link" heading-name="练习 1：简单的计算器函数库">练习 1：简单的计算器函数库</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="第-1-节-语法/6.-函数.html#练习_2：提取函数，优化代码_0" data-path="#练习_2：提取函数，优化代码_0"><div class="tree-item-inner heading-link" heading-name="练习 2：提取函数，优化代码">练习 2：提取函数，优化代码</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-item-self is-clickable mod-collapsible" href="第-1-节-语法/6.-函数.html#6.10_本章总结_0" data-path="#6.10_本章总结_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="6.10 本章总结">6.10 本章总结</div></a><div class="tree-item-children"><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="第-1-节-语法/6.-函数.html#关键知识点回顾_0" data-path="#关键知识点回顾_0"><div class="tree-item-inner heading-link" heading-name="关键知识点回顾">关键知识点回顾</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="第-1-节-语法/6.-函数.html#函数设计的最佳实践_0" data-path="#函数设计的最佳实践_0"><div class="tree-item-inner heading-link" heading-name="函数设计的最佳实践">函数设计的最佳实践</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="第-1-节-语法/6.-函数.html#常见错误_0" data-path="#常见错误_0"><div class="tree-item-inner heading-link" heading-name="常见错误">常见错误</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="第-1-节-语法/6.-函数.html#检查清单_0" data-path="#检查清单_0"><div class="tree-item-inner heading-link" heading-name="检查清单">检查清单</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="第-1-节-语法/6.-函数.html#思考题_0" data-path="#思考题_0"><div class="tree-item-inner heading-link" heading-name="思考题">思考题</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="第-1-节-语法/6.-函数.html#拓展练习_0" data-path="#拓展练习_0"><div class="tree-item-inner heading-link" heading-name="拓展练习">拓展练习</div></a><div class="tree-item-children"></div></div></div></div></div></div></div></div></div><script defer="">let rs = document.querySelector("#right-sidebar"); rs.classList.toggle("is-collapsed", window.innerWidth < 768); rs.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-right-width"));</script></div></div></div></div></body></html>